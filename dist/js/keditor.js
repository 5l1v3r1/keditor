/*! KEditor v2.0.0 | Copyright (c) 2016-present Kademi (http://kademi.co) */
!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("jQuery"));else if("function"==typeof define&&define.amd)define(["jQuery"],n);else{var e="object"==typeof exports?n(require("jQuery")):n(t.jQuery);for(var o in e)("object"==typeof exports?exports:t)[o]=e[o]}}("undefined"!=typeof self?self:this,function(t){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=6)}([,function(n,e){n.exports=t},,function(t,n,e){},,,function(t,n,e){"use strict";e.r(n);var o=e(1),i=e.n(o),a={UI:"".concat("keditor-","ui"),HIDDEN_ELEMENT:"".concat("keditor-","hidden-element"),CLICKS_INITIALIZED:"".concat("keditor-","clicks-initialized"),CONTENT_AREAS_WRAPPER:"".concat("keditor-","content-areas-wrapper")},r={nestedContainerEnabled:!0,explicitSnippetEnabled:!1,containerForQuickAddComponent:'\n<div class="row">\n<div class="col-sm-12" data-type="container-content">\n</div>\n</div>\n',btnAddContentText:'<i class="fa fa-plus"></i>',btnAddContainerText:'<i class="fa fa-plus"></i> <i class="fa fa-fw fa-columns"></i>',btnAddSubContainerText:'<i class="fa fa-plus"></i> <i class="fa fa-fw fa-columns"></i>',btnAddComponentText:'<i class="fa fa-plus"></i> <i class="fa fa-fw fa-list-ul"></i>',btnMoveContainerText:'<i class="fa fa-sort"></i>',btnMoveComponentText:'<i class="fa fa-arrows"></i>',btnSettingContainerText:'<i class="fa fa-cog"></i>',btnSettingComponentText:'<i class="fa fa-cog"></i>',btnDuplicateContainerText:'<i class="fa fa-files-o"></i>',btnDuplicateComponentText:'<i class="fa fa-files-o"></i>',btnDeleteContainerText:'<i class="fa fa-times"></i>',btnDeleteComponentText:'<i class="fa fa-times"></i>',confirmDeleteContainerText:"Are you sure that you want to delete this container? This action can not be undone!",confirmDeleteComponentText:"Are you sure that you want to delete this component? This action can not be undone!",defaultComponentType:"blank",snippetsUrl:"snippets/snippets.html",snippetsFilterEnabled:!0,snippetsCategoriesSeparator:";",iframeMode:!1,contentStyles:[],contentAreasSelector:null,contentAreasWrapper:'<div class="'.concat(a.UI," ").concat(a.CONTENT_AREAS_WRAPPER,'"></div>'),containerSettingEnabled:!1,containerSettingInitFunction:null,containerSettingShowFunction:null,containerSettingHideFunction:null,onReady:function(){},onSnippetsLoaded:function(t){},onSnippetsError:function(t,n){},onInitIframe:function(t,n,e){},onContentChanged:function(t,n){},onBeforeInitContentArea:function(t){},onInitContentArea:function(t){},onBeforeInitContainer:function(t,n){},onInitContainer:function(t,n){},onBeforeContainerDeleted:function(t,n,e){},onContainerDeleted:function(t,n,e){},onContainerChanged:function(t,n,e){},onContainerDuplicated:function(t,n,e,o){},onContainerSelected:function(t,n,e){},onContainerSnippetAdded:function(t,n,e,o){},onComponentReady:function(t){},onBeforeInitComponent:function(t,n){},onInitComponent:function(t,n){},onBeforeComponentDeleted:function(t,n,e){},onComponentDeleted:function(t,n,e){},onComponentChanged:function(t,n,e){},onComponentDuplicated:function(t,n,e,o){},onComponentSelected:function(t,n,e){},onComponentSnippetAdded:function(t,n,e,o){},onBeforeDynamicContentLoad:function(t,n,e){},onDynamicContentLoaded:function(t,n,e,o,i){},onDynamicContentError:function(t,n,e,o,i){}},s=function(){if(console&&"function"==typeof console.log&&i.a.keditor.debug){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];console.log.apply(console,["[ KEditor ] "].concat(n))}},c=function(t){throw new Error("[ KEditor ] ".concat(t))},d=0,l=1,p=2,u=3,f=4,m=5,h=function(t){var n=this,e=n.options,o=n.sidebar,i=o.find(".keditor-sidebar-title"),a=o.find(".keditor-sidebar-body");if(a.children(".active").removeClass("active"),t.is(".keditor-component")){n.setSettingComponent(t),n.setSettingContainer(null);var r=n.getComponentType(t),c=KEditor.components[r];i.html(c.settingTitle);var d=a.find(".keditor-setting-".concat(r));if(0===d.length){var l=KEditor.components[r];if("function"==typeof l.initSettingForm){d=$('\n<div\ndata-type="'.concat(r,'"\nclass="keditor-ui keditor-setting-form keditor-setting-').concat(r,' clearfix active"\n>\n</div>\n'));var p=$("<span />").html("Loading...");a.append(d),d.append(p);var u=l.initSettingForm.call(l,d,n);$.when(u).done(function(){s('Initialized setting form for component type "'.concat(r,'"')),setTimeout(function(){p.remove(),"function"==typeof l.showSettingForm&&l.showSettingForm.call(l,d,t,n)},100)})}}else"function"==typeof c.showSettingForm&&c.showSettingForm.call(c,d,t,n),d.addClass("active")}else{n.setSettingContainer(t),n.setSettingComponent(null),i.html("Container Settings");var f=o.find(".keditor-container-setting");"function"==typeof e.containerSettingShowFunction&&e.containerSettingShowFunction.call(n,f,t,n),f.addClass("active")}o.addClass("opened")},C=function(){var t=this.options,n=this.sidebar,e=n.find(".keditor-sidebar-body").children(".active");if(e.length>0){if(e.is(".keditor-container-setting"))"function"==typeof t.containerSettingHideFunction&&t.containerSettingHideFunction.call(this,e,this);else{var o=e.attr("data-type"),i=KEditor.components[o];"function"==typeof i.hideSettingForm&&i.hideSettingForm.call(i,e,this)}e.removeClass("active")}this.setSettingComponent(null),this.setSettingContainer(null),n.removeClass("opened")};function k(t){return function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var v=0,y=1,b=2,g=function(t){var n=this.options,e=(t.attr("data-type")||"").replace("component-","");return e&&e in KEditor.components?e:("string"==typeof n.defaultComponentType?e=n.defaultComponentType:"function"==typeof n.defaultComponentType&&(e=n.defaultComponentType.call(this,t)),e||c("Component type is undefined!"),s("Fallback to defaultComponentType: ".concat(e)),e)},S=function(t,n,e){s("initComponent",t,n,e);var o=this,i=o.options;o.body;if(e.hasClass("keditor-initialized-component")&&e.hasClass("keditor-initializing-component"))e.hasClass("keditor-initialized-component")?s("Component is already initialized!"):s("Component is initializing...");else{e.addClass("keditor-initializing-component"),e.attr("id",o.generateId("component")),"function"==typeof i.onBeforeInitComponent&&i.onBeforeInitComponent.call(o,e,t),e.children(".keditor-component-content").attr("id",o.generateId("component-content"));var a=o.getComponentType(e);s("Component type: ".concat(a));var r=KEditor.components[a];s("Render KEditor toolbar for component",e),e.append(o.generateToolbar(m,r.settingEnabled)),e.find("[data-dynamic-href]").each(function(){var t=$(this);o.initDynamicContent(t)}),"function"==typeof r.init?r.init.call(r,t,n,e,o):s('"init" function of component type "'.concat(a,'" does not exist')),"function"==typeof i.onInitComponent&&i.onInitComponent.call(o,e,t),e.addClass("keditor-initialized-component"),e.removeClass("keditor-initializing-component")}},w=function(t){s("deleteComponent",t);var n=this.getComponentType(t),e=KEditor.components[n];"function"==typeof e.destroy&&e.destroy.call(e,t,this),t.remove()},T=function(t){s("getComponentContent");var n,e=t.clone(),o=this.getComponentType(e),i=KEditor.components[o],a=this.getDataAttributes(e,null,!0),r=t.find(".keditor-iframe-wrapper");if(r.length>0){r.find(".keditor-iframe-cover").remove();var c=r.children("iframe");r.hasClass("keditor-iframe-wrapper-fake")?c.unwrap():r.removeClass("keditor-iframe-wrapper")}"function"==typeof i.getContent?n=i.getContent.call(i,e,this):n=e.children(".keditor-component-content").html();return e.html(n).find("[data-dynamic-href]").each(function(){$(this).html("")}),"<section ".concat(a.join(" "),">").concat(e.html(),"</section>")},A=function(t,n){var e=this.element=t,o=this.options=$.extend({},r,n);if(o.iframeMode)this.initIframe();else{this.window=window,this.body=$(document.body);var i=e.val()||e.html()||"",s=this.generateContentAreasWrapper(i);e.is("textarea")?(e.after(s),e.addClass(a.HIDDEN_ELEMENT)):e.empty().append(s),this.contentAreasWrapper=s}this.initSidebar(),this.initSnippetsModal(),this.initContentAreas(),this.body.hasClass(a.CLICKS_INITIALIZED)||this.initKEditorClicks(),this.id=this.generateId(),KEditor.instances[this.id]=this,"function"==typeof o.onReady&&o.onReady.call(this)},D=function(){var t=this.element,n=this.id,e=this.getContent(!1);this.options.iframeMode?this.iframeWrapper.remove():this.contentAreasWrapper.remove(),t.is("textarea")?t.val(e):t.html(e),t.removeClass("keditor-hidden-element"),t.data("keditor",null),delete KEditor.instances[n]};e(3);function x(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function E(t,n,e){return n&&x(t.prototype,n),e&&x(t,e),t}function I(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}i.a.fn.sortable||c("$.fn.sortable does not exist. Please import $.fn.sortable into your document for continue using KEditor.");var j=function(){function t(n,e){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),A.apply(this,[n,e])}return E(t,null,[{key:"log",value:function(){s.apply(void 0,arguments)}},{key:"error",value:function(){c.apply(void 0,arguments)}},{key:"init",value:function(n,e){return new t(n,e)}}]),E(t,[{key:"generateId",value:function(t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=(new Date).getTime(),e=Math.round(9876543210*Math.random());return"keditor-".concat(t,"-").concat(n).concat(e)}.apply(this,[t])}},{key:"generateContentAreasWrapper",value:function(t){return function(t){var n=this.options,e=$(n.contentAreasWrapper||"<div />");return e.attr("class","keditor-ui keditor-content-area-wrapper"),e.attr("id")||e.attr("id",this.generateId("content-area-wrapper")),e.html(t),e}.apply(this,[t])}},{key:"generateToolbar",value:function(t,n){return function(t,n){var e=this.options,o="";if(!e.explicitSnippetEnabled)switch(t){case d:case u:case f:return'\n<div class="keditor-ui '.concat("keditor-container-content-toolbar",'">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-content" title="Add content">').concat(e.btnAddContentText,"</a>\n</div>\n")}switch(t){case d:return'\n<div class="keditor-ui keditor-content-area-toolbar">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-container" title="Add container">'.concat(e.btnAddContainerText,"</a>\n</div>\n");case l:return!0===e.containerSettingEnabled&&(o='<a href="javascript:void(0);" class="keditor-ui btn-container-setting">'.concat(e.btnSettingContainerText,"</a>")),'\n<div class="keditor-toolbar keditor-toolbar-container">\n<a href="javascript:void(0);" class="keditor-ui btn-container-reposition">'.concat(e.btnMoveContainerText,"</a>\n").concat(o,'\n<a href="javascript:void(0);" class="keditor-ui btn-container-duplicate">').concat(e.btnDuplicateContainerText,'</a>\n<a href="javascript:void(0);" class="keditor-ui btn-container-delete">').concat(e.btnDeleteContainerText,"</a>\n</div>\n");case p:return!0===e.containerSettingEnabled&&(o='<a href="javascript:void(0);" class="keditor-ui btn-container-setting">'.concat(e.btnSettingContainerText,"</a>")),'\n<div class="keditor-toolbar keditor-toolbar-container keditor-toolbar-sub-container">\n<a href="javascript:void(0);" class="keditor-ui btn-container-reposition">'.concat(e.btnMoveContainerText,"</a>\n").concat(o,'\n<a href="javascript:void(0);" class="keditor-ui btn-container-duplicate">').concat(e.btnDuplicateContainerText,'</a>\n<a href="javascript:void(0);" class="keditor-ui btn-container-delete">').concat(e.btnDeleteContainerText,"</a>\n</div>\n");case u:return'\n<div class="keditor-ui keditor-container-content-toolbar keditor-btn-group">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-container" title="Add sub-container">'.concat(e.btnAddSubContainerText,'</a>\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-component" title="Add component">').concat(e.btnAddComponentText,"</a>\n</div>\n");case f:return'\n<div class="keditor-ui keditor-container-content-toolbar">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-component" title="Add component">'.concat(e.btnAddComponentText,"</a>\n</div>\n");case m:return n&&(o='<a href="javascript:void(0);" class="keditor-ui btn-component-setting">'.concat(e.btnSettingComponentText,"</a>")),'\n<div class="keditor-toolbar keditor-toolbar-component">\n<a href="javascript:void(0);" class="keditor-ui btn-component-reposition">'.concat(e.btnMoveComponentText,"</a>\n").concat(o,'\n<a href="javascript:void(0);" class="keditor-ui btn-component-duplicate">').concat(e.btnDuplicateComponentText,'</a>\n<a href="javascript:void(0);" class="keditor-ui btn-component-delete">').concat(e.btnDeleteComponentText,"</a>\n</div>\n")}}.apply(this,[t,n])}},{key:"beautifyCategories",value:function(t){return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e]||"";""!==o&&-1===$.inArray(o,n)&&n.push(o)}return n.sort()}.apply(this,[t])}},{key:"setSettingContainer",value:function(t){this.settingContainer=t}},{key:"getSettingContainer",value:function(){return this.settingContainer}},{key:"setSettingComponent",value:function(t){this.settingComponent=t}},{key:"getSettingComponent",value:function(){return this.settingComponent}},{key:"getDataAttributes",value:function(t,n,e){return function(t,n,e){var o=e?[]:{};return n||(n=[]),$.each(t.get(0).attributes,function(t,i){0===i.name.indexOf("data-")&&-1===$.inArray(i.name,n)&&(e?o.push("".concat(i.name,'="').concat(i.value,'"')):o[i.name]=i.value)}),o}.apply(this,[t,n,e])}},{key:"getComponentType",value:function(t){return g.apply(this,[t])}},{key:"getClickedElement",value:function(t,n){return function(t,n){var e=$(t.target),o=e.closest(n);return e.is(n)?e:o.length>0?o:null}.apply(this,[t,n])}},{key:"initIframe",value:function(){return function(){var t=this.options,n=this.element,e=n.is("textarea")?n.val():n.html(),o=this.iframeWrapper=$('<div class="keditor-ui keditor-iframe-wrapper"></div>'),i=this.iframe=$('<iframe class="keditor-ui keditor-iframe"></iframe>');n.after(o),o.attr("id",this.generateId("iframe-wrapper")).append(i),n.addClass("keditor-hidden-element");var a=this.iframeDoc=i.contents();a.get(0).open(),a.get(0).close(),this.window=i[0].contentWindow?i[0].contentWindow:i[0].contentDocument.defaultView;var r=this.iframeHead=a.find("head"),c=this.iframeBody=this.body=a.find("body");s("Adding styles to iframe...");var d="";$('[data-type="keditor-style"]').each(function(){var t=$(this),n=t.attr("href")||t.attr("data-href")||"";d+=n?'<link rel="stylesheet" type="text/css" href="'.concat(n,'" />\n'):'<style type="text/css">'.concat(t.html(),"</style>\n")}),t.contentStyles&&$.isArray(t.contentStyles)&&$.each(t.contentStyles,function(t,n){var e="";n.id&&(e=' id="'.concat(n.id,'" ')),n.href?d+='<link rel="stylesheet" type="text/css" href="'.concat(n.href,'" ').concat(e," />\n"):d+='<style type="text/css" '.concat(e,">").concat(n.content,"</style>\n")}),r.append(d),s("Adding original content to iframe...");var l=this.generateContentAreasWrapper(e);c.append(l),this.contentAreasWrapper=l,"function"==typeof t.onInitIframe&&t.onInitIframe.call(this,i,r,c)}.apply(this)}},{key:"initIframeCover",value:function(t,n){return function(t,n){n||(t.wrap('<div class="keditor-iframe-wrapper-fake"></div>'),n=t.parent()),n.addClass("keditor-iframe-wrapper");var e=$('<div class="keditor-iframe-cover"></div>');n.prepend(e),n.on("mouseleave",function(){n.removeClass("hidden-cover")}),e.on("dblclick",function(t){t.preventDefault(),n.addClass("hidden-cover")})}.apply(this,[t,n])}},{key:"initKEditorClicks",value:function(){return function(){s("initKEditorClicks");var t=this,n=t.options,e=t.body;e.on("click",function(o){var i=t.getClickedElement(o,".keditor-sidebar"),a=t.getClickedElement(o,".keditor-modal"),r=t.getClickedElement(o,".keditor-container");if(r){if(!r.hasClass("showed-keditor-toolbar")){e.find(".keditor-container.showed-keditor-toolbar").removeClass("showed-keditor-toolbar"),e.find(".keditor-component.showed-keditor-toolbar").removeClass("showed-keditor-toolbar"),r.addClass("showed-keditor-toolbar");var s=r.parent();"function"==typeof n.onContainerSelected&&n.onContainerSelected.call(t,o,r,s)}}else i||a||(e.find(".keditor-container.showed-keditor-toolbar").removeClass("showed-keditor-toolbar"),e.find(".keditor-component.showed-keditor-toolbar").removeClass("showed-keditor-toolbar"));var c=t.getClickedElement(o,".keditor-component");if(c){if(!c.hasClass("showed-keditor-toolbar")){e.find(".keditor-component.showed-keditor-toolbar").removeClass("showed-keditor-toolbar"),c.addClass("showed-keditor-toolbar");var d=c.parent();"function"==typeof n.onComponentSelected&&n.onComponentSelected.call(t,o,c,d)}}else i||e.find(".keditor-component.showed-keditor-toolbar").removeClass("showed-keditor-toolbar")}),e.on("click",".btn-container-setting",function(n){n.preventDefault();var o=$(this);s("Click on .btn-container-setting",o);var i=o.closest(".keditor-container");e.hasClass("opened-keditor-setting")&&e.hasClass("opened-keditor-sidebar")&&i.is(t.settingContainer)?t.closeSidebar():t.openSidebar(i)}),e.on("click",".btn-container-duplicate",function(e){e.preventDefault();var o=$(this);s("Click on .btn-container-duplicate",o);var i=o.closest(".keditor-container"),a=i.parent(),r=$(t.getContainerContent(i,o.parent().hasClass("keditor-toolbar-sub-container")));i.after(r),t.convertToContainer(a,r),s("Container is duplicated"),"function"==typeof n.onContainerDuplicated&&n.onContainerDuplicated.call(t,i,r,a),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,a)}),e.on("click",".btn-container-delete",function(e){e.preventDefault();var o=$(this);if(s("Click on .btn-container-delete",o),confirm(n.confirmDeleteContainerText)){var i=o.closest(".keditor-container"),a=i.find(".keditor-component"),r=i.parent();"function"==typeof n.onBeforeContainerDeleted&&n.onBeforeContainerDeleted.call(t,e,i,r);var c=t.settingComponent;c?c.closest(".keditor-container").is(i)&&(s("Deleting container is container of setting container. Close setting panel for this setting component",c),t.closeSidebar()):i.is(t.settingContainer)&&(s("Deleting container is setting container. Close setting panel for this container",i),t.closeSidebar()),a.length>0&&a.each(function(){t.deleteComponent($(this))}),i.remove(),"function"==typeof n.onContainerDeleted&&n.onContainerDeleted.call(t,e,i,r),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,r)}}),e.on("click",".btn-component-setting",function(n){n.preventDefault();var o=$(this);s("Click on .btn-component-setting",o);var i=o.closest(".keditor-component");e.hasClass("opened-keditor-setting")&&e.hasClass("opened-keditor-sidebar")&&i.is(t.settingComponent())?t.closeSidebar():t.openSidebar(i)}),e.on("click",".btn-component-duplicate",function(e){e.preventDefault();var o=$(this);s("Click on .btn-component-duplicate",o);var i=o.closest(".keditor-component"),a=i.closest(".keditor-container"),r=a.parent(),c=$(t.getComponentContent(i));i.after(c),t.convertToComponent(r,a,c),s("Component is duplicated"),"function"==typeof n.onComponentDuplicated&&n.onComponentDuplicated.call(t,i,c,r),"function"==typeof n.onContainerChanged&&n.onContainerChanged.call(t,e,a,r),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,r)}),e.on("click",".btn-component-delete",function(e){e.preventDefault();var o=$(this);if(s("Click on .btn-component-delete",o),confirm(n.confirmDeleteComponentText)){var i=o.closest(".keditor-component"),a=i.closest(".keditor-container"),r=i.closest(".keditor-content-area");"function"==typeof n.onBeforeComponentDeleted&&n.onBeforeComponentDeleted.call(t,e,i,r),i.is(t.settingComponent)&&t.closeSidebar(),t.deleteComponent(i),"function"==typeof n.onComponentDeleted&&n.onComponentDeleted.call(t,e,i,r),"function"==typeof n.onContainerChanged&&n.onContainerChanged.call(t,e,a,r),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,r)}}),e.addClass("keditor-clicks-initialized")}.apply(this)}},{key:"initSidebar",value:function(){return function(){var t=this,n=t.options,e=t.generateId("sidebar"),o=t.sidebar=$('\n<div class="keditor-ui keditor-sidebar" id="'.concat(e,'">\n<div class="keditor-ui keditor-sidebar-header">\n<span class="keditor-ui keditor-sidebar-title"></span>\n<a href="javascript:void(0);" class="keditor-ui keditor-sidebar-close">&times;</a>\n</div>\n<div class="keditor-ui keditor-sidebar-body"></div>\n</div>\n'));o.find(".keditor-sidebar-close").on("click",function(n){n.preventDefault(),t.closeSidebar()});var i=o.find(".keditor-sidebar-body");if(i.on("submit","form",function(t){return t.preventDefault(),!1}),!0===n.containerSettingEnabled)if("function"==typeof n.containerSettingInitFunction){var a=$('<div  class="keditor-ui keditor-setting-form keditor-container-setting"></div>');i.append(a),s("Initialize container setting panel"),n.containerSettingInitFunction.call(t,a,t)}else c('"containerSettingInitFunction" is not function!');o.appendTo(n.iframeMode?t.iframeWrapper:t.body)}.apply(this)}},{key:"openSidebar",value:function(t){return h.apply(this,[t])}},{key:"closeSidebar",value:function(){return C.apply(this)}},{key:"showSettingPanel",value:function(t){this.openSidebar(t)}},{key:"hideSettingPanel",value:function(){this.closeSidebar()}},{key:"initSnippetsModal",value:function(){return function(){var t=this,n=t.options,e=t.generateId("modal"),o="";o=n.explicitSnippetEnabled?'\n<div class="keditor-snippets-wrapper keditor-snippets-wrapper-container">\n<div class="keditor-snippets keditor-snippets-container"></div>\n</div>\n<div class="keditor-snippets-wrapper keditor-snippets-wrapper-component">\n<div class="keditor-snippets keditor-snippets-component"></div>\n</div>\n':'\n<div class="keditor-snippets-wrapper">\n<div class="keditor-snippets"></div>\n</div>\n';var i=t.modal=$('\n<div class="keditor-ui keditor-modal" id="'.concat(e,'">\n<div class="keditor-modal-header">\n<button type="button" class="keditor-modal-close">&times;</button>\n<h4 class="keditor-modal-title"></h4>\n</div>\n<div class="keditor-modal-body">').concat(o,'</div>\n<div class="keditor-modal-footer">\n<button type="button" class="keditor-ui keditor-btn keditor-btn-default keditor-modal-close">Close</button>\n<button type="button" class="keditor-ui keditor-btn keditor-btn-primary keditor-modal-add">Add</button>\n</div>\n</div>\n'));"string"==typeof n.snippetsUrl&&n.snippetsUrl.length>0?(s('Getting snippets form "'.concat(n.snippetsUrl,'"...')),$.ajax({type:"get",dataType:"html",url:n.snippetsUrl,success:function(e){s("Success in getting snippets"),"function"==typeof n.onSnippetsLoaded&&(e=n.onSnippetsLoaded.call(t,e)||e),t.renderSnippets(e),n.snippetsFilterEnabled&&(n.explicitSnippetEnabled?(t.initSnippetsFilter(y),t.initSnippetsFilter(b)):t.initSnippetsFilter(v))},error:function(e){s("Error when getting snippets",e),"function"==typeof n.onSnippetsError&&n.onSnippetsError.call(t,e)}}),i.find(".keditor-modal-close").on("click",function(n){n.preventDefault(),t.closeModal()}),i.find(".keditor-modal-add").on("click",function(e){e.preventDefault();var o=i.find(".keditor-snippets-wrapper .selected");if(0!==o.length){var a,r,s=t.modalTarget.closest(".keditor-content-area"),c=o.attr("data-type"),d=i.find(o.attr("data-snippet")),l=d.html(),p=!1,u=!1,f=!1;if(n.explicitSnippetEnabled)switch(t.modalSnippetType){case b:u=!0;break;case y:p=!0}else if("container"===c)p=!0;else switch(t.modalSnippetType){case b:u=!0;break;case v:t.modalTarget.is(".keditor-container-content-inner")?u=!0:f=!0}if(p&&(t.body.find(".keditor-container.showed-keditor-toolbar").removeClass("showed-keditor-toolbar"),a=$('\n<section class="keditor-ui keditor-container showed-keditor-toolbar">\n<section class="keditor-ui keditor-container-inner">'.concat(l,"</section>\n</section>\n")),t.modalTarget.append(a),"function"==typeof n.onContainerSnippetAdded&&n.onContainerSnippetAdded.call(t,e,a,o,s),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,s),t.initContainer(s,a)),u){var m=t.getDataAttributes(d,null,!0);r=$('\n<section class="keditor-ui keditor-component" data-type="'.concat(c,'" ').concat(m.join(" "),'>\n<section class="keditor-ui keditor-component-content">').concat(l,"</section>\n</section>\n")),t.modalTarget.append(r);var h=t.modalTarget.closest(".keditor-container");"function"==typeof n.onComponentSnippetAdded&&n.onComponentSnippetAdded.call(t,e,r,o,s),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,s),t.initComponent(s,h,r)}if(f){t.body.find(".keditor-container.showed-keditor-toolbar").removeClass("showed-keditor-toolbar");var C=t.getDataAttributes(d,null,!0);a=$('\n<section class="keditor-ui keditor-container showed-keditor-toolbar">\n<section class="keditor-ui keditor-container-inner">'.concat(n.containerForQuickAddComponent,"</section>\n</section>\n")),r=$('\n<section class="keditor-ui keditor-component" data-type="'.concat(c,'" ').concat(C.join(" "),'>\n<section class="keditor-ui keditor-component-content">').concat(l,"</section>\n</section>\n")),a.find('[data-type="container-content"]').eq(0).html(r),t.modalTarget.append(a),"function"==typeof n.onComponentSnippetAdded&&n.onComponentSnippetAdded.call(t,e,r,o,s),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,s),t.initContainer(s,a)}t.closeModal()}}),i.on("click",".keditor-snippet",function(t){t.preventDefault();var n=$(this);n.hasClass("selected")||(n.parent().find(".selected").removeClass("selected"),n.addClass("selected"))}),i.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){i.hasClass("showed")||(i.css("display","none"),$(document.body).removeClass("opened-modal"))}),i.appendTo(document.body)):c('"snippetsUrl" must be not null!')}.apply(this)}},{key:"renderSnippets",value:function(t){return function(t){s("renderSnippets");var n=this,e=n.options,o="",i="",a="";n.snippetsCategories=[],n.snippetsContainerCategories=[],n.snippetsComponentCategories=[],$(t).filter("div").each(function(t){var r=$(this),s=n.generateId("snippet"),c=r.html().trim(),d=r.attr("data-preview"),l=r.attr("data-type"),p=r.attr("data-keditor-title"),u=r.attr("data-keditor-categories")||"",f='\n<section\nclass="keditor-ui keditor-snippet"\ndata-snippet="#'.concat(s,'"\ndata-type="').concat(l,'"\ntitle="').concat(p,'"\ndata-keditor-categories="').concat(u,'"\n>\n<span><span style="background-image: url(\'').concat(d,"')\"></span></span>\n</section>\n");u=u.split(e.snippetsCategoriesSeparator),"container"===l?(o+=f,n.snippetsContainerCategories=n.snippetsContainerCategories.concat(u)):-1!==l.indexOf("component")&&(i+=f,n.snippetsComponentCategories=n.snippetsComponentCategories.concat(u));var m=n.getDataAttributes(r,["data-preview","data-type","data-keditor-title","data-keditor-categories"],!0);a+='<script id="'.concat(s,'" type="text/html" ').concat(m.join(" "),">").concat(c,"<\/script>")}),n.snippetsContainerCategories=n.beautifyCategories(n.snippetsContainerCategories),n.snippetsComponentCategories=n.beautifyCategories(n.snippetsComponentCategories),n.snippetsCategories=n.beautifyCategories([].concat(k(n.snippetsContainerCategories),k(n.snippetsComponentCategories))),e.explicitSnippetEnabled?(n.modal.find(".keditor-snippets-container").html(o),n.modal.find(".keditor-snippets-component").html(i)):n.modal.find(".keditor-snippets").html(o+i),n.modal.find(".keditor-modal-body").append(a)}.apply(this,[t])}},{key:"initSnippetsFilter",value:function(t){return function(t){s("initSnippetsFilter");var n,e,o=this.options,i=this.modal;switch(t){case v:n=this.snippetsCategories,e=".keditor-snippets-wrapper";break;case y:n=this.snippetsContainerCategories,e=".keditor-snippets-wrapper-container";break;case b:n=this.snippetsComponentCategories,e=".keditor-snippets-wrapper-component"}var a="";$.each(n,function(t,n){a+='<option value="'.concat(n,'">').concat(n,"</option>")});var r=i.find(e),c=r.find(".keditor-snippets").children(".keditor-snippet");r.prepend('\n<div class="keditor-ui keditor-snippets-filter-wrapper">\n<select class="keditor-ui keditor-snippets-filter">\n<option value="" selected="selected">All</option>\n'.concat(a,'\n</select>\n<input type="text" class="keditor-ui keditor-snippets-search" value="" placeholder="Type to search..." />\n</div>\n')),c.each(function(){var t=$(this),n=t.attr("data-keditor-categories")||"",e=n.toLowerCase();n=n.split(o.snippetsCategoriesSeparator),e=e.split(o.snippetsCategoriesSeparator),t.data("categories",n),t.data("categoriesFilter",e)});var d,l=r.find(".keditor-snippets-search"),p=r.find(".keditor-snippets-filter"),u=function(){var t=(p.val()||"").toLowerCase(),n=(l.val()||"").toLowerCase();c.filter(".selected").removeClass("selected"),t||n?(s("Filtering snippets"),c.each(function(){var e=$(this),o=e.data("categoriesFilter"),i=o.join(";"),a=0;t&&-1===$.inArray(t,o)&&a++,n&&-1===e.attr("title").toLowerCase().indexOf(n)&&-1===i.indexOf(n)&&a++,e[0===a?"removeClass":"addClass"]("not-matched")})):(s("Show all snippets"),c.removeClass("not-matched"))};p.on("change",function(){u()}),l.on("keydown",function(){clearTimeout(d),d=setTimeout(u,200)})}.apply(this,[t])}},{key:"openModal",value:function(t,n){return function(t,n){s("openModal",t,n);var e=this.modal,o=this.options,i="";switch(n){case y:i="Add container";break;case b:i="Add component"}o.explicitSnippetEnabled?(e.find(".keditor-snippets-wrapper").css("display","none"),e.find(n===b?".keditor-snippets-wrapper-component":".keditor-snippets-wrapper-container").css("display","block")):(e.find(".keditor-snippets-wrapper").css("display","block").find(".keditor-snippet[data-type=container]").css("display",n===b?"none":"block"),i="Add content"),e.find(".keditor-modal-title").html(i),this.modalTarget=t,this.modalSnippetType=n,e.css("display","block"),$(document.body).addClass("opened-modal"),setTimeout(function(){e.addClass("showed")},0)}.apply(this,[t,n])}},{key:"closeModal",value:function(){return function(){var t=this.modal;this.modalTarget=null,this.modalAction=null,t.find(".keditor-modal-title").html(""),t.find(".keditor-snippets-wrapper .selected").removeClass("selected"),t.removeClass("showed")}.apply(this)}},{key:"initContentAreas",value:function(){return function(){s("initContentAreas");var t,n=this,e=n.contentAreasWrapper,o=n.options;if(o.contentAreasSelector&&(t=e.find(o.contentAreasSelector)),!t||0===t.length){s("Do not find any content area. Creating default content area...");var i=e.html();t=$("<div />").html(i),e.empty().append(t)}t.each(function(){var t=$(this);t.attr("id")||t.attr("id",n.generateId("content-area")),n.initContentArea(t)})}.apply(this)}},{key:"initContentArea",value:function(t,n){return function(t,n){s("initContentArea",t);var e=this,o=e.options;t.addClass("keditor-content-area");var i=t.html(),a=$('<div class="keditor-content-area-inner"></div>').html(i);if(t.html(a),"function"==typeof o.onBeforeInitContentArea&&o.onBeforeInitContentArea.call(e,t),!n){var r=$(e.generateToolbar(d));t.append(r),r.children(o.explicitSnippetEnabled?".btn-add-container":".btn-add-content").on("click",function(t){t.preventDefault(),e.openModal(a,o.explicitSnippetEnabled?y:v)})}if(s("Initialize $.fn.sortable for content area"),a.sortable({handle:".keditor-toolbar-container:not(.keditor-toolbar-sub-container) .btn-container-reposition",items:"> section",helper:"clone",connectWith:".keditor-content-area",axis:"y",tolerance:"pointer",sort:function(){$(this).removeClass("ui-state-default")},receive:function(n,i){s("On received snippet",n,i);var a=i.helper,r=i.item;a&&a.remove(),e.closeSidebar(),"function"==typeof o.onContentChanged&&o.onContentChanged.call(e,n,t),r.addClass("keditor-ui-dragging")},start:function(t,n){n.item.addClass("keditor-ui-dragging")},stop:function(t,n){n.helper&&n.helper.remove(),n.item.removeClass("keditor-ui-dragging")}}),s("Initialize existing containers in content area"),a.children("section").each(function(){e.convertToContainer(t,$(this))}),"function"==typeof o.onInitContentArea){var c=o.onInitContentArea.call(e,t);c&&c.length>0&&$.each(c,function(){e.convertToContainer(t,$(this))})}}.apply(this,[t,n])}},{key:"convertToContainer",value:function(t,n){return function(t,n){s("convertToContainer",t,n);var e;n.is("section")?(n.addClass("keditor-ui keditor-container"),n.wrapInner('<section class="keditor-ui keditor-container-inner"></section>'),e=n):(n.wrap('<section class="keditor-ui keditor-container"><section class="keditor-ui keditor-container-inner"></section></section>'),e=n.parent().parent()),this.initContainer(t,e)}.apply(this,[t,n])}},{key:"initContainer",value:function(t,n){return function(t,n){var e=this,o=e.options,i=o.nestedContainerEnabled&&n.closest('[data-type="container-content"]').length>0;if(s("initContainer - isNested=".concat(i),t,n),n.hasClass("keditor-initialized-container")&&n.hasClass("keditor-initializing-container"))n.hasClass("keditor-initialized-container")?s("Container is already initialized!"):s("Container is initializing...");else{n.addClass("keditor-initializing-container"),"function"==typeof o.onBeforeInitContainer&&o.onBeforeInitContainer.call(e,n,t),i&&n.addClass("keditor-sub-container"),s("Render KEditor toolbar for container",n),n.append(e.generateToolbar(i?p:l)),n.attr("id",e.generateId(i?"sub-container":"container"));var a=n.find('[data-type="container-content"]');s("Initialize ".concat(a.length," container content(s)")),a.each(function(){var a=$(this);o.nestedContainerEnabled&&!i&&a.parents('[data-type="container-content"]').length>0||e.initContainerContent(t,n,a,i)}),"function"==typeof o.onInitContainer&&o.onInitContainer.call(e,n,t),n.addClass("keditor-initialized-container"),n.removeClass("keditor-initializing-container")}}.apply(this,[t,n])}},{key:"initContainerContent",value:function(t,n,e,o){return function(t,n,e,o){s("initContainerContent - isNested=".concat(o),t,n,e);var i=this,a=i.options;e.addClass("keditor-container-content"),o&&e.addClass("keditor-sub-container-content"),e.attr("id",i.generateId("container-content"));var r=$('<div class="keditor-container-content-inner"></div>');r.html(e.html()),e.html(r),s("Initialize toolbar for container content");var c=$(i.generateToolbar(o?f:u));c.appendTo(e),a.explicitSnippetEnabled?(o||a.explicitSnippetEnabled&&c.children(".btn-add-container").on("click",function(t){t.preventDefault(),i.openModal(r,y)}),c.children(".btn-add-component").on("click",function(t){t.preventDefault(),i.openModal(r,b)})):c.children(".btn-add-content").on("click",function(t){t.preventDefault(),i.openModal(r,o?b:a.nestedContainerEnabled?v:b)}),s("Initialize $.fn.sortable for container content"),r.sortable({handle:".btn-component-reposition, .btn-container-reposition",helper:"clone",items:"> section",connectWith:".keditor-container-content-inner",tolerance:"pointer",sort:function(){$(this).removeClass("ui-state-default")},receive:function(n,e){s("On received snippet",n,e);var o,r=e.helper,c=e.item;r&&r.remove(),(o=c.closest(".keditor-container")).hasClass("showed-keditor-toolbar")||($(".keditor-container.showed-keditor-toolbar").removeClass("showed-keditor-toolbar"),o.addClass("showed-keditor-toolbar")),"function"==typeof a.onContainerChanged&&a.onContainerChanged.call(i,n,o,t),"function"==typeof a.onContentChanged&&a.onContentChanged.call(i,n,t),c.removeClass("keditor-ui-dragging")},start:function(t,n){n.item.addClass("keditor-ui-dragging")},stop:function(t,n){n.helper&&n.helper.remove(),n.item.removeClass("keditor-ui-dragging")}}),s("Initialize existing components inside container content"),r.children().each(function(){var e=$(this);e.find('[data-type="container-content"]').length>0?i.convertToContainer(t,e):i.convertToComponent(t,n,e,!0)})}.apply(this,[t,n,e,o])}},{key:"convertToComponent",value:function(t,n,e,o){return function(t,n,e,o){if(s("convertToComponent",t,n,e,o),!e.is(".keditor-container-content-toolbar")){var i;e.is("section")?(e.addClass("keditor-ui keditor-component"),e.wrapInner('<section class="keditor-ui keditor-component-content"></section>'),i=e):(e.wrap('<section class="keditor-ui keditor-component"><section class="keditor-ui keditor-component-content"></section></section>'),i=e.parent().parent()),o&&i.addClass("existing-component"),this.initComponent(t,n,i)}}.apply(this,[t,n,e,o])}},{key:"initComponent",value:function(t,n,e){return S.apply(this,[t,n,e])}},{key:"initDynamicContent",value:function(t){return function(t){s("initDynamicContent",t);var n=this,e=n.options,o=t.closest(".keditor-component"),i=t.closest(".keditor-content-area");t.attr("id",n.generateId("dynamic-element")),"function"==typeof e.onBeforeDynamicContentLoad&&e.onBeforeDynamicContentLoad.call(n,t,o,i);var a=t.attr("data-dynamic-href"),r=n.getDataAttributes(o,["data-type","data-dynamic-href"],!1);return r=$.param(r),s("Dynamic href: ".concat(a,", Data: ").concat(r)),$.ajax({url:a,data:r,type:"GET",dataType:"HTML",success:function(o,a,r){s("Dynamic content is loaded",t,o,a,r),t.html(o),"function"==typeof e.onDynamicContentLoaded&&e.onDynamicContentLoaded.call(n,t,o,a,r,i)},error:function(o,a,r){s("Error when loading dynamic content",t,o,a,r),"function"==typeof e.onDynamicContentError&&e.onDynamicContentError.call(n,t,o,a,r,i)}})}.apply(this,[t])}},{key:"deleteComponent",value:function(t){return w.apply(this,[t])}},{key:"getComponentContent",value:function(t){return T.apply(this,[t])}},{key:"getContainerContent",value:function(t,n){return function(t,n){s("getContainerContent - isNested=".concat(n),t);var e=this,o=t.children(".keditor-container-inner").clone();return o.find("[data-type=container-content]").not(n?"":".keditor-sub-container-content").each(function(){var t=$(this);t.removeClass("keditor-container-content keditor-sub-container-content ui-sortable").removeAttr("id");var n=t.children(),o="";n.children().each(function(){var t=$(this);t.is(".keditor-component")?o+=e.getComponentContent(t):t.is(".keditor-sub-container")&&(o+=e.getContainerContent(t,!0))}),t.html(o)}),"<section>".concat(o.html(),"</section>")}.apply(this,[t,n])}},{key:"getContent",value:function(t){return function(t){var n=this,e=[];return n.contentAreasWrapper.find(".keditor-content-area-inner").each(function(){var t="";$(this).children(".keditor-container").each(function(){var e=$(this);t+=n.getContainerContent(e)}),e.push(t)}),t?e:e.join("\n")}.apply(this,[t])}},{key:"setContent",value:function(t,n){return function(t,n){var e=this.contentAreasWrapper;n?n.jquery||(n=e.find(n)):n=e.children(".keditor-content-area"),0===n.length&&c("Content area does not exist!"),n.html(t),this.initContentArea(n,!0)}.apply(this,[t,n])}},{key:"destroy",value:function(){return D.apply(this)}}]),t}();I(j,"DEFAULTS",r),I(j,"debug",!1),I(j,"version","2.0.0"),I(j,"instances",{}),I(j,"components",{blank:{settingEnabled:!1}}),i.a.fn.keditor=function(t){var n=i()(this),e=n.data("keditor");return"string"!=typeof t?(e||(e=j.init(n,t),n.data("keditor",e)),e):e&&e[t]&&"function"==typeof e[t]?e[t].apply(e,Array.prototype.slice.call(arguments,1)):void 0},window.KEditor=i.a.keditor=i.a.fn.keditor.constructor=j}])});
//# sourceMappingURL=keditor.js.map