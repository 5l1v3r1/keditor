/*! KEditor v2.0.0 | Copyright (c) 2016-present Kademi (http://kademi.co) */
!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("jQuery"));else if("function"==typeof define&&define.amd)define(["jQuery"],n);else{var e="object"==typeof exports?n(require("jQuery")):n(t.jQuery);for(var o in e)("object"==typeof exports?exports:t)[o]=e[o]}}("undefined"!=typeof self?self:this,function(t){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)e.d(o,a,function(n){return t[n]}.bind(null,a));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=5)}([,function(n,e){n.exports=t},,function(t,n,e){},,function(t,n,e){"use strict";e.r(n);var o=e(1),a=e.n(o),i={UI:"keditor-ui",UI_DRAGGING:"keditor-ui-dragging",UI_HIDDEN:"keditor-ui-hidden",SORTABLE:"ui-sortable",WRAPPER:"keditor-wrapper",BTN:"keditor-btn",BTN_PRIMARY:"keditor-btn-primary",BTN_DEFAULT:"keditor-btn-default",STATE_ACTIVE:"active",STATE_OPENED:"opened",STATE_SHOWED:"showed",STATE_SELECTED:"selected",STATE_DUPLICATED:"duplicated",STATE_INITIALIZED:"initialized",STATE_INITIALIZING:"initializing",STATE_TOOLBAR_SHOWED:"showed-keditor-toolbar",STATE_SETTING_OPENED:"opened-keditor-setting",STATE_SIDEBAR_OPENED:"opened-keditor-sidebar",STATE_MODAL_OPENED:"opened-modal",STATE_NOT_MATCHED:"not-matched",ADD_CONTENT:"btn-add-content",ADD_COMPONENT:"btn-add-component",ADD_CONTAINER:"btn-add-container",SIDEBAR:"keditor-sidebar",SIDEBAR_HEADER:"keditor-sidebar-header",SIDEBAR_BODY:"keditor-sidebar-body",SIDEBAR_TITLE:"keditor-sidebar-title",SIDEBAR_CLOSER:"keditor-sidebar-closer",TOPBAR:"keditor-topbar",TOPBAR_LEFT:"keditor-topbar-left",TOPBAR_CENTER:"keditor-topbar-center",TOPBAR_RIGHT:"keditor-topbar-right",TOPBAR_BUTTON:"keditor-topbar-btn",TOPBAR_TITLE:"keditor-topbar-title",MODAL:"keditor-modal",MODAL_COMPONENT:"keditor-modal-component",MODAL_CONTAINER:"keditor-modal-container",MODAL_HEADER:"keditor-modal-header",MODAL_BODY:"keditor-modal-body",MODAL_FOOTER:"keditor-modal-footer",MODAL_CLOSE:"keditor-modal-close",MODAL_ADD:"keditor-modal-add",SNIPPET:"keditor-snippet",SNIPPET_INNER:"keditor-snippet-inner",SNIPPET_TITLE:"keditor-snippet-title",SNIPPET_PREVIEW:"keditor-snippet-preview",SNIPPET_CONTAINER:"keditor-snippet-container",SNIPPET_COMPONENT:"keditor-snippet-component",SNIPPETS:"keditor-snippets",SNIPPETS_FILTER:"keditor-snippets-filter",SNIPPETS_FILTER_COMPONENT:"keditor-snippets-filter-component",SNIPPETS_FILTER_CONTAINER:"keditor-snippets-filter-container",SNIPPETS_FILTER_LABEL:"keditor-snippets-filter-label",SNIPPETS_SEARCH:"keditor-snippets-search",SNIPPETS_FILTER_WRAPPER:"keditor-snippets-filter-wrapper",SNIPPETS_COMPONENT:"keditor-snippets-component",SNIPPETS_WRAPPER:"keditor-snippets-wrapper",SETTING:"keditor-setting",SETTING_FORM:"keditor-setting-form",SETTING_EXTRA:"keditor-setting-extra",SETTING_CONTAINER:"keditor-setting-container",CONTENT_AREA:"keditor-content-area",CONTENT_AREA_INNER:"keditor-content-area-inner",CONTENT_AREAS:"keditor-content-areas",CONTENT_AREAS_WRAPPER:"keditor-content-areas-wrapper",IFRAME:"keditor-iframe",IFRAME_WRAPPER:"keditor-iframe-wrapper",IFRAME_COVER_WRAPPER:"keditor-iframe-cover-wrapper",IFRAME_COVER_WRAPPER_FAKE:"keditor-iframe-cover-wrapper-fake",IFRAME_COVER:"keditor-iframe-cover",IFRAME_COVER_HIDDEN:"hidden-cover",COMPONENT:"keditor-component",COMPONENT_REPOSITION:"btn-component-reposition",COMPONENT_SETTING:"btn-component-setting",COMPONENT_DUPLICATE:"btn-component-duplicate",COMPONENT_DELETE:"btn-component-delete",COMPONENT_CONTENT:"keditor-component-content",COMPONENT_EXISTING:"existing-component",CONTAINER:"keditor-container",CONTAINER_TOOLBAR:"keditor-toolbar-container",CONTAINER_REPOSITION:"btn-container-reposition",CONTAINER_DUPLICATE:"btn-container-duplicate",CONTAINER_DELETE:"btn-container-delete",CONTAINER_SETTING:"btn-container-setting",CONTAINER_INNER:"keditor-container-inner",CONTAINER_CONTENT:"keditor-container-content",CONTAINER_CONTENT_INNER:"keditor-container-content-inner",CONTAINER_CONTENT_TOOLBAR:"keditor-container-content-toolbar",SUB_CONTAINER:"keditor-sub-container",SUB_CONTAINER_CONTENT:"keditor-sub-container-content",SUB_CONTAINER_TOOLBAR:"keditor-toolbar-sub-container",PREVIEW_AREA:"keditor-preview-area"},c={title:"Editing with KEditor",nestedContainerEnabled:!0,explicitSnippetEnabled:!1,containerForQuickAddComponent:'\n<div class="row">\n<div class="col-sm-12" data-type="container-content">\n</div>\n</div>\n',extraSettings:null,btnAddContentText:'<i class="fa fa-plus"></i>',btnAddContainerText:'<i class="fa fa-plus"></i> <i class="fa fa-fw fa-columns"></i>',btnAddSubContainerText:'<i class="fa fa-plus"></i> <i class="fa fa-fw fa-columns"></i>',btnAddComponentText:'<i class="fa fa-plus"></i> <i class="fa fa-fw fa-list-ul"></i>',btnMoveContainerText:'<i class="fa fa-sort"></i>',btnMoveComponentText:'<i class="fa fa-arrows"></i>',btnSettingContainerText:'<i class="fa fa-cog"></i>',btnSettingComponentText:'<i class="fa fa-cog"></i>',btnDuplicateContainerText:'<i class="fa fa-files-o"></i>',btnDuplicateComponentText:'<i class="fa fa-files-o"></i>',btnDeleteContainerText:'<i class="fa fa-times"></i>',btnDeleteComponentText:'<i class="fa fa-times"></i>',confirmDeleteContainerText:"Are you sure that you want to delete this container? This action can not be undone!",confirmDeleteComponentText:"Are you sure that you want to delete this component? This action can not be undone!",widthMobile:320,widthTablet:768,defaultComponentType:"blank",snippetsUrl:"snippets/snippets.html",snippetsCategoriesSeparator:";",contentStyles:[],contentAreasSelector:null,contentAreasWrapper:'<div class="'.concat(i.UI," ").concat(i.CONTENT_AREAS_WRAPPER,'"></div>'),containerSettingEnabled:!1,containerSettingInitFunction:null,containerSettingShowFunction:null,containerSettingHideFunction:null,onReady:function(){},onSave:function(t){},onSnippetsLoaded:function(t){},onSnippetsError:function(t){},onInitIframe:function(t,n,e){},onContentChanged:function(t,n){},onBeforeInitContentArea:function(t){},onInitContentArea:function(t){},onBeforeInitContainer:function(t,n){},onInitContainer:function(t,n){},onBeforeContainerDeleted:function(t,n,e){},onContainerDeleted:function(t,n,e){},onContainerChanged:function(t,n,e){},onContainerDuplicated:function(t,n,e,o){},onContainerSelected:function(t,n,e){},onContainerSnippetAdded:function(t,n,e,o){},onComponentReady:function(t){},onBeforeInitComponent:function(t,n){},onInitComponent:function(t,n){},onBeforeComponentDeleted:function(t,n,e){},onComponentDeleted:function(t,n,e){},onComponentChanged:function(t,n,e){},onComponentDuplicated:function(t,n,e,o){},onComponentSelected:function(t,n,e){},onComponentSnippetAdded:function(t,n,e,o){},onBeforeDynamicContentLoad:function(t,n,e){},onDynamicContentLoaded:function(t,n,e){},onDynamicContentError:function(t,n,e){}},r=0,s=1,l=2,d=3,p=4,T=5,f=function(t){var n=this,e=n.options,o=n.sidebar,a=o.find(".".concat(i.SIDEBAR_TITLE)),c=o.find(".".concat(i.SIDEBAR_BODY));if(c.children(".".concat(i.STATE_ACTIVE)).removeClass(i.STATE_ACTIVE),t.is(".".concat(i.COMPONENT))){n.setSettingComponent(t),n.setSettingContainer(null);var r=n.getComponentType(t),s=KEditor.components[r];a.html(s.settingTitle);var l="".concat(i.SETTING,"-").concat(r),d=c.find(".".concat(l));if(0===d.length){var p=KEditor.components[r];if("function"==typeof p.initSettingForm){d=$('\n<div\ndata-type="'.concat(r,'"\nclass="').concat(i.UI," ").concat(i.SETTING_FORM," ").concat(l," ").concat(i.STATE_ACTIVE,'"\n>\n</div>\n'));var T=$("<span />").html("Loading...");c.append(d),d.append(T);var f=p.initSettingForm.call(p,d,n);$.when(f).done(function(){setTimeout(function(){T.remove(),"function"==typeof p.showSettingForm&&p.showSettingForm.call(p,d,t,n)},100)})}}else"function"==typeof s.showSettingForm&&s.showSettingForm.call(s,d,t,n),d.addClass(i.STATE_ACTIVE)}else if(t.is("".concat(i.CONTAINER))){n.setSettingContainer(t),n.setSettingComponent(null),a.html("Container Settings");var E=o.find(".".concat(i.SETTING_CONTAINER));"function"==typeof e.containerSettingShowFunction&&e.containerSettingShowFunction.call(n,E,t,n),E.addClass(i.STATE_ACTIVE)}else{var u=t.attr("data-extra-setting"),C=e.extraSettings[u];a.html(C.title);var A=o.find(".".concat(i.SETTING_EXTRA,"[data-extra-setting=").concat(u,"]"));"function"==typeof C.settingShowFunction&&C.settingShowFunction.call(n,A,t,n),A.addClass(i.STATE_ACTIVE)}o.addClass(i.STATE_OPENED)},E=function(){var t=this.options,n=this.sidebar,e=n.find(".".concat(i.SIDEBAR_BODY)).children(".".concat(i.STATE_ACTIVE));if(e.length>0){if(e.is(".".concat(i.SETTING_CONTAINER)))"function"==typeof t.containerSettingHideFunction&&t.containerSettingHideFunction.call(this,e,this);else if(e.is("[data-type]")){var o=e.attr("data-type"),a=KEditor.components[o];"function"==typeof a.hideSettingForm&&a.hideSettingForm.call(a,e,this)}else e.is("[data-extra-setting]");e.removeClass(i.STATE_ACTIVE)}this.setSettingComponent(null),this.setSettingContainer(null),n.removeClass(i.STATE_OPENED)},u=function(t,n,e,o,a,c){var r=this.options,s=this.generateId(),l='\n<section\nclass="'.concat(i.UI," ").concat(i.SNIPPET," ").concat("container"===t?i.SNIPPET_CONTAINER:i.SNIPPET_COMPONENT,'"\ndata-snippet="#').concat(s,'"\ndata-type="').concat(t,'"\ndata-keditor-title="').concat(n,'"\ndata-keditor-categories="').concat(o,'"\n>\n<span class="').concat(i.SNIPPET_INNER,'">\n<span class="').concat(i.SNIPPET_PREVIEW,'" style="background-image: url(\'').concat(e,'\')"></span>\n<span class="').concat(i.SNIPPET_TITLE,'" title="').concat(n,'">').concat(n,"</span>\n</span>\n</section>\n"),d='<script id="'.concat(s,'" type="text/html" ').concat(c.join(" "),">").concat(a,"<\/script>");return o=o.split(r.snippetsCategoriesSeparator),"container"===t?this.snippetsContainerCategories=this.snippetsContainerCategories.concat(o):-1!==t.indexOf("component")&&(this.snippetsComponentCategories=this.snippetsComponentCategories.concat(o)),[l,d]};function C(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],o=!0,a=!1,i=void 0;try{for(var c,r=t[Symbol.iterator]();!(o=(c=r.next()).done)&&(e.push(c.value),!n||e.length!==n);o=!0);}catch(t){a=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var A=function(){var t=this,n=t.modal,e='<option value="" selected="selected">All</option>';return $.each(t.snippetsComponentCategories,function(t,n){e+='<option value="'.concat(n,'" class="').concat(i.SNIPPETS_FILTER_COMPONENT,'">').concat(n,"</option>")}),$.each(t.snippetsContainerCategories,function(n,o){var a=-1!==$.inArray(o,t.snippetsComponentCategories);e+='<option value="'.concat(o,'" class="').concat(i.SNIPPETS_FILTER_CONTAINER," ").concat(a?i.STATE_DUPLICATED:"",'">').concat(o,"</option>")}),[e,n.find(".".concat(i.MODAL_HEADER))]};function N(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],o=!0,a=!1,i=void 0;try{for(var c,r=t[Symbol.iterator]();!(o=(c=r.next()).done)&&(e.push(c.value),!n||e.length!==n);o=!0);}catch(t){a=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function h(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],o=!0,a=!1,i=void 0;try{for(var c,r=t[Symbol.iterator]();!(o=(c=r.next()).done)&&(e.push(c.value),!n||e.length!==n);o=!0);}catch(t){a=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(a)throw i}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var I=function(t){var n=this.options,e=(t.attr("data-type")||"").replace("component-","");return e&&e in KEditor.components?e:("string"==typeof n.defaultComponentType?e=n.defaultComponentType:"function"==typeof n.defaultComponentType&&(e=n.defaultComponentType.call(this,t)),e||this.error("Component type is undefined!"),e)},v=function(t,n,e){var o=this,a=o.options;if(!e.hasClass(i.STATE_INITIALIZED)||!e.hasClass(i.STATE_INITIALIZING)){e.addClass(i.STATE_INITIALIZING),e.attr("id",o.generateId()),"function"==typeof a.onBeforeInitComponent&&a.onBeforeInitComponent.call(o,e,t),e.children(".".concat(i.COMPONENT_CONTENT)).attr("id",o.generateId());var c=o.getComponentType(e),r=KEditor.components[c];e.append(o.generateToolbar(T,r.settingEnabled)),e.find("[data-dynamic-href]").each(function(){var t=$(this);o.initDynamicContent(t)}),"function"==typeof r.init&&r.init.call(r,t,n,e,o),"function"==typeof a.onInitComponent&&a.onInitComponent.call(o,e,t),e.addClass(i.STATE_INITIALIZED),e.removeClass(i.STATE_INITIALIZING)}},O=function(t){var n=this.getComponentType(t),e=KEditor.components[n];"function"==typeof e.destroy&&e.destroy.call(e,t,this),t.remove()},S=function(t){var n,e=t.clone(),o=this.getComponentType(e),a=KEditor.components[o],c=this.getDataAttributes(e,null,!0),r=e.find(".".concat(i.IFRAME_COVER_WRAPPER));if(r.length>0){r.find(".".concat(i.IFRAME_COVER)).remove();var s=r.children("iframe");r.hasClass(i.IFRAME_COVER_WRAPPER_FAKE)?s.unwrap():r.removeClass(i.IFRAME_COVER_WRAPPER)}"function"==typeof a.getContent?n=a.getContent.call(a,e,this):n=e.children(".".concat(i.COMPONENT_CONTENT)).html();return e.html(n).find("[data-dynamic-href]").each(function(){$(this).html("")}),"<section ".concat(c.join(" "),">").concat(e.html(),"</section>")},_=function(t,n){this.element=t,this.options=$.extend({},c,n),this.initContentAreaWrapper(),this.initTopbar(),this.initSidebar(),this.initSnippetsModal(),this.initExtraSettings(),this.id=this.generateId(),KEditor.instances[this.id]=this,"function"==typeof this.options.onReady&&this.options.onReady.call(this)},m=function(){var t=this.element,n=this.id,e=this.getContent(!1);this.wrapper.remove(),t.is("textarea")?t.val(e):t.html(e),t.removeClass(i.UI_HIDDEN),t.data("keditor",null),delete KEditor.instances[n]};e(3);function y(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function R(t,n,e){return n&&y(t.prototype,n),e&&y(t,e),t}function D(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}a.a.fn.sortable||error("$.fn.sortable does not exist. Please import $.fn.sortable into your document for continue using KEditor."),window.KEDITOR_DEBUG=!0;var g=function(){function t(n,e){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),_.apply(this,[n,e])}return R(t,null,[{key:"log",value:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(){if(console&&"function"==typeof console.log&&window.KEDITOR_DEBUG){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];console.log.apply(console,["[ KEditor ] "].concat(n))}}.apply(null,n)}},{key:"error",value:function(t){throw new Error("[ KEditor ] ".concat(t))}},{key:"init",value:function(n,e){return new t(n,e)}}]),R(t,[{key:"generateId",value:function(){return t=(new Date).getTime(),n=Math.round(9876543210*Math.random()),"keditor-ui-".concat(t).concat(n);var t,n}},{key:"generateToolbar",value:function(t,n){return function(t,n){var e=this.options,o="";if(!e.explicitSnippetEnabled)switch(t){case r:case d:case p:return'\n<div class="keditor-ui '.concat("keditor-container-content-toolbar",'">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-content" title="Add content">').concat(e.btnAddContentText,"</a>\n</div>\n")}switch(t){case r:return'\n<div class="keditor-ui keditor-content-area-toolbar">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-container" title="Add container">'.concat(e.btnAddContainerText,"</a>\n</div>\n");case s:return!0===e.containerSettingEnabled&&(o='<a href="javascript:void(0);" class="keditor-ui btn-container-setting">'.concat(e.btnSettingContainerText,"</a>")),'\n<div class="keditor-toolbar keditor-toolbar-container">\n<a href="javascript:void(0);" class="keditor-ui btn-container-reposition">'.concat(e.btnMoveContainerText,"</a>\n").concat(o,'\n<a href="javascript:void(0);" class="keditor-ui btn-container-duplicate">').concat(e.btnDuplicateContainerText,'</a>\n<a href="javascript:void(0);" class="keditor-ui btn-container-delete">').concat(e.btnDeleteContainerText,"</a>\n</div>\n");case l:return!0===e.containerSettingEnabled&&(o='<a href="javascript:void(0);" class="keditor-ui btn-container-setting">'.concat(e.btnSettingContainerText,"</a>")),'\n<div class="keditor-toolbar keditor-toolbar-container keditor-toolbar-sub-container">\n<a href="javascript:void(0);" class="keditor-ui btn-container-reposition">'.concat(e.btnMoveContainerText,"</a>\n").concat(o,'\n<a href="javascript:void(0);" class="keditor-ui btn-container-duplicate">').concat(e.btnDuplicateContainerText,'</a>\n<a href="javascript:void(0);" class="keditor-ui btn-container-delete">').concat(e.btnDeleteContainerText,"</a>\n</div>\n");case d:return'\n<div class="keditor-ui keditor-container-content-toolbar keditor-btn-group">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-container" title="Add sub-container">'.concat(e.btnAddSubContainerText,'</a>\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-component" title="Add component">').concat(e.btnAddComponentText,"</a>\n</div>\n");case p:return'\n<div class="keditor-ui keditor-container-content-toolbar">\n<a href="javascript:void(0)" class="keditor-ui keditor-btn keditor-btn-default btn-add-component" title="Add component">'.concat(e.btnAddComponentText,"</a>\n</div>\n");case T:return n&&(o='<a href="javascript:void(0);" class="keditor-ui btn-component-setting">'.concat(e.btnSettingComponentText,"</a>")),'\n<div class="keditor-toolbar keditor-toolbar-component">\n<a href="javascript:void(0);" class="keditor-ui btn-component-reposition">'.concat(e.btnMoveComponentText,"</a>\n").concat(o,'\n<a href="javascript:void(0);" class="keditor-ui btn-component-duplicate">').concat(e.btnDuplicateComponentText,'</a>\n<a href="javascript:void(0);" class="keditor-ui btn-component-delete">').concat(e.btnDeleteComponentText,"</a>\n</div>\n")}}.apply(this,[t,n])}},{key:"beautifyCategories",value:function(t){return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e]||"";""!==o&&-1===$.inArray(o,n)&&n.push(o)}return n.sort()}.apply(this,[t])}},{key:"setSettingContainer",value:function(t){this.settingContainer=t}},{key:"getSettingContainer",value:function(){return this.settingContainer}},{key:"setSettingComponent",value:function(t){this.settingComponent=t}},{key:"getSettingComponent",value:function(){return this.settingComponent}},{key:"getDataAttributes",value:function(t,n,e){return function(t,n,e){var o=e?[]:{};return n||(n=[]),$.each(t.get(0).attributes,function(t,a){0===a.name.indexOf("data-")&&-1===$.inArray(a.name,n)&&(e?o.push("".concat(a.name,'="').concat(a.value,'"')):o[a.name]=a.value)}),o}.apply(this,[t,n,e])}},{key:"getComponentType",value:function(t){return I.apply(this,[t])}},{key:"getClickedElement",value:function(t,n){return function(t,n){var e=$(t.target),o=e.closest(n);return e.is(n)?e:o.length>0?o:null}.apply(this,[t,n])}},{key:"initIframeCover",value:function(t,n){return function(t,n){n||(t.wrap('<div class="'.concat(i.IFRAME_COVER_WRAPPER_FAKE,'"></div>')),n=t.parent()),n.addClass("".concat(i.IFRAME_COVER_WRAPPER));var e=$('<div class="'.concat(i.IFRAME_COVER,'"></div>'));n.prepend(e),n.on("mouseleave",function(){n.removeClass("".concat(i.IFRAME_COVER_HIDDEN))}),e.on("dblclick",function(t){t.preventDefault(),n.addClass("".concat(i.IFRAME_COVER_HIDDEN))})}.apply(this,[t,n])}},{key:"initIframeActions",value:function(){return function(){var t=this,n=t.options,e=t.contentAreasWrapper;e.on("click",function(o){var a=t.getClickedElement(o,".".concat(i.SIDEBAR)),c=t.getClickedElement(o,".".concat(i.MODAL)),r=t.getClickedElement(o,".".concat(i.CONTAINER));if(r){if(!r.hasClass(i.STATE_TOOLBAR_SHOWED)){e.find(".".concat(i.STATE_TOOLBAR_SHOWED)).removeClass(i.STATE_TOOLBAR_SHOWED),r.addClass(i.STATE_TOOLBAR_SHOWED);var s=r.parent();"function"==typeof n.onContainerSelected&&n.onContainerSelected.call(t,o,r,s)}}else a||c||e.find(".".concat(i.STATE_TOOLBAR_SHOWED)).removeClass(i.STATE_TOOLBAR_SHOWED);var l=t.getClickedElement(o,".".concat(i.COMPONENT));if(l){if(!l.hasClass(i.STATE_TOOLBAR_SHOWED)){e.find(".".concat(i.COMPONENT,".").concat(i.STATE_TOOLBAR_SHOWED)).removeClass(i.STATE_TOOLBAR_SHOWED),l.addClass(i.STATE_TOOLBAR_SHOWED);var d=l.parent();"function"==typeof n.onComponentSelected&&n.onComponentSelected.call(t,o,l,d)}}else a||e.find(".".concat(i.COMPONENT,".").concat(i.STATE_TOOLBAR_SHOWED)).removeClass(i.STATE_TOOLBAR_SHOWED)}),e.on("click",".".concat(i.CONTAINER_SETTING),function(n){n.preventDefault();var o=$(this).closest(".".concat(i.CONTAINER));e.hasClass(i.STATE_SETTING_OPENED)&&e.hasClass(i.STATE_SIDEBAR_OPENED)&&o.is(t.settingContainer)?t.closeSidebar():t.openSidebar(o)}),e.on("click",".".concat(i.CONTAINER_DUPLICATE),function(e){e.preventDefault();var o=$(this),a=o.closest(".".concat(i.CONTAINER)),c=a.parent(),r=$(t.getContainerContent(a,o.parent().hasClass(i.SUB_CONTAINER_TOOLBAR)));a.after(r),t.convertToContainer(c,r),"function"==typeof n.onContainerDuplicated&&n.onContainerDuplicated.call(t,a,r,c),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,c)}),e.on("click",".".concat(i.CONTAINER_DELETE),function(e){e.preventDefault();var o=$(this);if(confirm(n.confirmDeleteContainerText)){var a=o.closest(".".concat(i.CONTAINER)),c=a.find(".".concat(i.COMPONENT)),r=a.parent();"function"==typeof n.onBeforeContainerDeleted&&n.onBeforeContainerDeleted.call(t,e,a,r);var s=t.settingComponent;s?s.closest(".".concat(i.CONTAINER)).is(a)&&t.closeSidebar():a.is(t.settingContainer)&&t.closeSidebar(),c.length>0&&c.each(function(){t.deleteComponent($(this))}),a.remove(),"function"==typeof n.onContainerDeleted&&n.onContainerDeleted.call(t,e,a,r),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,r)}}),e.on("click",".".concat(i.COMPONENT_SETTING),function(n){n.preventDefault();var o=$(this).closest(".".concat(i.COMPONENT));e.hasClass(i.STATE_SETTING_OPENED)&&e.hasClass(i.STATE_SIDEBAR_OPENED)&&o.is(t.settingComponent())?t.closeSidebar():t.openSidebar(o)}),e.on("click",".".concat(i.COMPONENT_DUPLICATE),function(e){e.preventDefault();var o=$(this).closest(".".concat(i.COMPONENT)),a=o.closest(".".concat(i.CONTAINER)),c=a.parent(),r=$(t.getComponentContent(o));o.after(r),t.convertToComponent(c,a,r),"function"==typeof n.onComponentDuplicated&&n.onComponentDuplicated.call(t,o,r,c),"function"==typeof n.onContainerChanged&&n.onContainerChanged.call(t,e,a,c),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,c)}),e.on("click",".".concat(i.COMPONENT_DELETE),function(e){e.preventDefault();var o=$(this);if(confirm(n.confirmDeleteComponentText)){var a=o.closest(".".concat(i.COMPONENT)),c=a.closest(".".concat(i.CONTAINER)),r=a.closest(".".concat(i.CONTENT_AREA));"function"==typeof n.onBeforeComponentDeleted&&n.onBeforeComponentDeleted.call(t,e,a,r),a.is(t.settingComponent)&&t.closeSidebar(),t.deleteComponent(a),"function"==typeof n.onComponentDeleted&&n.onComponentDeleted.call(t,e,a,r),"function"==typeof n.onContainerChanged&&n.onContainerChanged.call(t,e,c,r),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,r)}})}.apply(this)}},{key:"initTopbar",value:function(){return function(){var t=this.generateId(),n=this.options;this.topbar=$('\n<div class="'.concat(i.UI," ").concat(i.TOPBAR,'" id="').concat(t,'">\n<div class="').concat(i.UI," ").concat(i.TOPBAR_LEFT,'">\n<div class="').concat(i.UI," ").concat(i.TOPBAR_TITLE,'" title="').concat(n.title,'">').concat(n.title,'</div>\n</div>\n<div class="').concat(i.UI," ").concat(i.TOPBAR_CENTER,'">\n</div>\n<div class="').concat(i.UI," ").concat(i.TOPBAR_RIGHT,'">\n</div>\n</div>\n')),this.topbarLeft=this.topbar.find(".".concat(i.TOPBAR_LEFT)),this.topbarCenter=this.topbar.find(".".concat(i.TOPBAR_CENTER)),this.topbarRight=this.topbar.find(".".concat(i.TOPBAR_RIGHT)),this.topbar.appendTo(this.wrapper),this.initDeviceSwitcher(),this.initTopbarRightActions()}.apply(this)}},{key:"initDeviceSwitcher",value:function(){return function(){var t=this,n=t.topbarCenter,e=t.options,o=$('\n<a href="javascript:void(0);" title="View on mobile" class="'.concat(i.UI," ").concat(i.TOPBAR_BUTTON,'">\n<i class="fa fa-fw fa-mobile"></i>\n</a>\n'));o.on("click",function(a){a.preventDefault(),n.find(".".concat(i.STATE_ACTIVE)).removeClass(i.STATE_ACTIVE),t.iframeWrapper.css("width",e.widthMobile),o.addClass(i.STATE_ACTIVE)});var a=$('\n<a href="javascript:void(0);" title="View on tablet" class="'.concat(i.UI," ").concat(i.TOPBAR_BUTTON,'">\n<i class="fa fa-fw fa-tablet"></i>\n</a>\n'));a.on("click",function(o){o.preventDefault(),n.find(".".concat(i.STATE_ACTIVE)).removeClass(i.STATE_ACTIVE),t.iframeWrapper.css("width",e.widthTablet),a.addClass(i.STATE_ACTIVE)});var c=$('\n<a href="javascript:void(0);" title="View on desktop" class="'.concat(i.UI," ").concat(i.TOPBAR_BUTTON," ").concat(i.STATE_ACTIVE,'">\n<i class="fa fa-fw fa-desktop"></i>\n</a>\n'));c.on("click",function(e){e.preventDefault(),n.find(".".concat(i.STATE_ACTIVE)).removeClass(i.STATE_ACTIVE),t.iframeWrapper.css("width",""),c.addClass(i.STATE_ACTIVE)}),n.append(o),n.append(a),n.append(c)}.apply(this)}},{key:"initTopbarRightActions",value:function(){return function(){var t=this,n=t.options,e=t.topbarRight,o=$('<a href="javascript:void(0);" title="Preview OFF" class="'.concat(i.UI," ").concat(i.TOPBAR_BUTTON,'"></a>')),a=$('<i class="fa fa-fw fa-eye-slash"></i>'),c=$('<i class="fa fa-fw fa-eye" style="display: none;"></i>');o.append(a),o.append(c),t.previewArea=$('<div class="'.concat(i.PREVIEW_AREA,'" style="display: none;"></div>')),t.contentAreasWrapper.after(t.previewArea),o.on("click",function(n){n.preventDefault();var e=o.hasClass(i.STATE_ACTIVE);if(o[e?"removeClass":"addClass"](i.STATE_ACTIVE),o.attr("title",e?"Preview OFF":"Preview ON"),a.css("display",e?"":"none"),c.css("display",e?"none":""),t.contentAreasWrapper.css("display",e?"":"none"),t.previewArea.css("display",e?"none":""),!e){var r=t.getContent();t.previewArea.html(r).find("[data-dynamic-href]").each(function(){var n=$(this);n.html("Loading..."),t.initDynamicContent(n)})}});var r=$('<a href="javascript:void(0);" title="Save" class="'.concat(i.UI," ").concat(i.TOPBAR_BUTTON,'"><i class="fa fa-fw fa-save"></i></a>'));r.on("click",function(e){e.preventDefault();var o=t.getContent();"function"==typeof n.onSave&&n.onSave.call(t,o)}),e.append(r),e.append(o)}.apply(this)}},{key:"initSidebar",value:function(){return function(){var t=this,n=t.options,e=t.generateId(),o=t.sidebar=$('\n<div class="'.concat(i.UI," ").concat(i.SIDEBAR,'" id="').concat(e,'">\n<div class="').concat(i.UI," ").concat(i.SIDEBAR_HEADER,'">\n<span class="').concat(i.UI," ").concat(i.SIDEBAR_TITLE,'"></span>\n<a href="javascript:void(0);" class="').concat(i.UI," ").concat(i.SIDEBAR_CLOSER,'">&times;</a>\n</div>\n<div class="').concat(i.UI," ").concat(i.SIDEBAR_BODY,'"></div>\n</div>\n'));o.find(".".concat(i.SIDEBAR_CLOSER)).on("click",function(n){n.preventDefault(),t.closeSidebar()});var a=o.find(".".concat(i.SIDEBAR_BODY));if(a.on("submit","form",function(t){return t.preventDefault(),!1}),!0===n.containerSettingEnabled)if("function"==typeof n.containerSettingInitFunction){var c=$('<div class="'.concat(i.UI," ").concat(i.SETTING_FORM," ").concat(i.SETTING_CONTAINER,'"></div>'));a.append(c),n.containerSettingInitFunction.call(t,c,t)}else t.error('"containerSettingInitFunction" is not function!');o.appendTo(t.wrapper)}.apply(this)}},{key:"openSidebar",value:function(t){return f.apply(this,[t])}},{key:"closeSidebar",value:function(){return E.apply(this)}},{key:"initExtraSettings",value:function(){return function(){var t=this,n=this,e=n.options,o=n.sidebar.find(".".concat(i.SIDEBAR_BODY));if($.isPlainObject(e.extraSettings)){var a=function(a){var c=e.extraSettings[a],r=$('<div data-extra-setting="'.concat(a,'" class="').concat(i.UI," ").concat(i.SETTING_FORM," ").concat(i.SETTING_EXTRA,'"></div>'));r.html(c.content),o.append(r);var s="function"==typeof c.trigger?c.trigger.call(t,c):c.trigger;s.on("click",function(t){t.preventDefault(),n.openSidebar(s)})};for(var c in e.extraSettings)a(c)}}.apply(this)}},{key:"showSettingPanel",value:function(t){this.openSidebar(t)}},{key:"hideSettingPanel",value:function(){this.closeSidebar()}},{key:"initSnippetsModal",value:function(){return function(){var t=this,n=t.options,e=t.generateId(),o=t.modal=$('\n<div class="'.concat(i.UI," ").concat(i.MODAL,'" id="').concat(e,'">\n<div class="').concat(i.MODAL_HEADER,'">\n<button type="button" class="').concat(i.MODAL_CLOSE,'">&times;</button>\n</div>\n<div class="').concat(i.MODAL_BODY,'">\n<div class="').concat(i.SNIPPETS_WRAPPER,'">\n<div class="').concat(i.SNIPPETS,'"></div>\n</div>\n</div>\n<div class="').concat(i.MODAL_FOOTER,'">\n<button type="button" class="').concat(i.UI," ").concat(i.BTN," ").concat(i.BTN_DEFAULT," ").concat(i.MODAL_CLOSE,'">Close</button>\n<button type="button" class="').concat(i.UI," ").concat(i.BTN," ").concat(i.BTN_PRIMARY," ").concat(i.MODAL_ADD,'">Add</button>\n</div>\n</div>\n'));"string"==typeof n.snippetsUrl&&n.snippetsUrl.length>0?($.ajax({type:"get",dataType:"html",url:n.snippetsUrl,success:function(e){"function"==typeof n.onSnippetsLoaded&&(e=n.onSnippetsLoaded.call(t,e)||e),t.renderSnippets(e),t.initSnippetsFilter()},error:function(e){"function"==typeof n.onSnippetsError&&n.onSnippetsError.call(t,e)}}),o.find(".".concat(i.MODAL_CLOSE)).on("click",function(n){n.preventDefault(),t.closeModal()}),o.find(".".concat(i.MODAL_ADD)).on("click",function(e){e.preventDefault();var a=o.find(".".concat(i.SNIPPETS_WRAPPER," .").concat(i.STATE_SELECTED));if(0!==a.length){var c,r,s=t.modalTarget.closest(".".concat(i.CONTENT_AREA)),l=a.attr("data-type"),d=o.find(a.attr("data-snippet")),p=d.html(),T=o.hasClass(i.MODAL_COMPONENT),f=o.hasClass(i.MODAL_CONTAINER),E=!1,u=!1,C=!1;if(n.explicitSnippetEnabled?(u=T,E=f):"container"===l?E=!0:(T&&!f&&(u=!0),T&&f&&(t.modalTarget.is(".".concat(i.CONTAINER_CONTENT_INNER))?u=!0:C=!0)),E&&(t.contentAreasWrapper.find(".".concat(i.CONTAINER,".").concat(i.STATE_TOOLBAR_SHOWED)).removeClass(i.STATE_TOOLBAR_SHOWED),c=$('\n<section class="'.concat(i.UI," ").concat(i.CONTAINER," ").concat(i.STATE_TOOLBAR_SHOWED,'">\n<section class="').concat(i.UI," ").concat(i.CONTAINER_INNER,'">').concat(p,"</section>\n</section>\n")),t.modalTarget.append(c),"function"==typeof n.onContainerSnippetAdded&&n.onContainerSnippetAdded.call(t,e,c,a,s),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,s),t.initContainer(s,c)),u){var A=t.getDataAttributes(d,null,!0);r=$('\n<section class="'.concat(i.UI," ").concat(i.COMPONENT,'" data-type="').concat(l,'" ').concat(A.join(" "),'>\n<section class="').concat(i.UI," ").concat(i.COMPONENT_CONTENT,'">').concat(p,"</section>\n</section>\n")),t.modalTarget.append(r);var N=t.modalTarget.closest(".".concat(i.CONTAINER));"function"==typeof n.onComponentSnippetAdded&&n.onComponentSnippetAdded.call(t,e,r,a,s),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,s),t.initComponent(s,N,r)}if(C){t.contentAreasWrapper.find(".".concat(i.CONTAINER,".").concat(i.STATE_TOOLBAR_SHOWED)).removeClass(i.STATE_TOOLBAR_SHOWED);var h=t.getDataAttributes(d,null,!0);c=$('\n<section class="'.concat(i.UI," ").concat(i.CONTAINER," ").concat(i.STATE_TOOLBAR_SHOWED,'">\n<section class="').concat(i.UI," ").concat(i.CONTAINER_INNER,'">').concat(n.containerForQuickAddComponent,"</section>\n</section>\n")),r=$('\n<section class="'.concat(i.UI," ").concat(i.COMPONENT,'" data-type="').concat(l,'" ').concat(h.join(" "),'>\n<section class="').concat(i.UI," ").concat(i.COMPONENT_CONTENT,'">').concat(p,"</section>\n</section>\n")),c.find('[data-type="container-content"]').eq(0).html(r),t.modalTarget.append(c),"function"==typeof n.onComponentSnippetAdded&&n.onComponentSnippetAdded.call(t,e,r,a,s),"function"==typeof n.onContentChanged&&n.onContentChanged.call(t,e,s),t.initContainer(s,c)}t.closeModal()}}),o.on("click",".".concat(i.SNIPPET),function(t){t.preventDefault();var n=$(this);n.hasClass(i.STATE_SELECTED)||(n.parent().find(".".concat(i.STATE_SELECTED)).removeClass(i.STATE_SELECTED),n.addClass(i.STATE_SELECTED))}),o.on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){o.hasClass(i.STATE_SHOWED)||(o.css("display","none"),$(document.body).removeClass(i.STATE_MODAL_OPENED))}),o.appendTo(document.body)):t.error('"snippetsUrl" must be not null!')}.apply(this)}},{key:"renderSnippets",value:function(t){return function(t){var n=this,e="",o="";n.snippetsContainerCategories=[],n.snippetsComponentCategories=[],$(t).filter("div").each(function(){var t=$(this),a=t.html().trim(),i=t.attr("data-preview"),c=t.attr("data-type"),r=t.attr("data-keditor-title"),s=t.attr("data-keditor-categories")||"",l=n.getDataAttributes(t,["data-preview","data-type","data-keditor-title","data-keditor-categories"],!0),d=C(u.call(n,c,r,i,s,a,l),2),p=d[0],T=d[1];o+=p,e+=T}),n.snippetsContainerCategories=n.beautifyCategories(n.snippetsContainerCategories),n.snippetsComponentCategories=n.beautifyCategories(n.snippetsComponentCategories),n.modal.find(".".concat(i.SNIPPETS)).html(o),n.modal.find(".".concat(i.MODAL_BODY)).append(e)}.apply(this,[t])}},{key:"initSnippetsFilter",value:function(){return function(){var t=this,n=t.options,e=N(A.call(this),2),o=e[0],a=e[1];a.prepend('\n<div class="'.concat(i.UI," ").concat(i.SNIPPETS_FILTER_WRAPPER,'">\n<label class="').concat(i.UI," ").concat(i.SNIPPETS_FILTER_LABEL,'">Category:</label>\n<select class="').concat(i.UI," ").concat(i.SNIPPETS_FILTER,'">\n').concat(o,'\n</select>\n<input type="text" class="').concat(i.UI," ").concat(i.SNIPPETS_SEARCH,'" value="" placeholder="Type to search..." />\n</div>\n'));var c,r=a.find(".".concat(i.SNIPPETS_SEARCH)),s=a.find(".".concat(i.SNIPPETS_FILTER)),l=function(){var e=(s.val()||"").toLowerCase(),o=(r.val()||"").toLowerCase(),a=t.modal.find(".".concat(i.SNIPPET));a.filter(".".concat(i.STATE_SELECTED)).removeClass(i.STATE_SELECTED),e||o?a.each(function(){var t=$(this),a=t.attr("data-keditor-categories").toLowerCase(),c=a.split(n.snippetsCategoriesSeparator),r=0;e&&-1===$.inArray(e,c)&&r++,o&&-1===t.attr("data-keditor-title").toLowerCase().indexOf(o)&&-1===a.indexOf(o)&&r++,t[0===r?"removeClass":"addClass"](i.STATE_NOT_MATCHED)}):a.removeClass(i.STATE_NOT_MATCHED)};s.on("change",function(){l()}),r.on("keydown",function(){clearTimeout(c),c=setTimeout(l,200)})}.apply(this)}},{key:"openModal",value:function(t,n,e){return function(t,n,e){var o=this.modal;console.log(n,e),this.modalTarget=t,n&&o.addClass(i.MODAL_COMPONENT),e&&o.addClass(i.MODAL_CONTAINER),o.css("display","block"),$(document.body).addClass(i.STATE_MODAL_OPENED),setTimeout(function(){o.addClass(i.STATE_SHOWED)},0)}.apply(this,[t,n,e])}},{key:"closeModal",value:function(){return function(){var t=this.modal;this.modalTarget=null,t.find(".".concat(i.STATE_SELECTED)).removeClass(i.STATE_SELECTED),t.find(".".concat(i.STATE_NOT_MATCHED)).removeClass(i.STATE_NOT_MATCHED),t.find(".".concat(i.SNIPPETS_FILTER)).val(""),t.removeClass(i.STATE_SHOWED),t.removeClass(i.MODAL_COMPONENT),t.removeClass(i.MODAL_CONTAINER)}.apply(this)}},{key:"initContentAreaWrapper",value:function(){return function(){var t=this.element,n=this.options,e=this.wrapper=$('<div class="'.concat(i.UI," ").concat(i.WRAPPER,'"></div>')),o=this.iframeWrapper=$('<div class="'.concat(i.UI," ").concat(i.IFRAME_WRAPPER,'"></div>')),a=this.iframe=$('<iframe class="'.concat(i.UI," ").concat(i.IFRAME,'"></iframe>'));t.after(e),t.addClass(i.UI_HIDDEN),o.html(a),e.attr("id",this.generateId()).append(o),this.iframeDoc=a.contents(),this.iframeDoc.get(0).open(),this.iframeDoc.get(0).close(),this.iframeWindow=a[0].contentWindow?a[0].contentWindow:a[0].contentDocument.defaultView,this.iframeHead=this.iframeDoc.find("head"),this.iframeBody=this.iframeDoc.find("body");var c="";$('[data-type="keditor-style"]').each(function(){var t=$(this),n=t.attr("id")||"",e=t.attr("href")||t.attr("data-href")||"";c+=e?'<link rel="stylesheet" type="text/css" href="'.concat(e,'" ').concat(n," />\n"):'<style type="text/css" '.concat(n,">").concat(t.html(),"</style>\n")}),$.isArray(n.contentStyles)&&$.each(n.contentStyles,function(t,n){var e=n.id||"";n.href?c+='<link rel="stylesheet" type="text/css" href="'.concat(n.href,'" ').concat(e," />\n"):c+='<style type="text/css" '.concat(e,">").concat(n.content,"</style>\n")}),this.iframeHead.append(c),this.contentAreasWrapper=$(n.contentAreasWrapper||"<div />"),this.contentAreasWrapper.attr("class","".concat(i.UI," ").concat(i.CONTENT_AREAS_WRAPPER)),this.contentAreasWrapper.html(t.val()||t.html()||""),this.contentAreasWrapper.attr("id")||this.contentAreasWrapper.attr("id",this.generateId()),this.iframeBody.append(this.contentAreasWrapper),"function"==typeof n.onInitIframe&&n.onInitIframe.call(this,this.iframe,this.iframeHead,this.iframeBody),this.initContentAreas(),this.initIframeActions()}.apply(this)}},{key:"initContentAreas",value:function(){return function(){var t,n=this,e=n.options,o=n.contentAreasWrapper;if(e.contentAreasSelector&&(t=o.find(e.contentAreasSelector)),!t||0===t.length){var a=o.html();t=$("<div />").html(a),o.empty().append(t)}t.each(function(){var t=$(this);t.attr("id")||t.attr("id",n.generateId()),n.initContentArea(t)})}.apply(this)}},{key:"initContentArea",value:function(t,n){return function(t,n){var e=this,o=e.options;t.addClass(i.CONTENT_AREA);var a=t.html(),c=$('<div class="'.concat(i.CONTENT_AREA_INNER,'"></div>')).html(a);if(t.html(c),"function"==typeof o.onBeforeInitContentArea&&o.onBeforeInitContentArea.call(e,t),!n){var s=$(e.generateToolbar(r));t.append(s),s.children(o.explicitSnippetEnabled?".".concat(i.ADD_CONTAINER):".".concat(i.ADD_CONTENT)).on("click",function(t){t.preventDefault(),e.openModal(c,!o.explicitSnippetEnabled,!0)})}if(c.sortable({handle:".".concat(i.CONTAINER_TOOLBAR,":not(.").concat(i.SUB_CONTAINER_TOOLBAR,") .").concat(i.CONTAINER_REPOSITION),items:"> section",helper:"clone",connectWith:".".concat(i.CONTENT_AREA),axis:"y",tolerance:"pointer",receive:function(n,a){var c=a.helper,r=a.item;c&&c.remove(),e.closeSidebar(),"function"==typeof o.onContentChanged&&o.onContentChanged.call(e,n,t),r.addClass(i.UI_DRAGGING)},start:function(t,n){n.item.addClass(i.UI_DRAGGING)},stop:function(t,n){n.helper&&n.helper.remove(),n.item.removeClass(i.UI_DRAGGING)}}),c.children("section").each(function(){e.convertToContainer(t,$(this))}),"function"==typeof o.onInitContentArea){var l=o.onInitContentArea.call(e,t);l&&l.length>0&&$.each(l,function(){e.convertToContainer(t,$(this))})}}.apply(this,[t,n])}},{key:"convertToContainer",value:function(t,n){return function(t,n){var e;n.is("section")?(n.addClass("".concat(i.UI," ").concat(i.CONTAINER)),n.wrapInner('<section class="'.concat(i.UI," ").concat(i.CONTAINER_INNER,'"></section>')),e=n):(n.wrap('\n<section class="'.concat(i.UI," ").concat(i.CONTAINER,'">\n<section class="').concat(i.UI," ").concat(i.CONTAINER_INNER,'"></section>\n</section>\n')),e=n.parent().parent()),this.initContainer(t,e)}.apply(this,[t,n])}},{key:"initContainer",value:function(t,n){return function(t,n){var e=this,o=e.options,a=o.nestedContainerEnabled&&n.closest('[data-type="container-content"]').length>0;n.hasClass(i.STATE_INITIALIZED)&&n.hasClass(i.STATE_INITIALIZING)||(n.addClass(i.STATE_INITIALIZING),"function"==typeof o.onBeforeInitContainer&&o.onBeforeInitContainer.call(e,n,t),a&&n.addClass(i.SUB_CONTAINER),n.append(e.generateToolbar(a?l:s)),n.attr("id",e.generateId()),n.find('[data-type="container-content"]').each(function(){var i=$(this);o.nestedContainerEnabled&&!a&&i.parents('[data-type="container-content"]').length>0||e.initContainerContent(t,n,i,a)}),"function"==typeof o.onInitContainer&&o.onInitContainer.call(e,n,t),n.addClass(i.STATE_INITIALIZED),n.removeClass(i.STATE_INITIALIZING))}.apply(this,[t,n])}},{key:"initContainerContent",value:function(t,n,e,o){return function(t,n,e,o){var a=this,c=a.options,r=a.contentAreasWrapper;e.addClass(i.CONTAINER_CONTENT),o&&e.addClass(i.SUB_CONTAINER_CONTENT),e.attr("id",a.generateId());var s=$('<div class="'.concat(i.CONTAINER_CONTENT_INNER,'"></div>'));s.html(e.html()),e.html(s);var l=$(a.generateToolbar(o?p:d));l.appendTo(e),c.explicitSnippetEnabled?(o||c.explicitSnippetEnabled&&l.children(".".concat(i.ADD_CONTAINER)).on("click",function(t){t.preventDefault(),a.openModal(s,!1,!0)}),l.children(".".concat(i.ADD_COMPONENT)).on("click",function(t){t.preventDefault(),a.openModal(s,!0,!1)})):l.children(".".concat(i.ADD_CONTENT)).on("click",function(t){t.preventDefault(),a.openModal(s,!0,!o&&c.nestedContainerEnabled)}),s.sortable({handle:".".concat(i.COMPONENT_REPOSITION," .").concat(i.CONTAINER_REPOSITION),helper:"clone",items:"> section",connectWith:".".concat(i.CONTAINER_CONTENT_INNER),tolerance:"pointer",receive:function(n,e){var o,s=e.helper,l=e.item;s&&s.remove(),(o=l.closest(".".concat(i.CONTAINER))).hasClass(i.STATE_TOOLBAR_SHOWED)||(r.find(".".concat(i.CONTAINER,".").concat(i.STATE_TOOLBAR_SHOWED)).removeClass(i.STATE_TOOLBAR_SHOWED),o.addClass(i.STATE_TOOLBAR_SHOWED)),"function"==typeof c.onContainerChanged&&c.onContainerChanged.call(a,n,o,t),"function"==typeof c.onContentChanged&&c.onContentChanged.call(a,n,t),l.removeClass(i.UI_DRAGGING)},start:function(t,n){n.item.addClass(i.UI_DRAGGING)},stop:function(t,n){n.helper&&n.helper.remove(),n.item.removeClass(i.UI_DRAGGING)}}),s.children().each(function(){var e=$(this);e.find('[data-type="container-content"]').length>0?a.convertToContainer(t,e):a.convertToComponent(t,n,e,!0)})}.apply(this,[t,n,e,o])}},{key:"convertToComponent",value:function(t,n,e,o){return function(t,n,e,o){if(!e.is(".".concat(i.CONTAINER_CONTENT_TOOLBAR))){var a;e.is("section")?(e.addClass("".concat(i.UI," ").concat(i.COMPONENT)),e.wrapInner('<section class="'.concat(i.UI," ").concat(i.COMPONENT_CONTENT,'"></section>')),a=e):(e.wrap('\n<section class="'.concat(i.UI," ").concat(i.COMPONENT,'">\n<section class="').concat(i.UI," ").concat(i.COMPONENT_CONTENT,'"></section>\n</section>\n')),a=e.parent().parent()),o&&a.addClass("".concat(i.COMPONENT_EXISTING)),this.initComponent(t,n,a)}}.apply(this,[t,n,e,o])}},{key:"initComponent",value:function(t,n,e){return v.apply(this,[t,n,e])}},{key:"initDynamicContent",value:function(t){return function(t){var n=this,e=n.options,o=t.closest("[data-type^=component]"),a=t.closest(".".concat(i.CONTENT_AREA));t.attr("id",n.generateId()),"function"==typeof e.onBeforeDynamicContentLoad&&e.onBeforeDynamicContentLoad.call(n,t,o,a);var c=t.attr("data-dynamic-href"),r=n.getDataAttributes(o,["data-type","data-dynamic-href"],!1);return r=$.param(r),$.ajax({url:c,data:r,type:"GET",dataType:"HTML",success:function(o,i,c){t.html(o),"function"==typeof e.onDynamicContentLoaded&&e.onDynamicContentLoaded.call(n,t,c,a)},error:function(o,i,c){"function"==typeof e.onDynamicContentError&&e.onDynamicContentError.call(n,t,o,a)}})}.apply(this,[t])}},{key:"deleteComponent",value:function(t){return O.apply(this,[t])}},{key:"getComponentContent",value:function(t){return S.apply(this,[t])}},{key:"getContainerContent",value:function(t,n){return function(t,n){var e=this,o=t.children(".".concat(i.CONTAINER_INNER)).clone();return o.find("[data-type=container-content]").not(n?"":".".concat(i.SUB_CONTAINER_CONTENT)).each(function(){var t=$(this);t.removeClass("".concat(i.CONTAINER_CONTENT," ").concat(i.SUB_CONTAINER_CONTENT," ").concat(i.SORTABLE)).removeAttr("id");var n=t.children(),o="";n.children().each(function(){var t=$(this);t.is(".".concat(i.COMPONENT))?o+=e.getComponentContent(t):t.is(".".concat(i.SUB_CONTAINER))&&(o+=e.getContainerContent(t,!0))}),t.html(o)}),"<section>".concat(o.html(),"</section>")}.apply(this,[t,n])}},{key:"getContent",value:function(t){return function(t){var n=this,e=[];return n.contentAreasWrapper.find(".".concat(i.CONTENT_AREA_INNER)).each(function(){var t="";$(this).children(".".concat(i.CONTAINER)).each(function(){var e=$(this);t+=n.getContainerContent(e)}),e.push(t)}),t?e:e.join("\n")}.apply(this,[t])}},{key:"setContent",value:function(t,n){return function(t,n){var e=this.wrapper;n?n.jquery||(n=e.find(n)):n=e.children(".".concat(i.CONTENT_AREA)),0===n.length&&this.error("Content area does not exist!"),n.html(t),this.initContentArea(n,!0)}.apply(this,[t,n])}},{key:"destroy",value:function(){return m.apply(this)}},{key:"addSnippet",value:function(t,n,e,o,a,c){return function(t,n,e,o,a,c){var r=h(u.call(this,t,n,e,o,a,c),2),s=r[0],l=r[1];this.snippetsContainerCategories=this.beautifyCategories(this.snippetsContainerCategories),this.snippetsComponentCategories=this.beautifyCategories(this.snippetsComponentCategories),this.modal.find(".".concat(i.SNIPPETS)).append(s),this.modal.find(".".concat(i.MODAL_BODY)).append(l);var d=h(A.call(this),2),p=d[0];d[1].find(".".concat(i.SNIPPETS_FILTER)).html(p).trigger("change")}.apply(this,[t,n,e,o,a,c])}}]),t}();D(g,"DEFAULTS",c),D(g,"debug",!1),D(g,"version","2.0.0"),D(g,"instances",{}),D(g,"components",{blank:{settingEnabled:!1}}),a.a.fn.keditor=function(t){var n=a()(this),e=n.data("keditor");return"string"!=typeof t?(e||(e=g.init(n,t),n.data("keditor",e)),e):e&&e[t]&&"function"==typeof e[t]?e[t].apply(e,Array.prototype.slice.call(arguments,1)):void 0},window.KEditor=a.a.keditor=a.a.fn.keditor.constructor=g}])});
//# sourceMappingURL=keditor.js.map