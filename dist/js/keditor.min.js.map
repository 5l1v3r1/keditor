{"version":3,"sources":["keditor.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","window","$","flog","_len","arguments","args","Array","_key","console","log","KEditor","debug","apply","concat","error","message","Error","fn","sortable","DEFAULTS","nestedContainerEnabled","btnAddContainerText","btnAddSubContainerText","btnAddComponentText","btnMoveContainerText","btnMoveComponentText","btnSettingContainerText","btnSettingComponentText","btnDuplicateContainerText","btnDuplicateComponentText","btnDeleteContainerText","btnDeleteComponentText","defaultComponentType","snippetsUrl","snippetsFilterEnabled","snippetsCategoriesSeparator","iframeMode","contentStyles","contentAreasSelector","contentAreasWrapper","containerSettingEnabled","containerSettingInitFunction","containerSettingShowFunction","containerSettingHideFunction","onReady","onSnippetsLoaded","modal","onSnippetsError","onInitIframe","iframe","iframeHead","iframeBody","onContentChanged","event","contentArea","onBeforeInitContentArea","onInitContentArea","onBeforeInitContainer","container","onInitContainer","onBeforeContainerDeleted","selectedContainer","onContainerDeleted","onContainerChanged","changedContainer","onContainerDuplicated","originalContainer","newContainer","onContainerSelected","onContainerSnippetAdded","selectedSnippet","onComponentReady","component","onBeforeInitComponent","onInitComponent","onBeforeComponentDeleted","selectedComponent","onComponentDeleted","onComponentChanged","changedComponent","onComponentDuplicated","originalComponent","newComponent","onComponentSelected","onComponentSnippetAdded","onBeforeDynamicContentLoad","dynamicElement","onDynamicContentLoaded","response","status","xhr","onDynamicContentError","MODAL_ACTION","ADD_CONTAINER","ADD_SUB_CONTAINER","ADD_COMPONENT","TOOLBAR_TYPE","CONTENT_AREA","CONTAINER","SUB_CONTAINER","CONTAINER_CONTENT","SUB_CONTAINER_CONTENT","COMPONENT","config","this","self","element","options","extend","initIframe","body","document","originalContent","val","html","generateContentAreasWrapper","is","after","addClass","empty","append","initSidebar","initSnippetsModal","initContentAreas","hasClass","initKEditorClicks","id","generateId","instances","call","value","type","undefined","timestamp","Date","getTime","random","Math","round","content","attr","isComponentConfigurable","settingBtn","categories","newArray","category","inArray","push","sort","settingContainer","settingComponent","ignoreAttributes","isArray","dataAttributes","each","get","attributes","name","indexOf","componentType","replace","components","selector","closest","wrapper","iframeWrapper","iframeDoc","contents","open","close","contentWindow","contentDocument","defaultView","find","styles","style","href","idStr","on","e","sidebar","getClickedElement","removeClass","parent","_contentArea","preventDefault","btn","closeSidebar","openSidebar","getContainerContent","convertToContainer","confirm","settingComponentParent","deleteComponent","remove","getComponentContent","convertToComponent","sidebarId","sidebarBody","form","appendTo","sidebarTitle","activeForm","children","setSettingComponent","setSettingContainer","getComponentType","componentData","settingTitle","settingForm","_componentData","initSettingForm","loadingText","initFunction","when","done","setTimeout","showSettingForm","_settingForm","activeType","hideSettingForm","modalId","ajax","dataType","url","success","resp","renderSnippets","initSnippetsFilter","jqXHR","closeModal","modalTarget","snippetType","snippetContentElement","snippetContent","modalAction","getDataAttributes","join","initComponent","initContainer","snippet","cssTransitionEnd","css","snippetsContainerHtml","snippetsComponentHtml","snippetsContentHtml","snippetsContainerCategories","snippetsComponentCategories","filter","snippetId","trim","previewUrl","title","snippetHtml","split","beautifyCategories","isContainer","categoriesOptions","snippetsWrapper","snippets","prepend","filterCategories","toLowerCase","data","txtSearch","cbbFilter","doFilter","selectedCategory","searchText","dataCategories","dataCategoriesString","timer","clearTimeout","action","modalTitle","contentAreas","initContentArea","dontInitToolbar","contentAreaToolbar","generateToolbar","openModal","handle","items","helper","connectWith","axis","tolerance","receive","ui","item","start","stop","over","out","contentData","wrapInner","wrap","isNested","containerContents","containerContent","parents","initContainerContent","containerContentInner","containerContentToolbar","child","isExisting","isSection","componentContent","settingEnabled","initDynamicContent","init","dynamicHref","param","destroy","clonedComponent","clone","getContent","containerInner","not","removeAttr","result","jquery","keditor","slice","constructor","version","blank","jQuery"],"mappings":"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","file":"keditor.min.js","sourcesContent":["'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (window, $) {\n    // Log function will print log message\n    var flog = function flog() {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        if (console && typeof console.log === 'function' && KEditor.debug === true) {\n            console.log.apply(console, ['[ KEditor ] '].concat(args));\n        }\n    };\n\n    // Throw error message\n    var error = function error(message) {\n        throw new Error('[ KEditor ] ' + message);\n    };\n\n    // Check dependencies\n    if (!$.fn.sortable) {\n        error('$.fn.sortable does not exist. Please import $.fn.sortable into your document for continue using KEditor.');\n    }\n\n    var DEFAULTS = {\n        nestedContainerEnabled: true,\n        btnAddContainerText: '<i class=\"fa fa-plus\"></i> <i class=\"fa fa-fw fa-columns\"></i>',\n        btnAddSubContainerText: '<i class=\"fa fa-plus\"></i> <i class=\"fa fa-fw fa-columns\"></i>',\n        btnAddComponentText: '<i class=\"fa fa-plus\"></i> <i class=\"fa fa-fw fa-list-ul\"></i>',\n        btnMoveContainerText: '<i class=\"fa fa-sort\"></i>',\n        btnMoveComponentText: '<i class=\"fa fa-arrows\"></i>',\n        btnSettingContainerText: '<i class=\"fa fa-cog\"></i>',\n        btnSettingComponentText: '<i class=\"fa fa-cog\"></i>',\n        btnDuplicateContainerText: '<i class=\"fa fa-files-o\"></i>',\n        btnDuplicateComponentText: '<i class=\"fa fa-files-o\"></i>',\n        btnDeleteContainerText: '<i class=\"fa fa-times\"></i>',\n        btnDeleteComponentText: '<i class=\"fa fa-times\"></i>',\n        defaultComponentType: 'blank',\n        snippetsUrl: 'snippets/snippets.html',\n        snippetsFilterEnabled: true,\n        snippetsCategoriesSeparator: ';',\n        iframeMode: false,\n        contentStyles: [],\n        contentAreasSelector: null,\n        contentAreasWrapper: '<div class=\"keditor-ui keditor-content-areas-wrapper\"></div>',\n        containerSettingEnabled: false,\n        containerSettingInitFunction: null,\n        containerSettingShowFunction: null,\n        containerSettingHideFunction: null,\n        onReady: function onReady() {},\n\n        onSnippetsLoaded: function onSnippetsLoaded(modal) {},\n        onSnippetsError: function onSnippetsError(modal, error) {},\n\n        onInitIframe: function onInitIframe(iframe, iframeHead, iframeBody) {},\n        onContentChanged: function onContentChanged(event, contentArea) {},\n\n        onBeforeInitContentArea: function onBeforeInitContentArea(contentArea) {},\n        onInitContentArea: function onInitContentArea(contentArea) {},\n\n        onBeforeInitContainer: function onBeforeInitContainer(container, contentArea) {},\n        onInitContainer: function onInitContainer(container, contentArea) {},\n        onBeforeContainerDeleted: function onBeforeContainerDeleted(event, selectedContainer, contentArea) {},\n        onContainerDeleted: function onContainerDeleted(event, selectedContainer, contentArea) {},\n        onContainerChanged: function onContainerChanged(event, changedContainer, contentArea) {},\n        onContainerDuplicated: function onContainerDuplicated(event, originalContainer, newContainer, contentArea) {},\n        onContainerSelected: function onContainerSelected(event, selectedContainer, contentArea) {},\n        onContainerSnippetAdded: function onContainerSnippetAdded(event, newContainer, selectedSnippet, contentArea) {},\n\n        onComponentReady: function onComponentReady(component) {},\n        onBeforeInitComponent: function onBeforeInitComponent(component, contentArea) {},\n        onInitComponent: function onInitComponent(component, contentArea) {},\n        onBeforeComponentDeleted: function onBeforeComponentDeleted(event, selectedComponent, contentArea) {},\n        onComponentDeleted: function onComponentDeleted(event, selectedComponent, contentArea) {},\n        onComponentChanged: function onComponentChanged(event, changedComponent, contentArea) {},\n        onComponentDuplicated: function onComponentDuplicated(event, originalComponent, newComponent, contentArea) {},\n        onComponentSelected: function onComponentSelected(event, selectedComponent, contentArea) {},\n        onComponentSnippetAdded: function onComponentSnippetAdded(event, newComponent, selectedSnippet, contentArea) {},\n\n        onBeforeDynamicContentLoad: function onBeforeDynamicContentLoad(dynamicElement, component, contentArea) {},\n        onDynamicContentLoaded: function onDynamicContentLoaded(dynamicElement, response, status, xhr, contentArea) {},\n        onDynamicContentError: function onDynamicContentError(dynamicElement, response, status, xhr, contentArea) {}\n    };\n\n    var MODAL_ACTION = {\n        ADD_CONTAINER: 0,\n        ADD_SUB_CONTAINER: 1,\n        ADD_COMPONENT: 2\n    };\n\n    var TOOLBAR_TYPE = {\n        CONTENT_AREA: 0,\n        CONTAINER: 1,\n        SUB_CONTAINER: 2,\n        CONTAINER_CONTENT: 3,\n        SUB_CONTAINER_CONTENT: 4,\n        COMPONENT: 5\n    };\n\n    // KEditor class\n\n    var KEditor = function () {\n        function KEditor(target, config) {\n            _classCallCheck(this, KEditor);\n\n            var self = this;\n            var element = self.element = target;\n            var options = self.options = $.extend({}, DEFAULTS, config);\n\n            if (options.iframeMode) {\n                self.initIframe();\n            } else {\n                self.window = window;\n                self.body = $(document.body);\n\n                var originalContent = element.val() || element.html() || '';\n                var contentAreasWrapper = self.generateContentAreasWrapper(originalContent);\n\n                if (element.is('textarea')) {\n                    element.after(contentAreasWrapper);\n                    element.addClass('keditor-hidden-element');\n                } else {\n                    element.empty().append(contentAreasWrapper);\n                }\n\n                self.contentAreasWrapper = contentAreasWrapper;\n            }\n\n            self.initSidebar();\n            self.initSnippetsModal();\n            self.initContentAreas();\n\n            if (!self.body.hasClass('keditor-clicks-initialized')) {\n                self.initKEditorClicks();\n            }\n\n            self.id = self.generateId();\n            KEditor.instances[self.id] = self;\n\n            if (typeof options.onReady === 'function') {\n                options.onReady.call(self);\n            }\n        }\n\n        // Utils\n        //---------------------------------\n\n\n        _createClass(KEditor, [{\n            key: 'generateId',\n            value: function generateId() {\n                var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n                var timestamp = new Date().getTime();\n                var random = Math.round(Math.random() * 9876543210);\n                return 'keditor-' + type + '-' + timestamp + random;\n            }\n        }, {\n            key: 'generateContentAreasWrapper',\n            value: function generateContentAreasWrapper(content) {\n                var self = this;\n                var options = self.options;\n\n                var contentAreasWrapper = $(options.contentAreasWrapper || '<div />');\n                contentAreasWrapper.attr('class', 'keditor-ui keditor-content-area-wrapper');\n\n                if (!contentAreasWrapper.attr('id')) {\n                    contentAreasWrapper.attr('id', self.generateId('content-area-wrapper'));\n                }\n\n                contentAreasWrapper.html(content);\n\n                return contentAreasWrapper;\n            }\n        }, {\n            key: 'generateToolbar',\n            value: function generateToolbar(type, isComponentConfigurable) {\n                var self = this;\n                var options = self.options;\n                var settingBtn = '';\n\n                switch (type) {\n                    case TOOLBAR_TYPE.CONTENT_AREA:\n                        return '                    \\n                        <div class=\"keditor-ui keditor-content-area-toolbar\">\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-container\" title=\"Add container\">' + options.btnAddContainerText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.CONTAINER:\n                        if (options.containerSettingEnabled === true) {\n                            settingBtn = '<a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-setting\">' + options.btnSettingContainerText + '</a>';\n                        }\n\n                        return '\\n                        <div class=\"keditor-toolbar keditor-toolbar-container\">\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-reposition\">' + options.btnMoveContainerText + '</a>\\n                            ' + settingBtn + '\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-duplicate\">' + options.btnDuplicateContainerText + '</a>\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-delete\">' + options.btnDeleteContainerText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.SUB_CONTAINER:\n                        if (options.containerSettingEnabled === true) {\n                            settingBtn = '<a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-setting\">' + options.btnSettingContainerText + '</a>';\n                        }\n\n                        return '\\n                        <div class=\"keditor-toolbar keditor-toolbar-container keditor-toolbar-sub-container\">\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-reposition\">' + options.btnMoveContainerText + '</a>\\n                            ' + settingBtn + '\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-duplicate\">' + options.btnDuplicateContainerText + '</a>\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-delete\">' + options.btnDeleteContainerText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.CONTAINER_CONTENT:\n                        return '          \\n                        <div class=\"keditor-ui keditor-container-content-toolbar keditor-btn-group\">\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-container\" title=\"Add sub-container\">' + options.btnAddSubContainerText + '</a>\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-component\" title=\"Add component\">' + options.btnAddComponentText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.SUB_CONTAINER_CONTENT:\n                        return '\\n                        <div class=\"keditor-ui keditor-container-content-toolbar\">\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-component\" title=\"Add component\">' + options.btnAddComponentText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.COMPONENT:\n                        if (isComponentConfigurable) {\n                            settingBtn = '<a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-setting\">' + options.btnSettingComponentText + '</a>';\n                        }\n\n                        return '\\n                        <div class=\"keditor-toolbar keditor-toolbar-component\">\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-reposition\">' + options.btnMoveComponentText + '</a>\\n                            ' + settingBtn + '\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-duplicate\">' + options.btnDuplicateComponentText + '</a>\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-delete\">' + options.btnDeleteComponentText + '</a>\\n                        </div>\\n                    ';\n\n                    default:\n                    // Do nothing\n                }\n            }\n        }, {\n            key: 'beautifyCategories',\n            value: function beautifyCategories(categories) {\n                var newArray = [];\n                for (var i = 0; i < categories.length; i++) {\n                    var category = categories[i] || '';\n\n                    if (category !== '' && $.inArray(category, newArray) === -1) {\n                        newArray.push(category);\n                    }\n                }\n\n                return newArray.sort();\n            }\n        }, {\n            key: 'setSettingContainer',\n            value: function setSettingContainer(container) {\n                this.settingContainer = container;\n            }\n        }, {\n            key: 'getSettingContainer',\n            value: function getSettingContainer() {\n                return this.settingContainer;\n            }\n        }, {\n            key: 'setSettingComponent',\n            value: function setSettingComponent(component) {\n                this.settingComponent = component;\n            }\n        }, {\n            key: 'getSettingComponent',\n            value: function getSettingComponent() {\n                return this.settingComponent;\n            }\n        }, {\n            key: 'getDataAttributes',\n            value: function getDataAttributes(target, ignoreAttributes, isArray) {\n                var dataAttributes = isArray ? [] : {};\n                if (!ignoreAttributes) {\n                    ignoreAttributes = [];\n                }\n\n                $.each(target.get(0).attributes, function (i, attr) {\n                    if (attr.name.indexOf('data-') === 0 && $.inArray(attr.name, ignoreAttributes) === -1) {\n                        if (isArray) {\n                            dataAttributes.push(attr.name + '=\"' + attr.value + '\"');\n                        } else {\n                            dataAttributes[attr.name] = attr.value;\n                        }\n                    }\n                });\n\n                return dataAttributes;\n            }\n        }, {\n            key: 'getComponentType',\n            value: function getComponentType(component) {\n                var self = this;\n                var options = self.options;\n\n                var componentType = (component.attr('data-type') || '').replace('component-', '');\n                if (componentType && componentType in KEditor.components) {\n                    return componentType;\n                } else {\n                    if (typeof options.defaultComponentType === 'string') {\n                        componentType = options.defaultComponentType;\n                    } else if (typeof options.defaultComponentType === 'function') {\n                        componentType = options.defaultComponentType.call(self, component);\n                    }\n\n                    if (!componentType) {\n                        error('Component type is undefined!');\n                    }\n\n                    flog('Fallback to defaultComponentType: ' + componentType);\n                    return componentType;\n                }\n            }\n        }, {\n            key: 'getClickedElement',\n            value: function getClickedElement(event, selector) {\n                var target = $(event.target);\n                var closest = target.closest(selector);\n\n                if (target.is(selector)) {\n                    return target;\n                } else if (closest.length > 0) {\n                    return closest;\n                } else {\n                    return null;\n                }\n            }\n\n            // Iframe\n            //---------------------------------\n\n        }, {\n            key: 'initIframe',\n            value: function initIframe() {\n                flog('initIframe');\n\n                var self = this;\n                var options = self.options;\n                var element = self.element;\n                var originalContent = element.is('textarea') ? element.val() : element.html();\n                var wrapper = self.iframeWrapper = $('<div class=\"keditor-ui keditor-iframe-wrapper\"></div>');\n                var iframe = self.iframe = $('<iframe class=\"keditor-ui keditor-iframe\"></iframe>');\n\n                element.after(wrapper);\n                wrapper.attr('id', self.generateId('iframe-wrapper')).append(iframe);\n                element.addClass('keditor-hidden-element');\n\n                var iframeDoc = self.iframeDoc = iframe.contents();\n\n                // Fix issue Firefox can't render content inside iframe\n                // ======================================================\n                iframeDoc.get(0).open();\n                iframeDoc.get(0).close();\n                // ======================================================\n\n                self.window = iframe[0].contentWindow ? iframe[0].contentWindow : iframe[0].contentDocument.defaultView;\n                var iframeHead = self.iframeHead = iframeDoc.find('head');\n                var iframeBody = self.iframeBody = self.body = iframeDoc.find('body');\n\n                flog('Adding styles to iframe...');\n                var styles = '';\n                $('[data-type=\"keditor-style\"]').each(function () {\n                    var style = $(this);\n                    var href = style.attr('href') || style.attr('data-href') || '';\n\n                    if (href) {\n                        styles += '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + href + '\" />\\n';\n                    } else {\n                        styles += '<style type=\"text/css\">' + style.html() + '</style>\\n';\n                    }\n                });\n\n                if (options.contentStyles && $.isArray(options.contentStyles)) {\n                    $.each(options.contentStyles, function (i, style) {\n                        var idStr = '';\n                        if (style.id) {\n                            idStr = ' id=\"' + style.id + '\" ';\n                        }\n\n                        if (style.href) {\n                            styles += '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + style.href + '\" ' + idStr + ' />\\n';\n                        } else {\n                            styles += '<style type=\"text/css\" ' + idStr + '>' + style.content + '</style>\\n';\n                        }\n                    });\n                }\n\n                iframeHead.append(styles);\n\n                flog('Adding original content to iframe...');\n                var contentAreasWrapper = self.generateContentAreasWrapper(originalContent);\n                iframeBody.append(contentAreasWrapper);\n                self.contentAreasWrapper = contentAreasWrapper;\n\n                if (typeof options.onInitIframe === 'function') {\n                    options.onInitIframe.call(self, iframe, iframeHead, iframeBody);\n                }\n            }\n\n            // KEditor clicks\n            //---------------------------------\n\n        }, {\n            key: 'initKEditorClicks',\n            value: function initKEditorClicks() {\n                flog('initKEditorClicks');\n\n                var self = this;\n                var options = self.options;\n                var body = self.body;\n\n                body.on('click', function (e) {\n                    var sidebar = self.getClickedElement(e, '#keditor-sidebar');\n\n                    var container = self.getClickedElement(e, '.keditor-container');\n                    if (container) {\n                        if (!container.hasClass('showed-keditor-toolbar')) {\n                            body.find('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            container.addClass('showed-keditor-toolbar');\n\n                            var contentArea = container.parent();\n                            if (typeof options.onContainerSelected === 'function') {\n                                options.onContainerSelected.call(self, e, container, contentArea);\n                            }\n                        }\n                    } else {\n                        if (!sidebar) {\n                            body.find('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                        }\n                    }\n\n                    var component = self.getClickedElement(e, '.keditor-component');\n                    if (component) {\n                        if (!component.hasClass('showed-keditor-toolbar')) {\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            component.addClass('showed-keditor-toolbar');\n\n                            var _contentArea = component.parent();\n                            if (typeof options.onComponentSelected === 'function') {\n                                options.onComponentSelected.call(self, e, component, _contentArea);\n                            }\n                        }\n                    } else {\n                        if (!sidebar) {\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                        }\n                    }\n                });\n\n                body.on('click', '.btn-container-setting', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-container-setting', btn);\n\n                    var container = btn.closest('.keditor-container');\n                    if (body.hasClass('opened-keditor-setting') && body.hasClass('opened-keditor-sidebar')) {\n                        if (!container.is(self.settingContainer)) {\n                            self.openSidebar(container);\n                        } else {\n                            self.closeSidebar();\n                        }\n                    } else {\n                        self.openSidebar(container);\n                    }\n                });\n\n                body.on('click', '.btn-container-duplicate', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-container-duplicate', btn);\n\n                    var container = btn.closest('.keditor-container');\n                    var contentArea = container.parent();\n                    var newContainer = $(self.getContainerContent(container, btn.parent().hasClass('keditor-toolbar-sub-container')));\n                    container.after(newContainer);\n                    self.convertToContainer(contentArea, newContainer);\n\n                    flog('Container is duplicated');\n\n                    if (typeof options.onContainerDuplicated === 'function') {\n                        options.onContainerDuplicated.call(self, container, newContainer, contentArea);\n                    }\n\n                    if (typeof options.onContentChanged === 'function') {\n                        options.onContentChanged.call(self, e, contentArea);\n                    }\n                });\n\n                body.on('click', '.btn-container-delete', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-container-delete', btn);\n\n                    if (confirm('Are you sure that you want to delete this container? This action can not be undo!')) {\n                        var container = btn.closest('.keditor-container');\n                        var components = container.find('.keditor-component');\n                        var contentArea = container.parent();\n\n                        if (typeof options.onBeforeContainerDeleted === 'function') {\n                            options.onBeforeContainerDeleted.call(self, e, container, contentArea);\n                        }\n\n                        var settingComponent = self.settingComponent;\n                        if (settingComponent) {\n                            var settingComponentParent = settingComponent.closest('.keditor-container');\n                            if (settingComponentParent.is(container)) {\n                                flog('Deleting container is container of setting container. Close setting panel for this setting component', settingComponent);\n                                self.closeSidebar();\n                            }\n                        } else if (container.is(self.settingContainer)) {\n                            flog('Deleting container is setting container. Close setting panel for this container', container);\n                            self.closeSidebar();\n                        }\n\n                        if (components.length > 0) {\n                            components.each(function () {\n                                self.deleteComponent($(this));\n                            });\n                        }\n\n                        container.remove();\n\n                        if (typeof options.onContainerDeleted === 'function') {\n                            options.onContainerDeleted.call(self, e, container, contentArea);\n                        }\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, e, contentArea);\n                        }\n                    }\n                });\n\n                body.on('click', '.btn-component-setting', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-component-setting', btn);\n\n                    var component = btn.closest('.keditor-component');\n                    if (body.hasClass('opened-keditor-setting') && body.hasClass('opened-keditor-sidebar')) {\n                        if (!component.is(self.settingComponent())) {\n                            self.openSidebar(component);\n                        } else {\n                            self.closeSidebar();\n                        }\n                    } else {\n                        self.openSidebar(component);\n                    }\n                });\n\n                body.on('click', '.btn-component-duplicate', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-component-duplicate', btn);\n\n                    var component = btn.closest('.keditor-component');\n                    var container = component.closest('.keditor-container');\n                    var contentArea = container.parent();\n                    var newComponent = $(self.getComponentContent(component));\n\n                    component.after(newComponent);\n                    self.convertToComponent(contentArea, container, newComponent);\n\n                    flog('Component is duplicated');\n\n                    if (typeof options.onComponentDuplicated === 'function') {\n                        options.onComponentDuplicated.call(self, component, newComponent, contentArea);\n                    }\n\n                    if (typeof options.onContainerChanged === 'function') {\n                        options.onContainerChanged.call(self, e, container, contentArea);\n                    }\n\n                    if (typeof options.onContentChanged === 'function') {\n                        options.onContentChanged.call(self, e, contentArea);\n                    }\n                });\n\n                body.on('click', '.btn-component-delete', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-component-delete', btn);\n\n                    if (confirm('Are you sure that you want to delete this component? This action can not be undo!')) {\n                        var component = btn.closest('.keditor-component');\n                        var container = component.closest('.keditor-container');\n                        var contentArea = component.closest('.keditor-content-area');\n\n                        if (typeof options.onBeforeComponentDeleted === 'function') {\n                            options.onBeforeComponentDeleted.call(self, e, component, contentArea);\n                        }\n\n                        if (component.is(self.settingComponent)) {\n                            self.closeSidebar();\n                        }\n\n                        self.deleteComponent(component);\n\n                        if (typeof options.onComponentDeleted === 'function') {\n                            options.onComponentDeleted.call(self, e, component, contentArea);\n                        }\n\n                        if (typeof options.onContainerChanged === 'function') {\n                            options.onContainerChanged.call(self, e, container, contentArea);\n                        }\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, e, contentArea);\n                        }\n                    }\n                });\n\n                body.addClass('keditor-clicks-initialized');\n            }\n\n            // Sidebar\n            //---------------------------------\n\n        }, {\n            key: 'initSidebar',\n            value: function initSidebar() {\n                var self = this;\n                var options = self.options;\n                var sidebarId = self.generateId('sidebar');\n\n                var sidebar = self.sidebar = $('\\n                <div class=\"keditor-ui keditor-sidebar\" id=\"' + sidebarId + '\">                    \\n                    <div class=\"keditor-ui keditor-sidebar-header\">\\n                        <span class=\"keditor-ui keditor-sidebar-title\"></span>\\n                        <a href=\"javascript:void(0);\" class=\"keditor-ui keditor-sidebar-close\">&times;</a>\\n                    </div>\\n                    <div class=\"keditor-ui keditor-sidebar-body\">\\n                        \\n                    </div>\\n                </div>\\n            ');\n\n                sidebar.find('.keditor-sidebar-close').on('click', function (e) {\n                    e.preventDefault();\n\n                    self.closeSidebar();\n                });\n\n                var sidebarBody = sidebar.find('.keditor-sidebar-body');\n                sidebarBody.on('submit', 'form', function (e) {\n                    e.preventDefault();\n                    return false;\n                });\n\n                if (options.containerSettingEnabled === true) {\n                    if (typeof options.containerSettingInitFunction === 'function') {\n\n                        var form = $('<div  class=\"keditor-ui keditor-setting-form keditor-container-setting\"></div>');\n                        sidebarBody.append(form);\n\n                        flog('Initialize container setting panel');\n                        options.containerSettingInitFunction.call(self, form, self);\n                    } else {\n                        error('\"containerSettingInitFunction\" is not function!');\n                    }\n                }\n\n                sidebar.appendTo(options.iframeMode ? self.iframeWrapper : self.body);\n            }\n        }, {\n            key: 'openSidebar',\n            value: function openSidebar(target) {\n                var self = this;\n                var options = self.options;\n                var sidebar = self.sidebar;\n                var sidebarTitle = sidebar.find('.keditor-sidebar-title');\n                var sidebarBody = sidebar.find('.keditor-sidebar-body');\n                var activeForm = sidebarBody.children('.active');\n                activeForm.removeClass('active');\n\n                if (target.is('.keditor-component')) {\n                    self.setSettingComponent(target);\n                    self.setSettingContainer(null);\n\n                    var componentType = self.getComponentType(target);\n                    var componentData = KEditor.components[componentType];\n                    sidebarTitle.html(componentData.settingTitle);\n\n                    var settingForm = sidebarBody.find('.keditor-setting-' + componentType);\n\n                    if (settingForm.length === 0) {\n                        var _componentData = KEditor.components[componentType];\n                        if (typeof _componentData.initSettingForm === 'function') {\n                            settingForm = $('\\n                            <div \\n                                data-type=\"' + componentType + '\" \\n                                class=\"keditor-ui keditor-setting-form keditor-setting-' + componentType + ' clearfix active\"\\n                            >\\n                            </div>\\n                        ');\n                            var loadingText = $('<span />').html('Loading...');\n                            sidebarBody.append(settingForm);\n                            settingForm.append(loadingText);\n\n                            var initFunction = _componentData.initSettingForm.call(_componentData, settingForm, self);\n                            $.when(initFunction).done(function () {\n                                flog('Initialized setting form for component type \"' + componentType + '\"');\n\n                                setTimeout(function () {\n                                    loadingText.remove();\n\n                                    if (typeof _componentData.showSettingForm === 'function') {\n                                        _componentData.showSettingForm.call(_componentData, settingForm, target, self);\n                                    }\n                                }, 100);\n                            });\n                        }\n                    } else {\n                        if (typeof componentData.showSettingForm === 'function') {\n                            componentData.showSettingForm.call(componentData, settingForm, target, self);\n                        }\n                        settingForm.addClass('active');\n                    }\n                } else {\n                    self.setSettingContainer(target);\n                    self.setSettingComponent(null);\n\n                    sidebarTitle.html(\"Container Settings\");\n\n                    var _settingForm = sidebar.find('.keditor-container-setting');\n                    if (typeof options.containerSettingShowFunction === 'function') {\n                        options.containerSettingShowFunction.call(self, _settingForm, target, self);\n                    }\n                    _settingForm.addClass('active');\n                }\n\n                sidebar.addClass('opened');\n            }\n        }, {\n            key: 'closeSidebar',\n            value: function closeSidebar() {\n                var self = this;\n                var options = self.options;\n                var sidebar = self.sidebar;\n                var activeForm = sidebar.find('.keditor-sidebar-body').children('.active');\n\n                if (activeForm.length > 0) {\n                    if (activeForm.is('.keditor-container-setting')) {\n                        if (typeof options.containerSettingHideFunction === 'function') {\n                            options.containerSettingHideFunction.call(self, activeForm, self);\n                        }\n                    } else {\n                        var activeType = activeForm.attr('data-type');\n                        var componentData = KEditor.components[activeType];\n\n                        if (typeof componentData.hideSettingForm === 'function') {\n                            componentData.hideSettingForm.call(componentData, activeForm, self);\n                        }\n                    }\n\n                    activeForm.removeClass('active');\n                }\n\n                self.setSettingComponent(null);\n                self.setSettingContainer(null);\n                sidebar.removeClass('opened');\n            }\n\n            // Legacy methods. DEPRECATED\n            //---------------------------------\n\n        }, {\n            key: 'showSettingPanel',\n            value: function showSettingPanel(target) {\n                this.openSidebar(target);\n            }\n        }, {\n            key: 'hideSettingPanel',\n            value: function hideSettingPanel() {\n                this.closeSidebar();\n            }\n\n            // Snippet modal\n            //---------------------------------\n\n        }, {\n            key: 'initSnippetsModal',\n            value: function initSnippetsModal() {\n                var self = this;\n                var options = self.options;\n                var modalId = self.generateId('modal');\n\n                var modal = self.modal = $('\\n                <div class=\"keditor-ui keditor-modal\" id=\"' + modalId + '\">\\n                   <div class=\"keditor-modal-header\">\\n                       <button type=\"button\" class=\"keditor-modal-close\">&times;</button>\\n                       <h4 class=\"keditor-modal-title\"></h4>\\n                   </div>\\n                   <div class=\"keditor-modal-body\">\\n                       <div class=\"keditor-snippets-wrapper keditor-snippets-wrapper-container\">\\n                           <div class=\"keditor-snippets keditor-snippet-container\"></div>\\n                       </div>\\n                       <div class=\"keditor-snippets-wrapper keditor-snippets-wrapper-component\">\\n                           <div class=\"keditor-snippets keditor-snippet-component\"></div>\\n                       </div>\\n                   </div>\\n                   <div class=\"keditor-modal-footer\">\\n                       <button type=\"button\" class=\"keditor-ui keditor-btn keditor-btn-default keditor-modal-close\">Close</button>\\n                       <button type=\"button\" class=\"keditor-ui keditor-btn keditor-btn-primary keditor-modal-add\">Add</button>\\n                   </div>\\n                </div>\\n            ');\n\n                if (typeof options.snippetsUrl === 'string' && options.snippetsUrl.length > 0) {\n                    flog('Getting snippets form \"' + options.snippetsUrl + '\"...');\n\n                    $.ajax({\n                        type: 'get',\n                        dataType: 'html',\n                        url: options.snippetsUrl,\n                        success: function success(resp) {\n                            flog('Success in getting snippets');\n\n                            if (typeof options.onSnippetsLoaded === 'function') {\n                                resp = options.onSnippetsLoaded.call(self, resp) || resp;\n                            }\n\n                            self.renderSnippets(resp);\n\n                            if (options.snippetsFilterEnabled) {\n                                self.initSnippetsFilter(true);\n                                self.initSnippetsFilter();\n                            }\n                        },\n                        error: function error(jqXHR) {\n                            flog('Error when getting snippets', jqXHR);\n                            if (typeof options.onSnippetsError === 'function') {\n                                options.onSnippetsError.call(self, jqXHR);\n                            }\n                        }\n                    });\n\n                    // Close buttons\n                    modal.find('.keditor-modal-close').on('click', function (e) {\n                        e.preventDefault();\n\n                        self.closeModal();\n                    });\n\n                    // Add button\n                    modal.find('.keditor-modal-add').on('click', function (e) {\n                        e.preventDefault();\n\n                        var selectedSnippet = modal.find('.keditor-snippets-wrapper .selected');\n                        if (selectedSnippet.length === 0) {\n                            return;\n                        }\n\n                        var contentArea = self.modalTarget.closest('.keditor-content-area');\n                        var snippetType = selectedSnippet.attr('data-type');\n                        var snippetContentElement = modal.find(selectedSnippet.attr('data-snippet'));\n                        var snippetContent = snippetContentElement.html();\n\n                        switch (self.modalAction) {\n                            case MODAL_ACTION.ADD_COMPONENT:\n                                var dataAttributes = self.getDataAttributes(snippetContentElement, null, true);\n                                var newComponent = $('\\n                                <section class=\"keditor-ui keditor-component\" data-type=\"' + snippetType + '\" ' + dataAttributes.join(' ') + '>\\n                                    <section class=\"keditor-ui keditor-component-content\">' + snippetContent + '</section>\\n                                </section>\\n                            ');\n\n                                self.modalTarget.append(newComponent);\n\n                                var container = self.modalTarget.closest('.keditor-container');\n                                if (typeof options.onComponentSnippetAdded === 'function') {\n                                    options.onComponentSnippetAdded.call(self, e, newComponent, selectedSnippet, contentArea);\n                                }\n\n                                self.initComponent(contentArea, container, newComponent);\n                                break;\n\n                            case MODAL_ACTION.ADD_CONTAINER:\n                            case MODAL_ACTION.ADD_SUB_CONTAINER:\n                                var newContainer = $('\\n                                <section class=\"keditor-ui keditor-container showed-keditor-toolbar\">\\n                                    <section class=\"keditor-ui keditor-container-inner\">' + snippetContent + '</section>\\n                                </section>\\n                            ');\n\n                                self.body.find('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                                self.modalTarget.append(newContainer);\n\n                                if (typeof options.onContainerSnippetAdded === 'function') {\n                                    options.onContainerSnippetAdded.call(self, event, newContainer, selectedSnippet, contentArea);\n                                }\n\n                                self.initContainer(contentArea, newContainer);\n                                break;\n\n                            default:\n                            // Do nothing\n                        }\n\n                        self.closeModal();\n                    });\n\n                    // Action click for snippet\n                    modal.on('click', '.keditor-snippet', function (e) {\n                        e.preventDefault();\n\n                        var snippet = $(this);\n                        if (!snippet.hasClass('selected')) {\n                            snippet.parent().find('.selected').removeClass('selected');\n                            snippet.addClass('selected');\n                        }\n                    });\n\n                    var cssTransitionEnd = 'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend';\n                    modal.on(cssTransitionEnd, function () {\n                        if (!modal.hasClass('showed')) {\n                            modal.css('display', 'none');\n                            $(document.body).removeClass('opened-modal');\n                        }\n                    });\n\n                    modal.appendTo(document.body);\n                } else {\n                    error('\"snippetsUrl\" must be not null!');\n                }\n            }\n        }, {\n            key: 'renderSnippets',\n            value: function renderSnippets(resp) {\n                flog('renderSnippets');\n\n                var self = this;\n                var options = self.options;\n\n                var snippetsContainerHtml = '';\n                var snippetsComponentHtml = '';\n                var snippetsContentHtml = '';\n\n                self.snippetsContainerCategories = [];\n                self.snippetsComponentCategories = [];\n\n                $(resp).filter('div').each(function (i) {\n                    var snippet = $(this);\n                    var snippetId = self.generateId('snippet');\n                    var content = snippet.html().trim();\n                    var previewUrl = snippet.attr('data-preview');\n                    var type = snippet.attr('data-type');\n                    var title = snippet.attr('data-keditor-title');\n                    var categories = snippet.attr('data-keditor-categories') || '';\n\n                    var snippetHtml = '\\n                    <section\\n                        class=\"keditor-ui keditor-snippet\"\\n                        data-snippet=\"#' + snippetId + '\"\\n                        data-type=\"' + type + '\"\\n                        title=\"' + title + '\"\\n                        data-keditor-categories=\"' + categories + '\"\\n                    >\\n                        <span><span style=\"background-image: url(\\'' + previewUrl + '\\')\"></span></span>   \\n                    </section>\\n                ';\n\n                    categories = categories.split(options.snippetsCategoriesSeparator);\n\n                    if (type === 'container') {\n                        snippetsContainerHtml += snippetHtml;\n                        self.snippetsContainerCategories = self.snippetsContainerCategories.concat(categories);\n                    } else if (type.indexOf('component') !== -1) {\n                        snippetsComponentHtml += snippetHtml;\n                        self.snippetsComponentCategories = self.snippetsComponentCategories.concat(categories);\n                    }\n\n                    var dataAttributes = self.getDataAttributes(snippet, ['data-preview', 'data-type', 'data-keditor-title', 'data-keditor-categories'], true);\n                    snippetsContentHtml += '<script id=\"' + snippetId + '\" type=\"text/html\" ' + dataAttributes.join(' ') + '>' + content + '</script>';\n                });\n\n                self.snippetsContainerCategories = self.beautifyCategories(self.snippetsContainerCategories);\n                self.snippetsComponentCategories = self.beautifyCategories(self.snippetsComponentCategories);\n\n                self.modal.find('.keditor-snippet-container').html(snippetsContainerHtml);\n                self.modal.find('.keditor-snippet-component').html(snippetsComponentHtml);\n                self.modal.find('.keditor-modal-body').append(snippetsContentHtml);\n            }\n        }, {\n            key: 'initSnippetsFilter',\n            value: function initSnippetsFilter(isContainer) {\n                flog('initSnippetsFilter for ' + (isContainer ? 'container' : 'component'));\n\n                var self = this;\n                var options = self.options;\n                var modal = self.modal;\n\n                var categoriesOptions = '';\n                $.each(isContainer ? self.snippetsContainerCategories : self.snippetsComponentCategories, function (i, category) {\n                    categoriesOptions += '<option value=\"' + category + '\">' + category + '</option>';\n                });\n\n                var snippetsWrapper = modal.find(isContainer ? '.keditor-snippets-wrapper-container' : '.keditor-snippets-wrapper-component');\n                var snippets = snippetsWrapper.find('.keditor-snippets').children('.keditor-snippet');\n\n                snippetsWrapper.prepend('\\n                <div class=\"keditor-ui keditor-snippets-filter-wrapper\">\\n                    <select class=\"keditor-ui keditor-snippets-filter\">\\n                        <option value=\"\" selected=\"selected\">All</option>\\n                        ' + categoriesOptions + '\\n                    </select>\\n                    <input type=\"text\" class=\"keditor-ui keditor-snippets-search\" value=\"\" placeholder=\"Type to search...\" />\\n                </div>                \\n            ');\n\n                snippets.each(function () {\n                    var snippet = $(this);\n                    var categories = snippet.attr('data-keditor-categories') || '';\n                    var filterCategories = categories.toLowerCase();\n                    categories = categories.split(options.snippetsCategoriesSeparator);\n                    filterCategories = filterCategories.split(options.snippetsCategoriesSeparator);\n\n                    snippet.data('categories', categories);\n                    snippet.data('categoriesFilter', filterCategories);\n                });\n\n                var txtSearch = snippetsWrapper.find('.keditor-snippets-search');\n                var cbbFilter = snippetsWrapper.find('.keditor-snippets-filter');\n\n                var doFilter = function doFilter() {\n                    var selectedCategory = (cbbFilter.val() || '').toLowerCase();\n                    var searchText = (txtSearch.val() || '').toLowerCase();\n                    snippets.filter('.selected').removeClass('selected');\n\n                    if (selectedCategory || searchText) {\n                        flog('Filtering snippets');\n\n                        snippets.each(function () {\n                            var snippet = $(this);\n                            var dataCategories = snippet.data('categoriesFilter');\n                            var dataCategoriesString = dataCategories.join(';');\n                            var error = 0;\n\n                            if (selectedCategory) {\n                                if ($.inArray(selectedCategory, dataCategories) === -1) {\n                                    error++;\n                                }\n                            }\n\n                            if (searchText) {\n                                var title = snippet.attr('title').toLowerCase();\n                                if (title.indexOf(searchText) === -1 && dataCategoriesString.indexOf(searchText) === -1) {\n                                    error++;\n                                }\n                            }\n\n                            snippet[error === 0 ? 'removeClass' : 'addClass']('not-matched');\n                        });\n                    } else {\n                        flog('Show all snippets');\n                        snippets.removeClass('not-matched');\n                    }\n                };\n\n                cbbFilter.on('change', function () {\n                    doFilter();\n                });\n\n                var timer = void 0;\n                txtSearch.on('keydown', function () {\n                    clearTimeout(timer);\n                    timer = setTimeout(doFilter, 200);\n                });\n            }\n        }, {\n            key: 'openModal',\n            value: function openModal(target, action) {\n                var self = this;\n                var modal = self.modal;\n                var modalTitle = '';\n\n                switch (action) {\n                    case MODAL_ACTION.ADD_CONTAINER:\n                        modalTitle = 'Add container';\n                        break;\n\n                    case MODAL_ACTION.ADD_SUB_CONTAINER:\n                        modalTitle = 'Add sub-container';\n                        break;\n\n                    case MODAL_ACTION.ADD_COMPONENT:\n                        modalTitle = 'Add component';\n                        break;\n\n                    default:\n                    // Do nothing\n                }\n\n                modal.find('.keditor-modal-title').html(modalTitle);\n                modal.find('.keditor-snippets-wrapper').css('display', 'none');\n                modal.find(action === MODAL_ACTION.ADD_COMPONENT ? '.keditor-snippets-wrapper-component' : '.keditor-snippets-wrapper-container').css('display', 'block');\n\n                self.modalTarget = target;\n                self.modalAction = action;\n\n                modal.css('display', 'block');\n                $(document.body).addClass('opened-modal');\n                setTimeout(function () {\n                    modal.addClass('showed');\n                }, 0);\n            }\n        }, {\n            key: 'closeModal',\n            value: function closeModal() {\n                var self = this;\n                var modal = self.modal;\n\n                self.modalTarget = null;\n                self.modalAction = null;\n                modal.find('.keditor-modal-title').html('');\n                modal.find('.keditor-snippets-wrapper .selected').removeClass('selected');\n                modal.removeClass('showed');\n            }\n\n            // Content areas\n            //---------------------------------\n\n        }, {\n            key: 'initContentAreas',\n            value: function initContentAreas() {\n                flog('initContentAreas');\n\n                var self = this;\n                var contentAreasWrapper = self.contentAreasWrapper;\n                var options = self.options;\n\n                var contentAreas = void 0;\n                if (options.contentAreasSelector) {\n                    contentAreas = contentAreasWrapper.find(options.contentAreasSelector);\n                }\n\n                if (!contentAreas || contentAreas.length === 0) {\n                    flog('Do not find any content area. Creating default content area...');\n                    var originalContent = contentAreasWrapper.html();\n\n                    contentAreas = $('<div />').html(originalContent);\n                    contentAreasWrapper.empty().append(contentAreas);\n                }\n\n                contentAreas.each(function () {\n                    var contentArea = $(this);\n                    if (!contentArea.attr('id')) {\n                        contentArea.attr('id', self.generateId('content-area'));\n                    }\n\n                    self.initContentArea(contentArea);\n                });\n            }\n        }, {\n            key: 'initContentArea',\n            value: function initContentArea(contentArea, dontInitToolbar) {\n                flog('initContentArea', contentArea);\n\n                var self = this;\n                var options = self.options;\n\n                contentArea.addClass('keditor-content-area');\n\n                if (typeof options.onBeforeInitContentArea === 'function') {\n                    options.onBeforeInitContentArea.call(self, contentArea);\n                }\n\n                if (!dontInitToolbar) {\n                    var contentAreaToolbar = $(self.generateToolbar(TOOLBAR_TYPE.CONTENT_AREA));\n                    contentArea.after(contentAreaToolbar);\n                    contentAreaToolbar.children('.btn-add-container').on('click', function (e) {\n                        e.preventDefault();\n\n                        self.openModal(contentArea, MODAL_ACTION.ADD_CONTAINER);\n                    });\n                }\n\n                flog('Initialize $.fn.sortable for content area');\n                contentArea.sortable({\n                    handle: '.keditor-toolbar-container:not(.keditor-toolbar-sub-container) .btn-container-reposition',\n                    items: '> section',\n                    helper: 'clone',\n                    connectWith: '.keditor-content-area',\n                    axis: 'y',\n                    tolerance: 'pointer',\n                    sort: function sort() {\n                        $(this).removeClass('ui-state-default');\n                    },\n                    receive: function receive(event, ui) {\n                        flog('On received snippet', event, ui);\n\n                        var helper = ui.helper;\n                        var item = ui.item;\n\n                        if (helper) {\n                            helper.remove();\n                        }\n\n                        self.closeSidebar();\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, event, contentArea);\n                        }\n\n                        item.addClass('keditor-ui-dragging');\n                        contentArea.removeClass('keditor-highlighted-dropzone');\n                    },\n                    start: function start(e, ui) {\n                        ui.item.addClass('keditor-ui-dragging');\n                    },\n                    stop: function stop(e, ui) {\n                        contentArea.removeClass('keditor-highlighted-dropzone');\n                        if (ui.helper) {\n                            ui.helper.remove();\n                        }\n                        ui.item.removeClass('keditor-ui-dragging');\n                    },\n                    over: function over() {\n                        contentArea.addClass('keditor-highlighted-dropzone');\n                    },\n                    out: function out() {\n                        contentArea.addClass('keditor-highlighted-dropzone');\n                    }\n                });\n\n                flog('Initialize existing containers in content area');\n                contentArea.children('section').each(function () {\n                    self.convertToContainer(contentArea, $(this));\n                });\n\n                if (typeof options.onInitContentArea === 'function') {\n                    var contentData = options.onInitContentArea.call(self, contentArea);\n                    if (contentData && contentData.length > 0) {\n                        $.each(contentData, function () {\n                            self.convertToContainer(contentArea, $(this));\n                        });\n                    }\n                }\n            }\n\n            // Containers\n            //---------------------------------\n\n        }, {\n            key: 'convertToContainer',\n            value: function convertToContainer(contentArea, target) {\n                flog('convertToContainer', contentArea, target);\n\n                var self = this;\n                var container = void 0;\n\n                if (target.is('section')) {\n                    target.addClass('keditor-ui keditor-container');\n                    target.wrapInner('<section class=\"keditor-ui keditor-container-inner\"></section>');\n                    container = target;\n                } else {\n                    target.wrap('<section class=\"keditor-ui keditor-container\"><section class=\"keditor-ui keditor-container-inner\"></section></section>');\n                    container = target.parent().parent();\n                }\n\n                self.initContainer(contentArea, container);\n            }\n        }, {\n            key: 'initContainer',\n            value: function initContainer(contentArea, container) {\n                var self = this;\n                var options = self.options;\n                var isNested = options.nestedContainerEnabled && container.closest('[data-type=\"container-content\"]').length > 0;\n\n                flog('initContainer - isNested=' + isNested, contentArea, container);\n\n                if (!container.hasClass('keditor-initialized-container') || !container.hasClass('keditor-initializing-container')) {\n                    container.addClass('keditor-initializing-container');\n\n                    if (typeof options.onBeforeInitContainer === 'function') {\n                        options.onBeforeInitContainer.call(self, container, contentArea);\n                    }\n\n                    if (isNested) {\n                        container.addClass('keditor-sub-container');\n                    }\n\n                    flog('Render KEditor toolbar for container', container);\n                    container.append(self.generateToolbar(isNested ? TOOLBAR_TYPE.SUB_CONTAINER : TOOLBAR_TYPE.CONTAINER));\n\n                    container.attr('id', self.generateId(isNested ? 'sub-container' : 'container'));\n\n                    var containerContents = container.find('[data-type=\"container-content\"]');\n                    flog('Initialize ' + containerContents.length + ' container content(s)');\n                    containerContents.each(function () {\n                        var containerContent = $(this);\n\n                        if (options.nestedContainerEnabled && !isNested && containerContent.parents('[data-type=\"container-content\"]').length > 0) {\n                            // Do nothing because it's container content of sub container\n                            return;\n                        }\n\n                        self.initContainerContent(contentArea, container, containerContent, isNested);\n                    });\n\n                    if (typeof options.onInitContainer === 'function') {\n                        options.onInitContainer.call(self, container, contentArea);\n                    }\n\n                    container.addClass('keditor-initialized-container');\n                    container.removeClass('keditor-initializing-container');\n                } else {\n                    if (container.hasClass('keditor-initialized-container')) {\n                        flog('Container is already initialized!');\n                    } else {\n                        flog('Container is initializing...');\n                    }\n                }\n            }\n        }, {\n            key: 'initContainerContent',\n            value: function initContainerContent(contentArea, container, containerContent, isNested) {\n                flog('initContainerContent - isNested=' + isNested, contentArea, container, containerContent);\n\n                var self = this;\n                var options = self.options;\n\n                containerContent.addClass('keditor-container-content');\n                if (isNested) {\n                    containerContent.addClass('keditor-sub-container-content');\n                }\n                containerContent.attr('id', self.generateId('container-content'));\n\n                var containerContentInner = $('<div class=\"keditor-container-content-inner\"></div>');\n                containerContentInner.html(containerContent.html());\n                containerContent.html(containerContentInner);\n\n                flog('Initialize toolbar for container content');\n                var containerContentToolbar = $(self.generateToolbar(isNested ? TOOLBAR_TYPE.SUB_CONTAINER_CONTENT : TOOLBAR_TYPE.CONTAINER_CONTENT));\n                containerContentToolbar.appendTo(containerContent);\n                if (!isNested) {\n                    containerContentToolbar.children('.btn-add-container').on('click', function (e) {\n                        e.preventDefault();\n\n                        self.openModal(containerContentInner, MODAL_ACTION.ADD_SUB_CONTAINER);\n                    });\n                }\n                containerContentToolbar.children('.btn-add-component').on('click', function (e) {\n                    e.preventDefault();\n\n                    self.openModal(containerContentInner, MODAL_ACTION.ADD_COMPONENT);\n                });\n\n                flog('Initialize $.fn.sortable for container content');\n                containerContentInner.sortable({\n                    handle: '.btn-component-reposition, .btn-container-reposition',\n                    helper: 'clone',\n                    items: '> section',\n                    connectWith: '.keditor-container-content-inner',\n                    tolerance: 'pointer',\n                    sort: function sort() {\n                        $(this).removeClass('ui-state-default');\n                    },\n                    receive: function receive(event, ui) {\n                        flog('On received snippet', event, ui);\n\n                        var helper = ui.helper;\n                        var item = ui.item;\n                        var container = void 0;\n\n                        if (helper) {\n                            helper.remove();\n                        }\n                        container = item.closest('.keditor-container');\n\n                        if (!container.hasClass('showed-keditor-toolbar')) {\n                            $('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            container.addClass('showed-keditor-toolbar');\n                        }\n\n                        if (typeof options.onContainerChanged === 'function') {\n                            options.onContainerChanged.call(self, event, container, contentArea);\n                        }\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, event, contentArea);\n                        }\n\n                        item.removeClass('keditor-ui-dragging');\n                        contentArea.removeClass('keditor-highlighted-dropzone');\n                    },\n                    start: function start(e, ui) {\n                        ui.item.addClass('keditor-ui-dragging');\n                    },\n                    stop: function stop(e, ui) {\n                        containerContentInner.removeClass('keditor-highlighted-dropzone');\n\n                        if (ui.helper) {\n                            ui.helper.remove();\n                        }\n                        ui.item.removeClass('keditor-ui-dragging');\n                    },\n                    over: function over() {\n                        containerContentInner.addClass('keditor-highlighted-dropzone');\n                    },\n                    out: function out() {\n                        containerContentInner.removeClass('keditor-highlighted-dropzone');\n                    }\n                });\n\n                flog('Initialize existing components inside container content');\n                containerContentInner.children().each(function () {\n                    var child = $(this);\n\n                    if (child.find('[data-type=\"container-content\"]').length > 0) {\n                        self.convertToContainer(contentArea, child);\n                    } else {\n                        self.convertToComponent(contentArea, container, child, true);\n                    }\n                });\n            }\n\n            // Components\n            //---------------------------------\n\n        }, {\n            key: 'convertToComponent',\n            value: function convertToComponent(contentArea, container, target, isExisting) {\n                flog('convertToComponent', contentArea, container, target, isExisting);\n\n                if (target.is('.keditor-container-content-toolbar')) {\n                    return;\n                }\n\n                var self = this;\n                var isSection = target.is('section');\n                var component = void 0;\n\n                if (isSection) {\n                    target.addClass('keditor-ui keditor-component');\n                    target.wrapInner('<section class=\"keditor-ui keditor-component-content\"></section>');\n                    component = target;\n                } else {\n                    target.wrap('<section class=\"keditor-ui keditor-component\"><section class=\"keditor-ui keditor-component-content\"></section></section>');\n                    component = target.parent().parent();\n                }\n\n                if (isExisting) {\n                    component.addClass('existing-component');\n                }\n\n                self.initComponent(contentArea, container, component);\n            }\n        }, {\n            key: 'initComponent',\n            value: function initComponent(contentArea, container, component) {\n                flog('initComponent', contentArea, container, component);\n\n                var self = this;\n                var options = self.options;\n                var body = self.body;\n\n                if (!component.hasClass('keditor-initialized-component') || !component.hasClass('keditor-initializing-component')) {\n                    component.addClass('keditor-initializing-component');\n                    component.attr('id', self.generateId('component'));\n\n                    if (typeof options.onBeforeInitComponent === 'function') {\n                        options.onBeforeInitComponent.call(self, component, contentArea);\n                    }\n\n                    var componentContent = component.children('.keditor-component-content');\n                    componentContent.attr('id', self.generateId('component-content'));\n\n                    var componentType = self.getComponentType(component);\n                    flog('Component type: ' + componentType);\n\n                    var componentData = KEditor.components[componentType];\n\n                    flog('Render KEditor toolbar for component', component);\n                    component.append(self.generateToolbar(TOOLBAR_TYPE.COMPONENT, componentData.settingEnabled));\n\n                    component.find('[data-dynamic-href]').each(function () {\n                        var dynamicElement = $(this);\n\n                        self.initDynamicContent(dynamicElement);\n                    });\n\n                    if (typeof componentData.init === 'function') {\n                        componentData.init.call(componentData, contentArea, container, component, self);\n                    } else {\n                        flog('\"init\" function of component type \"' + componentType + '\" does not exist');\n                    }\n\n                    if (typeof options.onInitComponent === 'function') {\n                        options.onInitComponent.call(self, component, contentArea);\n                    }\n\n                    component.addClass('keditor-initialized-component');\n                    component.removeClass('keditor-initializing-component');\n                } else {\n                    if (component.hasClass('keditor-initialized-component')) {\n                        flog('Component is already initialized!');\n                    } else {\n                        flog('Component is initializing...');\n                    }\n                }\n            }\n        }, {\n            key: 'initDynamicContent',\n            value: function initDynamicContent(dynamicElement) {\n                flog('initDynamicContent', dynamicElement);\n\n                var self = this;\n                var options = self.options;\n                var component = dynamicElement.closest('.keditor-component');\n                var contentArea = dynamicElement.closest('.keditor-content-area');\n\n                dynamicElement.attr('id', self.generateId('dynamic-element'));\n\n                if (typeof options.onBeforeDynamicContentLoad === 'function') {\n                    options.onBeforeDynamicContentLoad.call(self, dynamicElement, component, contentArea);\n                }\n\n                var dynamicHref = dynamicElement.attr('data-dynamic-href');\n                var data = self.getDataAttributes(component, ['data-type', 'data-dynamic-href'], false);\n                data = $.param(data);\n                flog('Dynamic href: ' + dynamicHref + ', Data: ' + data);\n\n                return $.ajax({\n                    url: dynamicHref,\n                    data: data,\n                    type: 'GET',\n                    dataType: 'HTML',\n                    success: function success(response, status, xhr) {\n                        flog('Dynamic content is loaded', dynamicElement, response, status, xhr);\n                        dynamicElement.html(response);\n\n                        if (typeof options.onDynamicContentLoaded === 'function') {\n                            options.onDynamicContentLoaded.call(self, dynamicElement, response, status, xhr, contentArea);\n                        }\n                    },\n                    error: function error(response, status, xhr) {\n                        flog('Error when loading dynamic content', dynamicElement, response, status, xhr);\n\n                        if (typeof options.onDynamicContentError === 'function') {\n                            options.onDynamicContentError.call(self, dynamicElement, response, status, xhr, contentArea);\n                        }\n                    }\n                });\n            }\n        }, {\n            key: 'deleteComponent',\n            value: function deleteComponent(component) {\n                flog('deleteComponent', component);\n\n                var self = this;\n\n                var componentType = self.getComponentType(component);\n                var componentData = KEditor.components[componentType];\n                if (typeof componentData.destroy === 'function') {\n                    componentData.destroy.call(componentData, component, self);\n                }\n\n                component.remove();\n            }\n\n            // Get content\n            //---------------------------------\n\n        }, {\n            key: 'getComponentContent',\n            value: function getComponentContent(component) {\n                flog('getComponentContent');\n\n                var self = this;\n                var clonedComponent = component.clone();\n                var componentType = self.getComponentType(clonedComponent);\n                var componentData = KEditor.components[componentType];\n                var dataAttributes = self.getDataAttributes(clonedComponent, null, true);\n                var content = void 0;\n\n                if (typeof componentData.getContent === 'function') {\n                    content = componentData.getContent.call(componentData, clonedComponent, self);\n                } else {\n                    var componentContent = clonedComponent.children('.keditor-component-content');\n                    content = componentContent.html();\n                }\n\n                clonedComponent.html(content).find('[data-dynamic-href]').each(function () {\n                    $(this).html('');\n                });\n\n                return '<section ' + dataAttributes.join(' ') + '>' + clonedComponent.html() + '</section>';\n            }\n        }, {\n            key: 'getContainerContent',\n            value: function getContainerContent(container, isNested) {\n                flog('getContainerContent - isNested=' + isNested, container);\n\n                var self = this;\n                var containerInner = container.children('.keditor-container-inner').clone();\n\n                containerInner.find('[data-type=container-content]').not(isNested ? '' : '.keditor-sub-container-content').each(function () {\n                    var containerContent = $(this);\n                    containerContent.removeClass('keditor-container-content keditor-sub-container-content').removeAttr('id');\n\n                    var containerContentInner = containerContent.children();\n                    var content = '';\n\n                    containerContentInner.children().each(function () {\n                        var child = $(this);\n\n                        if (child.is('.keditor-component')) {\n                            content += self.getComponentContent(child);\n                        } else if (child.is('.keditor-sub-container')) {\n                            content += self.getContainerContent(child, true);\n                        }\n                    });\n\n                    containerContent.html(content);\n                });\n\n                return '<section>' + containerInner.html() + '</section>';\n            }\n        }, {\n            key: 'getContent',\n            value: function getContent(inArray) {\n                var self = this;\n                var result = [];\n\n                self.contentAreasWrapper.find('.keditor-content-area').each(function () {\n                    var html = '';\n                    $(this).children('.keditor-container').each(function () {\n                        var container = $(this);\n\n                        html += self.getContainerContent(container);\n                    });\n\n                    result.push(html);\n                });\n\n                return inArray ? result : result.join('\\n');\n            }\n\n            // Set content\n            //---------------------------------\n\n        }, {\n            key: 'setContent',\n            value: function setContent(content, contentArea) {\n                var self = this;\n                var contentAreasWrapper = self.contentAreasWrapper;\n\n                if (!contentArea) {\n                    contentArea = contentAreasWrapper.children('.keditor-content-area');\n                } else {\n                    if (!contentArea.jquery) {\n                        contentArea = contentAreasWrapper.find(contentArea);\n                    }\n                }\n\n                if (contentArea.length === 0) {\n                    error('Content area does not exist!');\n                }\n\n                contentArea.html(content);\n                self.initContentArea(contentArea, true);\n            }\n\n            // Destroy\n            //---------------------------------\n\n        }, {\n            key: 'destroy',\n            value: function destroy() {\n                var self = this;\n                var element = self.element;\n                var id = self.id;\n\n                var content = self.getContent(false);\n\n                if (self.options.iframeMode) {\n                    self.iframeWrapper.remove();\n                } else {\n                    self.contentAreasWrapper.remove();\n                }\n\n                if (element.is('textarea')) {\n                    element.val(content);\n                } else {\n                    element.html(content);\n                }\n\n                element.removeClass('keditor-hidden-element');\n                element.data('keditor', null);\n                delete KEditor.instances[id];\n            }\n        }]);\n\n        return KEditor;\n    }();\n\n    // KEditor plugins\n\n\n    $.fn.keditor = function (options) {\n        var element = $(this);\n        var instance = element.data('keditor');\n\n        if (typeof options === 'string') {\n            if (instance && instance[options] && typeof instance[options] === 'function') {\n                return instance[options].apply(instance, Array.prototype.slice.call(arguments, 1));\n            }\n        } else {\n            if (!instance) {\n                instance = new KEditor(element, options);\n                element.data('keditor', instance);\n            }\n\n            return instance;\n        }\n    };\n    $.fn.keditor.constructor = KEditor;\n\n    // KEditor instances\n    KEditor.instances = {};\n\n    // Turn on/off debug mode\n    KEditor.debug = false;\n\n    // Version of KEditor\n    KEditor.version = '@{version}';\n\n    // Component types\n    KEditor.components = {\n        blank: {\n            settingEnabled: false\n        }\n    };\n\n    // Export default configuration\n    KEditor.DEFAULTS = DEFAULTS;\n\n    // Export log methods;\n    KEditor.log = flog;\n    KEditor.error = error;\n\n    // Export KEditor\n    window.KEditor = $.keditor = KEditor;\n})(window, jQuery);"]}