{"version":3,"sources":["keditor.js"],"names":["_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","window","$","flog","_len","arguments","args","_key","console","log","KEditor","debug","apply","concat","error","message","Error","fn","sortable","DEFAULTS","nestedContainerEnabled","explicitSnippetEnabled","containerForQuickAddComponent","btnAddContentText","btnAddContainerText","btnAddSubContainerText","btnAddComponentText","btnMoveContainerText","btnMoveComponentText","btnSettingContainerText","btnSettingComponentText","btnDuplicateContainerText","btnDuplicateComponentText","btnDeleteContainerText","btnDeleteComponentText","defaultComponentType","snippetsUrl","snippetsFilterEnabled","snippetsCategoriesSeparator","iframeMode","contentStyles","contentAreasSelector","contentAreasWrapper","containerSettingEnabled","containerSettingInitFunction","containerSettingShowFunction","containerSettingHideFunction","onReady","onSnippetsLoaded","modal","onSnippetsError","onInitIframe","iframe","iframeHead","iframeBody","onContentChanged","event","contentArea","onBeforeInitContentArea","onInitContentArea","onBeforeInitContainer","container","onInitContainer","onBeforeContainerDeleted","selectedContainer","onContainerDeleted","onContainerChanged","changedContainer","onContainerDuplicated","originalContainer","newContainer","onContainerSelected","onContainerSnippetAdded","selectedSnippet","onComponentReady","component","onBeforeInitComponent","onInitComponent","onBeforeComponentDeleted","selectedComponent","onComponentDeleted","onComponentChanged","changedComponent","onComponentDuplicated","originalComponent","newComponent","onComponentSelected","onComponentSnippetAdded","onBeforeDynamicContentLoad","dynamicElement","onDynamicContentLoaded","response","status","xhr","onDynamicContentError","TOOLBAR_TYPE","CONTENT_AREA","CONTAINER","SUB_CONTAINER","CONTAINER_CONTENT","SUB_CONTAINER_CONTENT","COMPONENT","SNIPPET_TYPE","ALL","config","this","self","element","options","extend","initIframe","body","document","originalContent","val","html","generateContentAreasWrapper","is","after","addClass","empty","append","initSidebar","initSnippetsModal","initContentAreas","hasClass","initKEditorClicks","id","generateId","instances","call","value","type","undefined","timestamp","Date","getTime","random","Math","round","content","attr","isComponentConfigurable","settingBtn","toolbarClass","categories","newArray","category","inArray","push","sort","settingContainer","settingComponent","ignoreAttributes","dataAttributes","each","get","attributes","name","indexOf","componentType","replace","components","selector","closest","wrapper","iframeWrapper","iframeDoc","contents","open","close","contentWindow","contentDocument","defaultView","find","styles","style","href","idStr","on","e","sidebar","getClickedElement","removeClass","parent","_contentArea","preventDefault","btn","closeSidebar","openSidebar","getContainerContent","convertToContainer","confirm","settingComponentParent","deleteComponent","remove","getComponentContent","convertToComponent","sidebarId","sidebarBody","form","appendTo","sidebarTitle","activeForm","children","setSettingComponent","setSettingContainer","getComponentType","componentData","settingTitle","settingForm","_componentData","initSettingForm","loadingText","initFunction","when","done","setTimeout","showSettingForm","_settingForm","activeType","hideSettingForm","modalId","snippetsWrapperHtml","ajax","dataType","url","success","resp","renderSnippets","initSnippetsFilter","jqXHR","closeModal","modalTarget","snippetType","snippetContentElement","snippetContent","isAddingContainer","isAddingComponent","isAddingComponentWithContainer","modalSnippetType","initContainer","getDataAttributes","join","initComponent","_dataAttributes","eq","snippet","cssTransitionEnd","css","snippetsContainerHtml","snippetsComponentHtml","snippetsContentHtml","snippetsCategories","snippetsContainerCategories","snippetsComponentCategories","filter","snippetId","trim","previewUrl","title","snippetHtml","split","beautifyCategories","snippetsWrapperSelector","categoriesOptions","snippetsWrapper","snippets","prepend","filterCategories","toLowerCase","data","txtSearch","cbbFilter","doFilter","selectedCategory","searchText","dataCategories","dataCategoriesString","timer","clearTimeout","modalTitle","modalAction","contentAreas","initContentArea","dontInitToolbar","contentAreaToolbar","generateToolbar","openModal","handle","items","helper","connectWith","axis","tolerance","receive","ui","item","start","stop","over","out","contentData","wrapInner","wrap","isNested","containerContents","containerContent","parents","initContainerContent","containerContentInner","containerContentToolbar","child","isExisting","isSection","componentContent","settingEnabled","initDynamicContent","init","dynamicHref","param","destroy","clonedComponent","clone","getContent","containerInner","not","removeAttr","result","jquery","keditor","slice","constructor","version","blank","jQuery"],"mappings":"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","file":"keditor.min.js","sourcesContent":["'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (window, $) {\n    // Log function will print log message\n    var flog = function flog() {\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        if (console && typeof console.log === 'function' && KEditor.debug === true) {\n            console.log.apply(console, ['[ KEditor ] '].concat(args));\n        }\n    };\n\n    // Throw error message\n    var error = function error(message) {\n        throw new Error('[ KEditor ] ' + message);\n    };\n\n    // Check dependencies\n    if (!$.fn.sortable) {\n        error('$.fn.sortable does not exist. Please import $.fn.sortable into your document for continue using KEditor.');\n    }\n\n    var DEFAULTS = {\n        nestedContainerEnabled: true,\n\n        explicitSnippetEnabled: false,\n        containerForQuickAddComponent: '\\n            <div class=\"row\">\\n                <div class=\"col-sm-12\" data-type=\"container-content\">\\n                </div>\\n            </div>\\n        ',\n        btnAddContentText: '<i class=\"fa fa-plus\"></i>',\n        btnAddContainerText: '<i class=\"fa fa-plus\"></i> <i class=\"fa fa-fw fa-columns\"></i>',\n        btnAddSubContainerText: '<i class=\"fa fa-plus\"></i> <i class=\"fa fa-fw fa-columns\"></i>',\n        btnAddComponentText: '<i class=\"fa fa-plus\"></i> <i class=\"fa fa-fw fa-list-ul\"></i>',\n\n        btnMoveContainerText: '<i class=\"fa fa-sort\"></i>',\n        btnMoveComponentText: '<i class=\"fa fa-arrows\"></i>',\n\n        btnSettingContainerText: '<i class=\"fa fa-cog\"></i>',\n        btnSettingComponentText: '<i class=\"fa fa-cog\"></i>',\n\n        btnDuplicateContainerText: '<i class=\"fa fa-files-o\"></i>',\n        btnDuplicateComponentText: '<i class=\"fa fa-files-o\"></i>',\n\n        btnDeleteContainerText: '<i class=\"fa fa-times\"></i>',\n        btnDeleteComponentText: '<i class=\"fa fa-times\"></i>',\n\n        defaultComponentType: 'blank',\n\n        snippetsUrl: 'snippets/snippets.html',\n        snippetsFilterEnabled: true,\n        snippetsCategoriesSeparator: ';',\n\n        iframeMode: false,\n        contentStyles: [],\n\n        contentAreasSelector: null,\n        contentAreasWrapper: '<div class=\"keditor-ui keditor-content-areas-wrapper\"></div>',\n\n        containerSettingEnabled: false,\n        containerSettingInitFunction: null,\n        containerSettingShowFunction: null,\n        containerSettingHideFunction: null,\n\n        onReady: function onReady() {},\n\n        onSnippetsLoaded: function onSnippetsLoaded(modal) {},\n        onSnippetsError: function onSnippetsError(modal, error) {},\n\n        onInitIframe: function onInitIframe(iframe, iframeHead, iframeBody) {},\n\n        onContentChanged: function onContentChanged(event, contentArea) {},\n\n        onBeforeInitContentArea: function onBeforeInitContentArea(contentArea) {},\n        onInitContentArea: function onInitContentArea(contentArea) {},\n\n        onBeforeInitContainer: function onBeforeInitContainer(container, contentArea) {},\n        onInitContainer: function onInitContainer(container, contentArea) {},\n        onBeforeContainerDeleted: function onBeforeContainerDeleted(event, selectedContainer, contentArea) {},\n        onContainerDeleted: function onContainerDeleted(event, selectedContainer, contentArea) {},\n        onContainerChanged: function onContainerChanged(event, changedContainer, contentArea) {},\n        onContainerDuplicated: function onContainerDuplicated(event, originalContainer, newContainer, contentArea) {},\n        onContainerSelected: function onContainerSelected(event, selectedContainer, contentArea) {},\n        onContainerSnippetAdded: function onContainerSnippetAdded(event, newContainer, selectedSnippet, contentArea) {},\n\n        onComponentReady: function onComponentReady(component) {},\n        onBeforeInitComponent: function onBeforeInitComponent(component, contentArea) {},\n        onInitComponent: function onInitComponent(component, contentArea) {},\n        onBeforeComponentDeleted: function onBeforeComponentDeleted(event, selectedComponent, contentArea) {},\n        onComponentDeleted: function onComponentDeleted(event, selectedComponent, contentArea) {},\n        onComponentChanged: function onComponentChanged(event, changedComponent, contentArea) {},\n        onComponentDuplicated: function onComponentDuplicated(event, originalComponent, newComponent, contentArea) {},\n        onComponentSelected: function onComponentSelected(event, selectedComponent, contentArea) {},\n        onComponentSnippetAdded: function onComponentSnippetAdded(event, newComponent, selectedSnippet, contentArea) {},\n\n        onBeforeDynamicContentLoad: function onBeforeDynamicContentLoad(dynamicElement, component, contentArea) {},\n        onDynamicContentLoaded: function onDynamicContentLoaded(dynamicElement, response, status, xhr, contentArea) {},\n        onDynamicContentError: function onDynamicContentError(dynamicElement, response, status, xhr, contentArea) {}\n    };\n\n    var MODAL_ACTION = {\n        ADD_ALL: 0,\n        ADD_CONTAINER: 1,\n        ADD_SUB_CONTAINER: 2,\n        ADD_COMPONENT: 3\n    };\n\n    var TOOLBAR_TYPE = {\n        CONTENT_AREA: 0,\n        CONTAINER: 1,\n        SUB_CONTAINER: 2,\n        CONTAINER_CONTENT: 3,\n        SUB_CONTAINER_CONTENT: 4,\n        COMPONENT: 5\n    };\n\n    var SNIPPET_TYPE = {\n        ALL: 0,\n        CONTAINER: 1,\n        COMPONENT: 2\n    };\n\n    // KEditor class\n\n    var KEditor = function () {\n        function KEditor(target, config) {\n            _classCallCheck(this, KEditor);\n\n            var self = this;\n            var element = self.element = target;\n            var options = self.options = $.extend({}, DEFAULTS, config);\n\n            if (options.iframeMode) {\n                self.initIframe();\n            } else {\n                self.window = window;\n                self.body = $(document.body);\n\n                var originalContent = element.val() || element.html() || '';\n                var contentAreasWrapper = self.generateContentAreasWrapper(originalContent);\n\n                if (element.is('textarea')) {\n                    element.after(contentAreasWrapper);\n                    element.addClass('keditor-hidden-element');\n                } else {\n                    element.empty().append(contentAreasWrapper);\n                }\n\n                self.contentAreasWrapper = contentAreasWrapper;\n            }\n\n            self.initSidebar();\n            self.initSnippetsModal();\n            self.initContentAreas();\n\n            if (!self.body.hasClass('keditor-clicks-initialized')) {\n                self.initKEditorClicks();\n            }\n\n            self.id = self.generateId();\n            KEditor.instances[self.id] = self;\n\n            if (typeof options.onReady === 'function') {\n                options.onReady.call(self);\n            }\n        }\n\n        // Utils\n        //---------------------------------\n\n\n        _createClass(KEditor, [{\n            key: 'generateId',\n            value: function generateId() {\n                var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n                var timestamp = new Date().getTime();\n                var random = Math.round(Math.random() * 9876543210);\n                return 'keditor-' + type + '-' + timestamp + random;\n            }\n        }, {\n            key: 'generateContentAreasWrapper',\n            value: function generateContentAreasWrapper(content) {\n                var self = this;\n                var options = self.options;\n\n                var contentAreasWrapper = $(options.contentAreasWrapper || '<div />');\n                contentAreasWrapper.attr('class', 'keditor-ui keditor-content-area-wrapper');\n\n                if (!contentAreasWrapper.attr('id')) {\n                    contentAreasWrapper.attr('id', self.generateId('content-area-wrapper'));\n                }\n\n                contentAreasWrapper.html(content);\n\n                return contentAreasWrapper;\n            }\n        }, {\n            key: 'generateToolbar',\n            value: function generateToolbar(type, isComponentConfigurable) {\n                var self = this;\n                var options = self.options;\n                var settingBtn = '';\n\n                if (!options.explicitSnippetEnabled) {\n                    var toolbarClass = '';\n\n                    switch (type) {\n                        case TOOLBAR_TYPE.CONTENT_AREA:\n                            toolbarClass = 'keditor-content-area-toolbar';\n\n                        case TOOLBAR_TYPE.CONTAINER_CONTENT:\n                        case TOOLBAR_TYPE.SUB_CONTAINER_CONTENT:\n                            toolbarClass = 'keditor-container-content-toolbar';\n\n                            return '\\n                            <div class=\"keditor-ui ' + toolbarClass + '\">\\n                                <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-content\" title=\"Add content\">' + options.btnAddContentText + '</a>\\n                            </div>\\n                        ';\n\n                        default:\n                        // Do nothing\n                    }\n                }\n\n                switch (type) {\n                    case TOOLBAR_TYPE.CONTENT_AREA:\n                        return '\\n                        <div class=\"keditor-ui keditor-content-area-toolbar\">\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-container\" title=\"Add container\">' + options.btnAddContainerText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.CONTAINER:\n                        if (options.containerSettingEnabled === true) {\n                            settingBtn = '<a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-setting\">' + options.btnSettingContainerText + '</a>';\n                        }\n\n                        return '\\n                        <div class=\"keditor-toolbar keditor-toolbar-container\">\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-reposition\">' + options.btnMoveContainerText + '</a>\\n                            ' + settingBtn + '\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-duplicate\">' + options.btnDuplicateContainerText + '</a>\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-delete\">' + options.btnDeleteContainerText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.SUB_CONTAINER:\n                        if (options.containerSettingEnabled === true) {\n                            settingBtn = '<a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-setting\">' + options.btnSettingContainerText + '</a>';\n                        }\n\n                        return '\\n                        <div class=\"keditor-toolbar keditor-toolbar-container keditor-toolbar-sub-container\">\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-reposition\">' + options.btnMoveContainerText + '</a>\\n                            ' + settingBtn + '\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-duplicate\">' + options.btnDuplicateContainerText + '</a>\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-container-delete\">' + options.btnDeleteContainerText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.CONTAINER_CONTENT:\n                        return '\\n                        <div class=\"keditor-ui keditor-container-content-toolbar keditor-btn-group\">\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-container\" title=\"Add sub-container\">' + options.btnAddSubContainerText + '</a>\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-component\" title=\"Add component\">' + options.btnAddComponentText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.SUB_CONTAINER_CONTENT:\n                        return '\\n                        <div class=\"keditor-ui keditor-container-content-toolbar\">\\n                            <a href=\"javascript:void(0)\" class=\"keditor-ui keditor-btn keditor-btn-default btn-add-component\" title=\"Add component\">' + options.btnAddComponentText + '</a>\\n                        </div>\\n                    ';\n\n                    case TOOLBAR_TYPE.COMPONENT:\n                        if (isComponentConfigurable) {\n                            settingBtn = '<a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-setting\">' + options.btnSettingComponentText + '</a>';\n                        }\n\n                        return '\\n                        <div class=\"keditor-toolbar keditor-toolbar-component\">\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-reposition\">' + options.btnMoveComponentText + '</a>\\n                            ' + settingBtn + '\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-duplicate\">' + options.btnDuplicateComponentText + '</a>\\n                            <a href=\"javascript:void(0);\" class=\"keditor-ui btn-component-delete\">' + options.btnDeleteComponentText + '</a>\\n                        </div>\\n                    ';\n\n                    default:\n                    // Do nothing\n                }\n            }\n        }, {\n            key: 'beautifyCategories',\n            value: function beautifyCategories(categories) {\n                var newArray = [];\n                for (var i = 0; i < categories.length; i++) {\n                    var category = categories[i] || '';\n\n                    if (category !== '' && $.inArray(category, newArray) === -1) {\n                        newArray.push(category);\n                    }\n                }\n\n                return newArray.sort();\n            }\n        }, {\n            key: 'setSettingContainer',\n            value: function setSettingContainer(container) {\n                this.settingContainer = container;\n            }\n        }, {\n            key: 'getSettingContainer',\n            value: function getSettingContainer() {\n                return this.settingContainer;\n            }\n        }, {\n            key: 'setSettingComponent',\n            value: function setSettingComponent(component) {\n                this.settingComponent = component;\n            }\n        }, {\n            key: 'getSettingComponent',\n            value: function getSettingComponent() {\n                return this.settingComponent;\n            }\n        }, {\n            key: 'getDataAttributes',\n            value: function getDataAttributes(target, ignoreAttributes, isArray) {\n                var dataAttributes = isArray ? [] : {};\n                if (!ignoreAttributes) {\n                    ignoreAttributes = [];\n                }\n\n                $.each(target.get(0).attributes, function (i, attr) {\n                    if (attr.name.indexOf('data-') === 0 && $.inArray(attr.name, ignoreAttributes) === -1) {\n                        if (isArray) {\n                            dataAttributes.push(attr.name + '=\"' + attr.value + '\"');\n                        } else {\n                            dataAttributes[attr.name] = attr.value;\n                        }\n                    }\n                });\n\n                return dataAttributes;\n            }\n        }, {\n            key: 'getComponentType',\n            value: function getComponentType(component) {\n                var self = this;\n                var options = self.options;\n\n                var componentType = (component.attr('data-type') || '').replace('component-', '');\n                if (componentType && componentType in KEditor.components) {\n                    return componentType;\n                } else {\n                    if (typeof options.defaultComponentType === 'string') {\n                        componentType = options.defaultComponentType;\n                    } else if (typeof options.defaultComponentType === 'function') {\n                        componentType = options.defaultComponentType.call(self, component);\n                    }\n\n                    if (!componentType) {\n                        error('Component type is undefined!');\n                    }\n\n                    flog('Fallback to defaultComponentType: ' + componentType);\n                    return componentType;\n                }\n            }\n        }, {\n            key: 'getClickedElement',\n            value: function getClickedElement(event, selector) {\n                var target = $(event.target);\n                var closest = target.closest(selector);\n\n                if (target.is(selector)) {\n                    return target;\n                } else if (closest.length > 0) {\n                    return closest;\n                } else {\n                    return null;\n                }\n            }\n\n            // Iframe\n            //---------------------------------\n\n        }, {\n            key: 'initIframe',\n            value: function initIframe() {\n                flog('initIframe');\n\n                var self = this;\n                var options = self.options;\n                var element = self.element;\n                var originalContent = element.is('textarea') ? element.val() : element.html();\n                var wrapper = self.iframeWrapper = $('<div class=\"keditor-ui keditor-iframe-wrapper\"></div>');\n                var iframe = self.iframe = $('<iframe class=\"keditor-ui keditor-iframe\"></iframe>');\n\n                element.after(wrapper);\n                wrapper.attr('id', self.generateId('iframe-wrapper')).append(iframe);\n                element.addClass('keditor-hidden-element');\n\n                var iframeDoc = self.iframeDoc = iframe.contents();\n\n                // Fix issue Firefox can't render content inside iframe\n                // ======================================================\n                iframeDoc.get(0).open();\n                iframeDoc.get(0).close();\n                // ======================================================\n\n                self.window = iframe[0].contentWindow ? iframe[0].contentWindow : iframe[0].contentDocument.defaultView;\n                var iframeHead = self.iframeHead = iframeDoc.find('head');\n                var iframeBody = self.iframeBody = self.body = iframeDoc.find('body');\n\n                flog('Adding styles to iframe...');\n                var styles = '';\n                $('[data-type=\"keditor-style\"]').each(function () {\n                    var style = $(this);\n                    var href = style.attr('href') || style.attr('data-href') || '';\n\n                    if (href) {\n                        styles += '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + href + '\" />\\n';\n                    } else {\n                        styles += '<style type=\"text/css\">' + style.html() + '</style>\\n';\n                    }\n                });\n\n                if (options.contentStyles && $.isArray(options.contentStyles)) {\n                    $.each(options.contentStyles, function (i, style) {\n                        var idStr = '';\n                        if (style.id) {\n                            idStr = ' id=\"' + style.id + '\" ';\n                        }\n\n                        if (style.href) {\n                            styles += '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + style.href + '\" ' + idStr + ' />\\n';\n                        } else {\n                            styles += '<style type=\"text/css\" ' + idStr + '>' + style.content + '</style>\\n';\n                        }\n                    });\n                }\n\n                iframeHead.append(styles);\n\n                flog('Adding original content to iframe...');\n                var contentAreasWrapper = self.generateContentAreasWrapper(originalContent);\n                iframeBody.append(contentAreasWrapper);\n                self.contentAreasWrapper = contentAreasWrapper;\n\n                if (typeof options.onInitIframe === 'function') {\n                    options.onInitIframe.call(self, iframe, iframeHead, iframeBody);\n                }\n            }\n\n            // KEditor clicks\n            //---------------------------------\n\n        }, {\n            key: 'initKEditorClicks',\n            value: function initKEditorClicks() {\n                flog('initKEditorClicks');\n\n                var self = this;\n                var options = self.options;\n                var body = self.body;\n\n                body.on('click', function (e) {\n                    var sidebar = self.getClickedElement(e, '.keditor-sidebar');\n                    var modal = self.getClickedElement(e, '.keditor-modal');\n\n                    var container = self.getClickedElement(e, '.keditor-container');\n                    if (container) {\n                        if (!container.hasClass('showed-keditor-toolbar')) {\n                            body.find('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            container.addClass('showed-keditor-toolbar');\n\n                            var contentArea = container.parent();\n                            if (typeof options.onContainerSelected === 'function') {\n                                options.onContainerSelected.call(self, e, container, contentArea);\n                            }\n                        }\n                    } else {\n                        if (!sidebar && !modal) {\n                            body.find('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                        }\n                    }\n\n                    var component = self.getClickedElement(e, '.keditor-component');\n                    if (component) {\n                        if (!component.hasClass('showed-keditor-toolbar')) {\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            component.addClass('showed-keditor-toolbar');\n\n                            var _contentArea = component.parent();\n                            if (typeof options.onComponentSelected === 'function') {\n                                options.onComponentSelected.call(self, e, component, _contentArea);\n                            }\n                        }\n                    } else {\n                        if (!sidebar) {\n                            body.find('.keditor-component.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                        }\n                    }\n                });\n\n                body.on('click', '.btn-container-setting', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-container-setting', btn);\n\n                    var container = btn.closest('.keditor-container');\n                    if (body.hasClass('opened-keditor-setting') && body.hasClass('opened-keditor-sidebar')) {\n                        if (!container.is(self.settingContainer)) {\n                            self.openSidebar(container);\n                        } else {\n                            self.closeSidebar();\n                        }\n                    } else {\n                        self.openSidebar(container);\n                    }\n                });\n\n                body.on('click', '.btn-container-duplicate', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-container-duplicate', btn);\n\n                    var container = btn.closest('.keditor-container');\n                    var contentArea = container.parent();\n                    var newContainer = $(self.getContainerContent(container, btn.parent().hasClass('keditor-toolbar-sub-container')));\n                    container.after(newContainer);\n                    self.convertToContainer(contentArea, newContainer);\n\n                    flog('Container is duplicated');\n\n                    if (typeof options.onContainerDuplicated === 'function') {\n                        options.onContainerDuplicated.call(self, container, newContainer, contentArea);\n                    }\n\n                    if (typeof options.onContentChanged === 'function') {\n                        options.onContentChanged.call(self, e, contentArea);\n                    }\n                });\n\n                body.on('click', '.btn-container-delete', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-container-delete', btn);\n\n                    if (confirm('Are you sure that you want to delete this container? This action can not be undo!')) {\n                        var container = btn.closest('.keditor-container');\n                        var components = container.find('.keditor-component');\n                        var contentArea = container.parent();\n\n                        if (typeof options.onBeforeContainerDeleted === 'function') {\n                            options.onBeforeContainerDeleted.call(self, e, container, contentArea);\n                        }\n\n                        var settingComponent = self.settingComponent;\n                        if (settingComponent) {\n                            var settingComponentParent = settingComponent.closest('.keditor-container');\n                            if (settingComponentParent.is(container)) {\n                                flog('Deleting container is container of setting container. Close setting panel for this setting component', settingComponent);\n                                self.closeSidebar();\n                            }\n                        } else if (container.is(self.settingContainer)) {\n                            flog('Deleting container is setting container. Close setting panel for this container', container);\n                            self.closeSidebar();\n                        }\n\n                        if (components.length > 0) {\n                            components.each(function () {\n                                self.deleteComponent($(this));\n                            });\n                        }\n\n                        container.remove();\n\n                        if (typeof options.onContainerDeleted === 'function') {\n                            options.onContainerDeleted.call(self, e, container, contentArea);\n                        }\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, e, contentArea);\n                        }\n                    }\n                });\n\n                body.on('click', '.btn-component-setting', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-component-setting', btn);\n\n                    var component = btn.closest('.keditor-component');\n                    if (body.hasClass('opened-keditor-setting') && body.hasClass('opened-keditor-sidebar')) {\n                        if (!component.is(self.settingComponent())) {\n                            self.openSidebar(component);\n                        } else {\n                            self.closeSidebar();\n                        }\n                    } else {\n                        self.openSidebar(component);\n                    }\n                });\n\n                body.on('click', '.btn-component-duplicate', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-component-duplicate', btn);\n\n                    var component = btn.closest('.keditor-component');\n                    var container = component.closest('.keditor-container');\n                    var contentArea = container.parent();\n                    var newComponent = $(self.getComponentContent(component));\n\n                    component.after(newComponent);\n                    self.convertToComponent(contentArea, container, newComponent);\n\n                    flog('Component is duplicated');\n\n                    if (typeof options.onComponentDuplicated === 'function') {\n                        options.onComponentDuplicated.call(self, component, newComponent, contentArea);\n                    }\n\n                    if (typeof options.onContainerChanged === 'function') {\n                        options.onContainerChanged.call(self, e, container, contentArea);\n                    }\n\n                    if (typeof options.onContentChanged === 'function') {\n                        options.onContentChanged.call(self, e, contentArea);\n                    }\n                });\n\n                body.on('click', '.btn-component-delete', function (e) {\n                    e.preventDefault();\n\n                    var btn = $(this);\n                    flog('Click on .btn-component-delete', btn);\n\n                    if (confirm('Are you sure that you want to delete this component? This action can not be undo!')) {\n                        var component = btn.closest('.keditor-component');\n                        var container = component.closest('.keditor-container');\n                        var contentArea = component.closest('.keditor-content-area');\n\n                        if (typeof options.onBeforeComponentDeleted === 'function') {\n                            options.onBeforeComponentDeleted.call(self, e, component, contentArea);\n                        }\n\n                        if (component.is(self.settingComponent)) {\n                            self.closeSidebar();\n                        }\n\n                        self.deleteComponent(component);\n\n                        if (typeof options.onComponentDeleted === 'function') {\n                            options.onComponentDeleted.call(self, e, component, contentArea);\n                        }\n\n                        if (typeof options.onContainerChanged === 'function') {\n                            options.onContainerChanged.call(self, e, container, contentArea);\n                        }\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, e, contentArea);\n                        }\n                    }\n                });\n\n                body.addClass('keditor-clicks-initialized');\n            }\n\n            // Sidebar\n            //---------------------------------\n\n        }, {\n            key: 'initSidebar',\n            value: function initSidebar() {\n                var self = this;\n                var options = self.options;\n                var sidebarId = self.generateId('sidebar');\n\n                var sidebar = self.sidebar = $('\\n                <div class=\"keditor-ui keditor-sidebar\" id=\"' + sidebarId + '\">                    \\n                    <div class=\"keditor-ui keditor-sidebar-header\">\\n                        <span class=\"keditor-ui keditor-sidebar-title\"></span>\\n                        <a href=\"javascript:void(0);\" class=\"keditor-ui keditor-sidebar-close\">&times;</a>\\n                    </div>\\n                    <div class=\"keditor-ui keditor-sidebar-body\"></div>\\n                </div>\\n            ');\n\n                sidebar.find('.keditor-sidebar-close').on('click', function (e) {\n                    e.preventDefault();\n\n                    self.closeSidebar();\n                });\n\n                var sidebarBody = sidebar.find('.keditor-sidebar-body');\n                sidebarBody.on('submit', 'form', function (e) {\n                    e.preventDefault();\n                    return false;\n                });\n\n                if (options.containerSettingEnabled === true) {\n                    if (typeof options.containerSettingInitFunction === 'function') {\n\n                        var form = $('<div  class=\"keditor-ui keditor-setting-form keditor-container-setting\"></div>');\n                        sidebarBody.append(form);\n\n                        flog('Initialize container setting panel');\n                        options.containerSettingInitFunction.call(self, form, self);\n                    } else {\n                        error('\"containerSettingInitFunction\" is not function!');\n                    }\n                }\n\n                sidebar.appendTo(options.iframeMode ? self.iframeWrapper : self.body);\n            }\n        }, {\n            key: 'openSidebar',\n            value: function openSidebar(target) {\n                var self = this;\n                var options = self.options;\n                var sidebar = self.sidebar;\n                var sidebarTitle = sidebar.find('.keditor-sidebar-title');\n                var sidebarBody = sidebar.find('.keditor-sidebar-body');\n                var activeForm = sidebarBody.children('.active');\n                activeForm.removeClass('active');\n\n                if (target.is('.keditor-component')) {\n                    self.setSettingComponent(target);\n                    self.setSettingContainer(null);\n\n                    var componentType = self.getComponentType(target);\n                    var componentData = KEditor.components[componentType];\n                    sidebarTitle.html(componentData.settingTitle);\n\n                    var settingForm = sidebarBody.find('.keditor-setting-' + componentType);\n\n                    if (settingForm.length === 0) {\n                        var _componentData = KEditor.components[componentType];\n                        if (typeof _componentData.initSettingForm === 'function') {\n                            settingForm = $('\\n                            <div \\n                                data-type=\"' + componentType + '\" \\n                                class=\"keditor-ui keditor-setting-form keditor-setting-' + componentType + ' clearfix active\"\\n                            >\\n                            </div>\\n                        ');\n                            var loadingText = $('<span />').html('Loading...');\n                            sidebarBody.append(settingForm);\n                            settingForm.append(loadingText);\n\n                            var initFunction = _componentData.initSettingForm.call(_componentData, settingForm, self);\n                            $.when(initFunction).done(function () {\n                                flog('Initialized setting form for component type \"' + componentType + '\"');\n\n                                setTimeout(function () {\n                                    loadingText.remove();\n\n                                    if (typeof _componentData.showSettingForm === 'function') {\n                                        _componentData.showSettingForm.call(_componentData, settingForm, target, self);\n                                    }\n                                }, 100);\n                            });\n                        }\n                    } else {\n                        if (typeof componentData.showSettingForm === 'function') {\n                            componentData.showSettingForm.call(componentData, settingForm, target, self);\n                        }\n                        settingForm.addClass('active');\n                    }\n                } else {\n                    self.setSettingContainer(target);\n                    self.setSettingComponent(null);\n\n                    sidebarTitle.html('Container Settings');\n\n                    var _settingForm = sidebar.find('.keditor-container-setting');\n                    if (typeof options.containerSettingShowFunction === 'function') {\n                        options.containerSettingShowFunction.call(self, _settingForm, target, self);\n                    }\n                    _settingForm.addClass('active');\n                }\n\n                sidebar.addClass('opened');\n            }\n        }, {\n            key: 'closeSidebar',\n            value: function closeSidebar() {\n                var self = this;\n                var options = self.options;\n                var sidebar = self.sidebar;\n                var activeForm = sidebar.find('.keditor-sidebar-body').children('.active');\n\n                if (activeForm.length > 0) {\n                    if (activeForm.is('.keditor-container-setting')) {\n                        if (typeof options.containerSettingHideFunction === 'function') {\n                            options.containerSettingHideFunction.call(self, activeForm, self);\n                        }\n                    } else {\n                        var activeType = activeForm.attr('data-type');\n                        var componentData = KEditor.components[activeType];\n\n                        if (typeof componentData.hideSettingForm === 'function') {\n                            componentData.hideSettingForm.call(componentData, activeForm, self);\n                        }\n                    }\n\n                    activeForm.removeClass('active');\n                }\n\n                self.setSettingComponent(null);\n                self.setSettingContainer(null);\n                sidebar.removeClass('opened');\n            }\n\n            // Legacy methods. DEPRECATED\n            //---------------------------------\n\n        }, {\n            key: 'showSettingPanel',\n            value: function showSettingPanel(target) {\n                this.openSidebar(target);\n            }\n        }, {\n            key: 'hideSettingPanel',\n            value: function hideSettingPanel() {\n                this.closeSidebar();\n            }\n\n            // Snippet modal\n            //---------------------------------\n\n        }, {\n            key: 'initSnippetsModal',\n            value: function initSnippetsModal() {\n                var self = this;\n                var options = self.options;\n                var modalId = self.generateId('modal');\n                var snippetsWrapperHtml = '';\n\n                if (options.explicitSnippetEnabled) {\n                    snippetsWrapperHtml = '\\n                    <div class=\"keditor-snippets-wrapper keditor-snippets-wrapper-container\">\\n                        <div class=\"keditor-snippets keditor-snippets-container\"></div>\\n                    </div>\\n                    <div class=\"keditor-snippets-wrapper keditor-snippets-wrapper-component\">\\n                        <div class=\"keditor-snippets keditor-snippets-component\"></div>\\n                    </div>\\n                ';\n                } else {\n                    snippetsWrapperHtml = '\\n                    <div class=\"keditor-snippets-wrapper\">\\n                        <div class=\"keditor-snippets\"></div>\\n                    </div>\\n                ';\n                }\n\n                var modal = self.modal = $('\\n                <div class=\"keditor-ui keditor-modal\" id=\"' + modalId + '\">\\n                    <div class=\"keditor-modal-header\">\\n                        <button type=\"button\" class=\"keditor-modal-close\">&times;</button>\\n                        <h4 class=\"keditor-modal-title\"></h4>\\n                    </div>\\n                    <div class=\"keditor-modal-body\">' + snippetsWrapperHtml + '</div>\\n                    <div class=\"keditor-modal-footer\">\\n                        <button type=\"button\" class=\"keditor-ui keditor-btn keditor-btn-default keditor-modal-close\">Close</button>\\n                        <button type=\"button\" class=\"keditor-ui keditor-btn keditor-btn-primary keditor-modal-add\">Add</button>\\n                    </div>\\n                </div>\\n            ');\n\n                if (typeof options.snippetsUrl === 'string' && options.snippetsUrl.length > 0) {\n                    flog('Getting snippets form \"' + options.snippetsUrl + '\"...');\n\n                    $.ajax({\n                        type: 'get',\n                        dataType: 'html',\n                        url: options.snippetsUrl,\n                        success: function success(resp) {\n                            flog('Success in getting snippets');\n\n                            if (typeof options.onSnippetsLoaded === 'function') {\n                                resp = options.onSnippetsLoaded.call(self, resp) || resp;\n                            }\n\n                            self.renderSnippets(resp);\n\n                            if (options.snippetsFilterEnabled) {\n                                if (options.explicitSnippetEnabled) {\n                                    self.initSnippetsFilter(SNIPPET_TYPE.CONTAINER);\n                                    self.initSnippetsFilter(SNIPPET_TYPE.COMPONENT);\n                                } else {\n                                    self.initSnippetsFilter(SNIPPET_TYPE.ALL);\n                                }\n                            }\n                        },\n                        error: function error(jqXHR) {\n                            flog('Error when getting snippets', jqXHR);\n                            if (typeof options.onSnippetsError === 'function') {\n                                options.onSnippetsError.call(self, jqXHR);\n                            }\n                        }\n                    });\n\n                    // Close buttons\n                    modal.find('.keditor-modal-close').on('click', function (e) {\n                        e.preventDefault();\n\n                        self.closeModal();\n                    });\n\n                    // Add button\n                    modal.find('.keditor-modal-add').on('click', function (e) {\n                        e.preventDefault();\n\n                        var selectedSnippet = modal.find('.keditor-snippets-wrapper .selected');\n                        if (selectedSnippet.length === 0) {\n                            return;\n                        }\n\n                        var contentArea = self.modalTarget.closest('.keditor-content-area');\n                        var snippetType = selectedSnippet.attr('data-type');\n                        var snippetContentElement = modal.find(selectedSnippet.attr('data-snippet'));\n                        var snippetContent = snippetContentElement.html();\n                        var isAddingContainer = false;\n                        var isAddingComponent = false;\n                        var isAddingComponentWithContainer = false;\n\n                        if (options.explicitSnippetEnabled) {\n                            switch (self.modalSnippetType) {\n                                case SNIPPET_TYPE.COMPONENT:\n                                    isAddingComponent = true;\n                                    break;\n\n                                case SNIPPET_TYPE.CONTAINER:\n                                    isAddingContainer = true;\n                                    break;\n\n                                default:\n                                // Do nothing\n                            }\n                        } else {\n                            if (snippetType === 'container') {\n                                isAddingContainer = true;\n                            } else {\n                                switch (self.modalSnippetType) {\n                                    case SNIPPET_TYPE.COMPONENT:\n                                        isAddingComponent = true;\n                                        break;\n\n                                    case SNIPPET_TYPE.ALL:\n                                        if (self.modalTarget.is('.keditor-container-content-inner')) {\n                                            isAddingComponent = true;\n                                        } else {\n                                            isAddingComponentWithContainer = true;\n                                        }\n\n                                        break;\n\n                                    default:\n                                    // Do nothing\n                                }\n                            }\n                        }\n\n                        var newContainer = void 0;\n                        var newComponent = void 0;\n\n                        if (isAddingContainer) {\n                            self.body.find('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n\n                            newContainer = $('\\n                            <section class=\"keditor-ui keditor-container showed-keditor-toolbar\">\\n                                <section class=\"keditor-ui keditor-container-inner\">' + snippetContent + '</section>\\n                            </section>\\n                        ');\n                            self.modalTarget.append(newContainer);\n\n                            if (typeof options.onContainerSnippetAdded === 'function') {\n                                options.onContainerSnippetAdded.call(self, e, newContainer, selectedSnippet, contentArea);\n                            }\n\n                            self.initContainer(contentArea, newContainer);\n                        }\n\n                        if (isAddingComponent) {\n                            var dataAttributes = self.getDataAttributes(snippetContentElement, null, true);\n                            newComponent = $('\\n                            <section class=\"keditor-ui keditor-component\" data-type=\"' + snippetType + '\" ' + dataAttributes.join(' ') + '>\\n                                <section class=\"keditor-ui keditor-component-content\">' + snippetContent + '</section>\\n                            </section>\\n                        ');\n                            self.modalTarget.append(newComponent);\n\n                            var container = self.modalTarget.closest('.keditor-container');\n                            if (typeof options.onComponentSnippetAdded === 'function') {\n                                options.onComponentSnippetAdded.call(self, e, newComponent, selectedSnippet, contentArea);\n                            }\n\n                            self.initComponent(contentArea, container, newComponent);\n                        }\n\n                        if (isAddingComponentWithContainer) {\n                            self.body.find('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n\n                            var _dataAttributes = self.getDataAttributes(snippetContentElement, null, true);\n                            newContainer = $('\\n                            <section class=\"keditor-ui keditor-container showed-keditor-toolbar\">\\n                                <section class=\"keditor-ui keditor-container-inner\">' + options.containerForQuickAddComponent + '</section>\\n                            </section>\\n                        ');\n                            newComponent = $('\\n                            <section class=\"keditor-ui keditor-component\" data-type=\"' + snippetType + '\" ' + _dataAttributes.join(' ') + '>\\n                                <section class=\"keditor-ui keditor-component-content\">' + snippetContent + '</section>\\n                            </section>\\n                        ');\n                            newContainer.find('[data-type=\"container-content\"]').eq(0).html(newComponent);\n                            self.modalTarget.append(newContainer);\n\n                            if (typeof options.onComponentSnippetAdded === 'function') {\n                                options.onComponentSnippetAdded.call(self, e, newComponent, selectedSnippet, contentArea);\n                            }\n\n                            self.initContainer(contentArea, newContainer);\n                        }\n\n                        self.closeModal();\n                    });\n\n                    // Action click for snippet\n                    modal.on('click', '.keditor-snippet', function (e) {\n                        e.preventDefault();\n\n                        var snippet = $(this);\n                        if (!snippet.hasClass('selected')) {\n                            snippet.parent().find('.selected').removeClass('selected');\n                            snippet.addClass('selected');\n                        }\n                    });\n\n                    var cssTransitionEnd = 'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend';\n                    modal.on(cssTransitionEnd, function () {\n                        if (!modal.hasClass('showed')) {\n                            modal.css('display', 'none');\n                            $(document.body).removeClass('opened-modal');\n                        }\n                    });\n\n                    modal.appendTo(document.body);\n                } else {\n                    error('\"snippetsUrl\" must be not null!');\n                }\n            }\n        }, {\n            key: 'renderSnippets',\n            value: function renderSnippets(resp) {\n                flog('renderSnippets');\n\n                var self = this;\n                var options = self.options;\n\n                var snippetsContainerHtml = '';\n                var snippetsComponentHtml = '';\n                var snippetsContentHtml = '';\n\n                self.snippetsCategories = [];\n                self.snippetsContainerCategories = [];\n                self.snippetsComponentCategories = [];\n\n                $(resp).filter('div').each(function (i) {\n                    var snippet = $(this);\n                    var snippetId = self.generateId('snippet');\n                    var content = snippet.html().trim();\n                    var previewUrl = snippet.attr('data-preview');\n                    var type = snippet.attr('data-type');\n                    var title = snippet.attr('data-keditor-title');\n                    var categories = snippet.attr('data-keditor-categories') || '';\n\n                    var snippetHtml = '\\n                    <section\\n                        class=\"keditor-ui keditor-snippet\"\\n                        data-snippet=\"#' + snippetId + '\"\\n                        data-type=\"' + type + '\"\\n                        title=\"' + title + '\"\\n                        data-keditor-categories=\"' + categories + '\"\\n                    >\\n                        <span><span style=\"background-image: url(\\'' + previewUrl + '\\')\"></span></span>   \\n                    </section>\\n                ';\n\n                    categories = categories.split(options.snippetsCategoriesSeparator);\n\n                    if (type === 'container') {\n                        snippetsContainerHtml += snippetHtml;\n                        self.snippetsContainerCategories = self.snippetsContainerCategories.concat(categories);\n                    } else if (type.indexOf('component') !== -1) {\n                        snippetsComponentHtml += snippetHtml;\n                        self.snippetsComponentCategories = self.snippetsComponentCategories.concat(categories);\n                    }\n\n                    var dataAttributes = self.getDataAttributes(snippet, ['data-preview', 'data-type', 'data-keditor-title', 'data-keditor-categories'], true);\n                    snippetsContentHtml += '<script id=\"' + snippetId + '\" type=\"text/html\" ' + dataAttributes.join(' ') + '>' + content + '</script>';\n                });\n\n                self.snippetsContainerCategories = self.beautifyCategories(self.snippetsContainerCategories);\n                self.snippetsComponentCategories = self.beautifyCategories(self.snippetsComponentCategories);\n                self.snippetsCategories = self.beautifyCategories([].concat(_toConsumableArray(self.snippetsContainerCategories), _toConsumableArray(self.snippetsComponentCategories)));\n\n                if (options.explicitSnippetEnabled) {\n                    self.modal.find('.keditor-snippets-container').html(snippetsContainerHtml);\n                    self.modal.find('.keditor-snippets-component').html(snippetsComponentHtml);\n                } else {\n                    self.modal.find('.keditor-snippets').html(snippetsContainerHtml + snippetsComponentHtml);\n                }\n                self.modal.find('.keditor-modal-body').append(snippetsContentHtml);\n            }\n        }, {\n            key: 'initSnippetsFilter',\n            value: function initSnippetsFilter(type) {\n                flog('initSnippetsFilter');\n\n                var self = this;\n                var options = self.options;\n                var modal = self.modal;\n\n                var categories = void 0;\n                var snippetsWrapperSelector = void 0;\n\n                switch (type) {\n                    case SNIPPET_TYPE.ALL:\n                        categories = self.snippetsCategories;\n                        snippetsWrapperSelector = '.keditor-snippets-wrapper';\n                        break;\n\n                    case SNIPPET_TYPE.CONTAINER:\n                        categories = self.snippetsContainerCategories;\n                        snippetsWrapperSelector = '.keditor-snippets-wrapper-container';\n                        break;\n\n                    case SNIPPET_TYPE.COMPONENT:\n                        categories = self.snippetsComponentCategories;\n                        snippetsWrapperSelector = '.keditor-snippets-wrapper-component';\n                        break;\n\n                    default:\n                    // Do nothing\n                }\n\n                var categoriesOptions = '';\n                $.each(categories, function (i, category) {\n                    categoriesOptions += '<option value=\"' + category + '\">' + category + '</option>';\n                });\n\n                var snippetsWrapper = modal.find(snippetsWrapperSelector);\n                var snippets = snippetsWrapper.find('.keditor-snippets').children('.keditor-snippet');\n\n                snippetsWrapper.prepend('\\n                <div class=\"keditor-ui keditor-snippets-filter-wrapper\">\\n                    <select class=\"keditor-ui keditor-snippets-filter\">\\n                        <option value=\"\" selected=\"selected\">All</option>\\n                        ' + categoriesOptions + '\\n                    </select>\\n                    <input type=\"text\" class=\"keditor-ui keditor-snippets-search\" value=\"\" placeholder=\"Type to search...\" />\\n                </div>                \\n            ');\n\n                snippets.each(function () {\n                    var snippet = $(this);\n                    var categories = snippet.attr('data-keditor-categories') || '';\n                    var filterCategories = categories.toLowerCase();\n                    categories = categories.split(options.snippetsCategoriesSeparator);\n                    filterCategories = filterCategories.split(options.snippetsCategoriesSeparator);\n\n                    snippet.data('categories', categories);\n                    snippet.data('categoriesFilter', filterCategories);\n                });\n\n                var txtSearch = snippetsWrapper.find('.keditor-snippets-search');\n                var cbbFilter = snippetsWrapper.find('.keditor-snippets-filter');\n\n                var doFilter = function doFilter() {\n                    var selectedCategory = (cbbFilter.val() || '').toLowerCase();\n                    var searchText = (txtSearch.val() || '').toLowerCase();\n                    snippets.filter('.selected').removeClass('selected');\n\n                    if (selectedCategory || searchText) {\n                        flog('Filtering snippets');\n\n                        snippets.each(function () {\n                            var snippet = $(this);\n                            var dataCategories = snippet.data('categoriesFilter');\n                            var dataCategoriesString = dataCategories.join(';');\n                            var error = 0;\n\n                            if (selectedCategory) {\n                                if ($.inArray(selectedCategory, dataCategories) === -1) {\n                                    error++;\n                                }\n                            }\n\n                            if (searchText) {\n                                var title = snippet.attr('title').toLowerCase();\n                                if (title.indexOf(searchText) === -1 && dataCategoriesString.indexOf(searchText) === -1) {\n                                    error++;\n                                }\n                            }\n\n                            snippet[error === 0 ? 'removeClass' : 'addClass']('not-matched');\n                        });\n                    } else {\n                        flog('Show all snippets');\n                        snippets.removeClass('not-matched');\n                    }\n                };\n\n                cbbFilter.on('change', function () {\n                    doFilter();\n                });\n\n                var timer = void 0;\n                txtSearch.on('keydown', function () {\n                    clearTimeout(timer);\n                    timer = setTimeout(doFilter, 200);\n                });\n            }\n        }, {\n            key: 'openModal',\n            value: function openModal(target, snippetType) {\n                flog('openModal', target, snippetType);\n\n                var self = this;\n                var modal = self.modal;\n                var options = self.options;\n                var modalTitle = '';\n                switch (snippetType) {\n                    case SNIPPET_TYPE.CONTAINER:\n                        modalTitle = 'Add container';\n                        break;\n\n                    case SNIPPET_TYPE.COMPONENT:\n                        modalTitle = 'Add component';\n                        break;\n\n                    default:\n                    // Do nothing\n                }\n\n                if (options.explicitSnippetEnabled) {\n                    modal.find('.keditor-snippets-wrapper').css('display', 'none');\n                    modal.find(snippetType === SNIPPET_TYPE.COMPONENT ? '.keditor-snippets-wrapper-component' : '.keditor-snippets-wrapper-container').css('display', 'block');\n                } else {\n                    modal.find('.keditor-snippets-wrapper').css('display', 'block').find('.keditor-snippet[data-type=container]').css('display', snippetType === SNIPPET_TYPE.COMPONENT ? 'none' : 'block');\n                    modalTitle = 'Add content';\n                }\n\n                modal.find('.keditor-modal-title').html(modalTitle);\n                self.modalTarget = target;\n                self.modalSnippetType = snippetType;\n\n                modal.css('display', 'block');\n                $(document.body).addClass('opened-modal');\n                setTimeout(function () {\n                    modal.addClass('showed');\n                }, 0);\n            }\n        }, {\n            key: 'closeModal',\n            value: function closeModal() {\n                var self = this;\n                var modal = self.modal;\n\n                self.modalTarget = null;\n                self.modalAction = null;\n                modal.find('.keditor-modal-title').html('');\n                modal.find('.keditor-snippets-wrapper .selected').removeClass('selected');\n                modal.removeClass('showed');\n            }\n\n            // Content areas\n            //---------------------------------\n\n        }, {\n            key: 'initContentAreas',\n            value: function initContentAreas() {\n                flog('initContentAreas');\n\n                var self = this;\n                var contentAreasWrapper = self.contentAreasWrapper;\n                var options = self.options;\n\n                var contentAreas = void 0;\n                if (options.contentAreasSelector) {\n                    contentAreas = contentAreasWrapper.find(options.contentAreasSelector);\n                }\n\n                if (!contentAreas || contentAreas.length === 0) {\n                    flog('Do not find any content area. Creating default content area...');\n                    var originalContent = contentAreasWrapper.html();\n\n                    contentAreas = $('<div />').html(originalContent);\n                    contentAreasWrapper.empty().append(contentAreas);\n                }\n\n                contentAreas.each(function () {\n                    var contentArea = $(this);\n                    if (!contentArea.attr('id')) {\n                        contentArea.attr('id', self.generateId('content-area'));\n                    }\n\n                    self.initContentArea(contentArea);\n                });\n            }\n        }, {\n            key: 'initContentArea',\n            value: function initContentArea(contentArea, dontInitToolbar) {\n                flog('initContentArea', contentArea);\n\n                var self = this;\n                var options = self.options;\n\n                contentArea.addClass('keditor-content-area');\n\n                if (typeof options.onBeforeInitContentArea === 'function') {\n                    options.onBeforeInitContentArea.call(self, contentArea);\n                }\n\n                if (!dontInitToolbar) {\n                    var contentAreaToolbar = $(self.generateToolbar(TOOLBAR_TYPE.CONTENT_AREA));\n                    contentArea.after(contentAreaToolbar);\n                    contentAreaToolbar.children(options.explicitSnippetEnabled ? '.btn-add-container' : '.btn-add-content').on('click', function (e) {\n                        e.preventDefault();\n\n                        self.openModal(contentArea, options.explicitSnippetEnabled ? SNIPPET_TYPE.CONTAINER : SNIPPET_TYPE.ALL);\n                    });\n                }\n\n                flog('Initialize $.fn.sortable for content area');\n                contentArea.sortable({\n                    handle: '.keditor-toolbar-container:not(.keditor-toolbar-sub-container) .btn-container-reposition',\n                    items: '> section',\n                    helper: 'clone',\n                    connectWith: '.keditor-content-area',\n                    axis: 'y',\n                    tolerance: 'pointer',\n                    sort: function sort() {\n                        $(this).removeClass('ui-state-default');\n                    },\n                    receive: function receive(event, ui) {\n                        flog('On received snippet', event, ui);\n\n                        var helper = ui.helper;\n                        var item = ui.item;\n\n                        if (helper) {\n                            helper.remove();\n                        }\n\n                        self.closeSidebar();\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, event, contentArea);\n                        }\n\n                        item.addClass('keditor-ui-dragging');\n                        contentArea.removeClass('keditor-highlighted-dropzone');\n                    },\n                    start: function start(e, ui) {\n                        ui.item.addClass('keditor-ui-dragging');\n                    },\n                    stop: function stop(e, ui) {\n                        contentArea.removeClass('keditor-highlighted-dropzone');\n                        if (ui.helper) {\n                            ui.helper.remove();\n                        }\n                        ui.item.removeClass('keditor-ui-dragging');\n                    },\n                    over: function over() {\n                        contentArea.addClass('keditor-highlighted-dropzone');\n                    },\n                    out: function out() {\n                        contentArea.addClass('keditor-highlighted-dropzone');\n                    }\n                });\n\n                flog('Initialize existing containers in content area');\n                contentArea.children('section').each(function () {\n                    self.convertToContainer(contentArea, $(this));\n                });\n\n                if (typeof options.onInitContentArea === 'function') {\n                    var contentData = options.onInitContentArea.call(self, contentArea);\n                    if (contentData && contentData.length > 0) {\n                        $.each(contentData, function () {\n                            self.convertToContainer(contentArea, $(this));\n                        });\n                    }\n                }\n            }\n\n            // Containers\n            //---------------------------------\n\n        }, {\n            key: 'convertToContainer',\n            value: function convertToContainer(contentArea, target) {\n                flog('convertToContainer', contentArea, target);\n\n                var self = this;\n                var container = void 0;\n\n                if (target.is('section')) {\n                    target.addClass('keditor-ui keditor-container');\n                    target.wrapInner('<section class=\"keditor-ui keditor-container-inner\"></section>');\n                    container = target;\n                } else {\n                    target.wrap('<section class=\"keditor-ui keditor-container\"><section class=\"keditor-ui keditor-container-inner\"></section></section>');\n                    container = target.parent().parent();\n                }\n\n                self.initContainer(contentArea, container);\n            }\n        }, {\n            key: 'initContainer',\n            value: function initContainer(contentArea, container) {\n                var self = this;\n                var options = self.options;\n                var isNested = options.nestedContainerEnabled && container.closest('[data-type=\"container-content\"]').length > 0;\n\n                flog('initContainer - isNested=' + isNested, contentArea, container);\n\n                if (!container.hasClass('keditor-initialized-container') || !container.hasClass('keditor-initializing-container')) {\n                    container.addClass('keditor-initializing-container');\n\n                    if (typeof options.onBeforeInitContainer === 'function') {\n                        options.onBeforeInitContainer.call(self, container, contentArea);\n                    }\n\n                    if (isNested) {\n                        container.addClass('keditor-sub-container');\n                    }\n\n                    flog('Render KEditor toolbar for container', container);\n                    container.append(self.generateToolbar(isNested ? TOOLBAR_TYPE.SUB_CONTAINER : TOOLBAR_TYPE.CONTAINER));\n\n                    container.attr('id', self.generateId(isNested ? 'sub-container' : 'container'));\n\n                    var containerContents = container.find('[data-type=\"container-content\"]');\n                    flog('Initialize ' + containerContents.length + ' container content(s)');\n                    containerContents.each(function () {\n                        var containerContent = $(this);\n\n                        if (options.nestedContainerEnabled && !isNested && containerContent.parents('[data-type=\"container-content\"]').length > 0) {\n                            // Do nothing because it's container content of sub container\n                            return;\n                        }\n\n                        self.initContainerContent(contentArea, container, containerContent, isNested);\n                    });\n\n                    if (typeof options.onInitContainer === 'function') {\n                        options.onInitContainer.call(self, container, contentArea);\n                    }\n\n                    container.addClass('keditor-initialized-container');\n                    container.removeClass('keditor-initializing-container');\n                } else {\n                    if (container.hasClass('keditor-initialized-container')) {\n                        flog('Container is already initialized!');\n                    } else {\n                        flog('Container is initializing...');\n                    }\n                }\n            }\n        }, {\n            key: 'initContainerContent',\n            value: function initContainerContent(contentArea, container, containerContent, isNested) {\n                flog('initContainerContent - isNested=' + isNested, contentArea, container, containerContent);\n\n                var self = this;\n                var options = self.options;\n\n                containerContent.addClass('keditor-container-content');\n                if (isNested) {\n                    containerContent.addClass('keditor-sub-container-content');\n                }\n                containerContent.attr('id', self.generateId('container-content'));\n\n                var containerContentInner = $('<div class=\"keditor-container-content-inner\"></div>');\n                containerContentInner.html(containerContent.html());\n                containerContent.html(containerContentInner);\n\n                flog('Initialize toolbar for container content');\n                var containerContentToolbar = $(self.generateToolbar(isNested ? TOOLBAR_TYPE.SUB_CONTAINER_CONTENT : TOOLBAR_TYPE.CONTAINER_CONTENT));\n                containerContentToolbar.appendTo(containerContent);\n\n                if (options.explicitSnippetEnabled) {\n                    if (!isNested) {\n                        if (options.explicitSnippetEnabled) {\n                            containerContentToolbar.children('.btn-add-container').on('click', function (e) {\n                                e.preventDefault();\n\n                                self.openModal(containerContentInner, SNIPPET_TYPE.CONTAINER);\n                            });\n                        }\n                    }\n\n                    containerContentToolbar.children('.btn-add-component').on('click', function (e) {\n                        e.preventDefault();\n\n                        self.openModal(containerContentInner, SNIPPET_TYPE.COMPONENT);\n                    });\n                } else {\n                    containerContentToolbar.children('.btn-add-content').on('click', function (e) {\n                        e.preventDefault();\n\n                        self.openModal(containerContentInner, isNested ? SNIPPET_TYPE.COMPONENT : SNIPPET_TYPE.ALL);\n                    });\n                }\n\n                flog('Initialize $.fn.sortable for container content');\n                containerContentInner.sortable({\n                    handle: '.btn-component-reposition, .btn-container-reposition',\n                    helper: 'clone',\n                    items: '> section',\n                    connectWith: '.keditor-container-content-inner',\n                    tolerance: 'pointer',\n                    sort: function sort() {\n                        $(this).removeClass('ui-state-default');\n                    },\n                    receive: function receive(event, ui) {\n                        flog('On received snippet', event, ui);\n\n                        var helper = ui.helper;\n                        var item = ui.item;\n                        var container = void 0;\n\n                        if (helper) {\n                            helper.remove();\n                        }\n                        container = item.closest('.keditor-container');\n\n                        if (!container.hasClass('showed-keditor-toolbar')) {\n                            $('.keditor-container.showed-keditor-toolbar').removeClass('showed-keditor-toolbar');\n                            container.addClass('showed-keditor-toolbar');\n                        }\n\n                        if (typeof options.onContainerChanged === 'function') {\n                            options.onContainerChanged.call(self, event, container, contentArea);\n                        }\n\n                        if (typeof options.onContentChanged === 'function') {\n                            options.onContentChanged.call(self, event, contentArea);\n                        }\n\n                        item.removeClass('keditor-ui-dragging');\n                        contentArea.removeClass('keditor-highlighted-dropzone');\n                    },\n                    start: function start(e, ui) {\n                        ui.item.addClass('keditor-ui-dragging');\n                    },\n                    stop: function stop(e, ui) {\n                        containerContentInner.removeClass('keditor-highlighted-dropzone');\n\n                        if (ui.helper) {\n                            ui.helper.remove();\n                        }\n                        ui.item.removeClass('keditor-ui-dragging');\n                    },\n                    over: function over() {\n                        containerContentInner.addClass('keditor-highlighted-dropzone');\n                    },\n                    out: function out() {\n                        containerContentInner.removeClass('keditor-highlighted-dropzone');\n                    }\n                });\n\n                flog('Initialize existing components inside container content');\n                containerContentInner.children().each(function () {\n                    var child = $(this);\n\n                    if (child.find('[data-type=\"container-content\"]').length > 0) {\n                        self.convertToContainer(contentArea, child);\n                    } else {\n                        self.convertToComponent(contentArea, container, child, true);\n                    }\n                });\n            }\n\n            // Components\n            //---------------------------------\n\n        }, {\n            key: 'convertToComponent',\n            value: function convertToComponent(contentArea, container, target, isExisting) {\n                flog('convertToComponent', contentArea, container, target, isExisting);\n\n                if (target.is('.keditor-container-content-toolbar')) {\n                    return;\n                }\n\n                var self = this;\n                var isSection = target.is('section');\n                var component = void 0;\n\n                if (isSection) {\n                    target.addClass('keditor-ui keditor-component');\n                    target.wrapInner('<section class=\"keditor-ui keditor-component-content\"></section>');\n                    component = target;\n                } else {\n                    target.wrap('<section class=\"keditor-ui keditor-component\"><section class=\"keditor-ui keditor-component-content\"></section></section>');\n                    component = target.parent().parent();\n                }\n\n                if (isExisting) {\n                    component.addClass('existing-component');\n                }\n\n                self.initComponent(contentArea, container, component);\n            }\n        }, {\n            key: 'initComponent',\n            value: function initComponent(contentArea, container, component) {\n                flog('initComponent', contentArea, container, component);\n\n                var self = this;\n                var options = self.options;\n                var body = self.body;\n\n                if (!component.hasClass('keditor-initialized-component') || !component.hasClass('keditor-initializing-component')) {\n                    component.addClass('keditor-initializing-component');\n                    component.attr('id', self.generateId('component'));\n\n                    if (typeof options.onBeforeInitComponent === 'function') {\n                        options.onBeforeInitComponent.call(self, component, contentArea);\n                    }\n\n                    var componentContent = component.children('.keditor-component-content');\n                    componentContent.attr('id', self.generateId('component-content'));\n\n                    var componentType = self.getComponentType(component);\n                    flog('Component type: ' + componentType);\n\n                    var componentData = KEditor.components[componentType];\n\n                    flog('Render KEditor toolbar for component', component);\n                    component.append(self.generateToolbar(TOOLBAR_TYPE.COMPONENT, componentData.settingEnabled));\n\n                    component.find('[data-dynamic-href]').each(function () {\n                        var dynamicElement = $(this);\n\n                        self.initDynamicContent(dynamicElement);\n                    });\n\n                    if (typeof componentData.init === 'function') {\n                        componentData.init.call(componentData, contentArea, container, component, self);\n                    } else {\n                        flog('\"init\" function of component type \"' + componentType + '\" does not exist');\n                    }\n\n                    if (typeof options.onInitComponent === 'function') {\n                        options.onInitComponent.call(self, component, contentArea);\n                    }\n\n                    component.addClass('keditor-initialized-component');\n                    component.removeClass('keditor-initializing-component');\n                } else {\n                    if (component.hasClass('keditor-initialized-component')) {\n                        flog('Component is already initialized!');\n                    } else {\n                        flog('Component is initializing...');\n                    }\n                }\n            }\n        }, {\n            key: 'initDynamicContent',\n            value: function initDynamicContent(dynamicElement) {\n                flog('initDynamicContent', dynamicElement);\n\n                var self = this;\n                var options = self.options;\n                var component = dynamicElement.closest('.keditor-component');\n                var contentArea = dynamicElement.closest('.keditor-content-area');\n\n                dynamicElement.attr('id', self.generateId('dynamic-element'));\n\n                if (typeof options.onBeforeDynamicContentLoad === 'function') {\n                    options.onBeforeDynamicContentLoad.call(self, dynamicElement, component, contentArea);\n                }\n\n                var dynamicHref = dynamicElement.attr('data-dynamic-href');\n                var data = self.getDataAttributes(component, ['data-type', 'data-dynamic-href'], false);\n                data = $.param(data);\n                flog('Dynamic href: ' + dynamicHref + ', Data: ' + data);\n\n                return $.ajax({\n                    url: dynamicHref,\n                    data: data,\n                    type: 'GET',\n                    dataType: 'HTML',\n                    success: function success(response, status, xhr) {\n                        flog('Dynamic content is loaded', dynamicElement, response, status, xhr);\n                        dynamicElement.html(response);\n\n                        if (typeof options.onDynamicContentLoaded === 'function') {\n                            options.onDynamicContentLoaded.call(self, dynamicElement, response, status, xhr, contentArea);\n                        }\n                    },\n                    error: function error(response, status, xhr) {\n                        flog('Error when loading dynamic content', dynamicElement, response, status, xhr);\n\n                        if (typeof options.onDynamicContentError === 'function') {\n                            options.onDynamicContentError.call(self, dynamicElement, response, status, xhr, contentArea);\n                        }\n                    }\n                });\n            }\n        }, {\n            key: 'deleteComponent',\n            value: function deleteComponent(component) {\n                flog('deleteComponent', component);\n\n                var self = this;\n\n                var componentType = self.getComponentType(component);\n                var componentData = KEditor.components[componentType];\n                if (typeof componentData.destroy === 'function') {\n                    componentData.destroy.call(componentData, component, self);\n                }\n\n                component.remove();\n            }\n\n            // Get content\n            //---------------------------------\n\n        }, {\n            key: 'getComponentContent',\n            value: function getComponentContent(component) {\n                flog('getComponentContent');\n\n                var self = this;\n                var clonedComponent = component.clone();\n                var componentType = self.getComponentType(clonedComponent);\n                var componentData = KEditor.components[componentType];\n                var dataAttributes = self.getDataAttributes(clonedComponent, null, true);\n                var content = void 0;\n\n                if (typeof componentData.getContent === 'function') {\n                    content = componentData.getContent.call(componentData, clonedComponent, self);\n                } else {\n                    var componentContent = clonedComponent.children('.keditor-component-content');\n                    content = componentContent.html();\n                }\n\n                clonedComponent.html(content).find('[data-dynamic-href]').each(function () {\n                    $(this).html('');\n                });\n\n                return '<section ' + dataAttributes.join(' ') + '>' + clonedComponent.html() + '</section>';\n            }\n        }, {\n            key: 'getContainerContent',\n            value: function getContainerContent(container, isNested) {\n                flog('getContainerContent - isNested=' + isNested, container);\n\n                var self = this;\n                var containerInner = container.children('.keditor-container-inner').clone();\n\n                containerInner.find('[data-type=container-content]').not(isNested ? '' : '.keditor-sub-container-content').each(function () {\n                    var containerContent = $(this);\n                    containerContent.removeClass('keditor-container-content keditor-sub-container-content').removeAttr('id');\n\n                    var containerContentInner = containerContent.children();\n                    var content = '';\n\n                    containerContentInner.children().each(function () {\n                        var child = $(this);\n\n                        if (child.is('.keditor-component')) {\n                            content += self.getComponentContent(child);\n                        } else if (child.is('.keditor-sub-container')) {\n                            content += self.getContainerContent(child, true);\n                        }\n                    });\n\n                    containerContent.html(content);\n                });\n\n                return '<section>' + containerInner.html() + '</section>';\n            }\n        }, {\n            key: 'getContent',\n            value: function getContent(inArray) {\n                var self = this;\n                var result = [];\n\n                self.contentAreasWrapper.find('.keditor-content-area').each(function () {\n                    var html = '';\n                    $(this).children('.keditor-container').each(function () {\n                        var container = $(this);\n\n                        html += self.getContainerContent(container);\n                    });\n\n                    result.push(html);\n                });\n\n                return inArray ? result : result.join('\\n');\n            }\n\n            // Set content\n            //---------------------------------\n\n        }, {\n            key: 'setContent',\n            value: function setContent(content, contentArea) {\n                var self = this;\n                var contentAreasWrapper = self.contentAreasWrapper;\n\n                if (!contentArea) {\n                    contentArea = contentAreasWrapper.children('.keditor-content-area');\n                } else {\n                    if (!contentArea.jquery) {\n                        contentArea = contentAreasWrapper.find(contentArea);\n                    }\n                }\n\n                if (contentArea.length === 0) {\n                    error('Content area does not exist!');\n                }\n\n                contentArea.html(content);\n                self.initContentArea(contentArea, true);\n            }\n\n            // Destroy\n            //---------------------------------\n\n        }, {\n            key: 'destroy',\n            value: function destroy() {\n                var self = this;\n                var element = self.element;\n                var id = self.id;\n\n                var content = self.getContent(false);\n\n                if (self.options.iframeMode) {\n                    self.iframeWrapper.remove();\n                } else {\n                    self.contentAreasWrapper.remove();\n                }\n\n                if (element.is('textarea')) {\n                    element.val(content);\n                } else {\n                    element.html(content);\n                }\n\n                element.removeClass('keditor-hidden-element');\n                element.data('keditor', null);\n                delete KEditor.instances[id];\n            }\n        }]);\n\n        return KEditor;\n    }();\n\n    // KEditor plugins\n\n\n    $.fn.keditor = function (options) {\n        var element = $(this);\n        var instance = element.data('keditor');\n\n        if (typeof options === 'string') {\n            if (instance && instance[options] && typeof instance[options] === 'function') {\n                return instance[options].apply(instance, Array.prototype.slice.call(arguments, 1));\n            }\n        } else {\n            if (!instance) {\n                instance = new KEditor(element, options);\n                element.data('keditor', instance);\n            }\n\n            return instance;\n        }\n    };\n    $.fn.keditor.constructor = KEditor;\n\n    // KEditor instances\n    KEditor.instances = {};\n\n    // Turn on/off debug mode\n    KEditor.debug = false;\n\n    // Version of KEditor\n    KEditor.version = '@{version}';\n\n    // Component types\n    KEditor.components = {\n        blank: {\n            settingEnabled: false\n        }\n    };\n\n    // Export default configuration\n    KEditor.DEFAULTS = DEFAULTS;\n\n    // Export log methods;\n    KEditor.log = flog;\n    KEditor.error = error;\n\n    // Export KEditor\n    window.KEditor = $.keditor = KEditor;\n})(window, jQuery);"]}